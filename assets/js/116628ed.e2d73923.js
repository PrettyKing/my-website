"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2412],{2664:(e,r,n)=>{n.r(r),n.d(r,{contentTitle:()=>a,default:()=>p,frontMatter:()=>c,metadata:()=>l,toc:()=>d});var t=n(8168),o=(n(6540),n(5680));const c={},a=void 0,l={unversionedId:"k8s/redhat8\u5b89\u88c5docker",id:"k8s/redhat8\u5b89\u88c5docker",isDocsHomePage:!1,title:"redhat8\u5b89\u88c5docker",description:"\u67e5\u770b\u7cfb\u7edf\u7248\u672c",source:"@site/docs/k8s/redhat8\u5b89\u88c5docker.md",sourceDirName:"k8s",slug:"/k8s/redhat8\u5b89\u88c5docker",permalink:"/my-website/docs/k8s/redhat8\u5b89\u88c5docker",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/k8s/redhat8\u5b89\u88c5docker.md",version:"current",frontMatter:{},sidebar:"defaultSidebar",previous:{title:"k8s-\u524d\u7f6e\u73af\u5883",permalink:"/my-website/docs/k8s/k8s-\u524d\u7f6e\u73af\u5883"},next:{title:"NodeJS \u9879\u76ee\u67b6\u6784\u4e0e\u4f18\u5316",permalink:"/my-website/docs/node/node-framework"}},d=[{value:"\u67e5\u770b\u7cfb\u7edf\u7248\u672c",id:"\u67e5\u770b\u7cfb\u7edf\u7248\u672c",children:[]},{value:"\u8bbe\u7f6e\u4f7f\u7528\u963f\u91cc\u7684repo\u6e90\uff08\u6ca1\u6709RHEL\u7684\u6e90\uff0c\u4f7f\u7528Centos\u6e90\uff09",id:"\u8bbe\u7f6e\u4f7f\u7528\u963f\u91cc\u7684repo\u6e90\u6ca1\u6709rhel\u7684\u6e90\u4f7f\u7528centos\u6e90",children:[]},{value:"\u5f00\u542f\u5185\u6838\u7684\u6d41\u91cf\u8f6c\u53d1",id:"\u5f00\u542f\u5185\u6838\u7684\u6d41\u91cf\u8f6c\u53d1",children:[]},{value:"\u8f7d\u5185\u6838\u53c2\u6570",id:"\u8f7d\u5185\u6838\u53c2\u6570",children:[]},{value:"\u67e5\u770b\u4ed3\u5e93\u662f\u5426\u6709docker",id:"\u67e5\u770b\u4ed3\u5e93\u662f\u5426\u6709docker",children:[]},{value:"\u88c5docker",id:"\u88c5docker",children:[]},{value:"\u751f\u6210docker\u914d\u7f6e\u6587\u4ef6daemon.json",id:"\u751f\u6210docker\u914d\u7f6e\u6587\u4ef6daemonjson",children:[]},{value:"\u914d\u7f6edaemon.json",id:"\u914d\u7f6edaemonjson",children:[]},{value:"\u91cd\u65b0\u8f7d\u5165\u548c\u91cd\u542f\u52a8",id:"\u91cd\u65b0\u8f7d\u5165\u548c\u91cd\u542f\u52a8",children:[]},{value:"\u67e5\u770bdocker\u72b6\u6001",id:"\u67e5\u770bdocker\u72b6\u6001",children:[]},{value:"\u5378\u8f7d",id:"\u5378\u8f7d",children:[]}],s={toc:d},i="wrapper";function p(e){let{components:r,...n}=e;return(0,o.yg)(i,(0,t.A)({},s,n,{components:r,mdxType:"MDXLayout"}),(0,o.yg)("h3",{id:"\u67e5\u770b\u7cfb\u7edf\u7248\u672c"},"\u67e5\u770b\u7cfb\u7edf\u7248\u672c"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-shell"},'##\u67e5\u770b\u7cfb\u7edf\u4fe1\u606f\ncat /etc/os-release\n##\u663e\u793aVERSION="8.6 (Ootpa)"\n##\u67e5\u770b\u5185\u6838\u7248\u672c\u3002\u9700\u5927\u4e8e3.10\u30028.6\u662f4.18\nuname -a\n##\u663e\u793a4.18.0-372.19.1.el8_6.x86_64\n')),(0,o.yg)("h3",{id:"\u8bbe\u7f6e\u4f7f\u7528\u963f\u91cc\u7684repo\u6e90\u6ca1\u6709rhel\u7684\u6e90\u4f7f\u7528centos\u6e90"},"\u8bbe\u7f6e\u4f7f\u7528\u963f\u91cc\u7684repo\u6e90\uff08\u6ca1\u6709RHEL\u7684\u6e90\uff0c\u4f7f\u7528Centos\u6e90\uff09"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-shell"},"wget -O /etc/yum.repos.d/redhat.repo http://mirrors.aliyun.com/repo/Centos-8.repo   #\u57fa\u7840\u5305\nwget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/Centos-8.repo        #\u989d\u5916\u5305\nyum clean all        #\u6e05\u9664\u7f13\u5b58\nyum makecache        #\u751f\u6210\u7f13\u5b58\n")),(0,o.yg)("h3",{id:"\u5f00\u542f\u5185\u6838\u7684\u6d41\u91cf\u8f6c\u53d1"},"\u5f00\u542f\u5185\u6838\u7684\u6d41\u91cf\u8f6c\u53d1"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-shell"},"cat <<EOF > /etc/sysctl.d/docker.conf\nnet.bridge.bridge-nf-call-ip6tables = 1\nnet.bridge.bridge-nf-call-iptables = 1\nnet.ipv4.conf.default.rp_filter = 0\nnet.ipv4.conf.all.rp_filter = 0\nnet.ipv4.ip_forward = 1\nEOF\n")),(0,o.yg)("h3",{id:"\u8f7d\u5185\u6838\u53c2\u6570"},"\u8f7d\u5185\u6838\u53c2\u6570"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-shell"},"sysctl -p /etc/sysctl.d/docker.conf\n## \u5982\u679c\u62a5\u9519*/*/bridge-nf-call-ip6tables:No such file or directory \u6267\u884c\u4e0b\u9762\n#####  modprobe br_netfilter\n")),(0,o.yg)("h3",{id:"\u67e5\u770b\u4ed3\u5e93\u662f\u5426\u6709docker"},"\u67e5\u770b\u4ed3\u5e93\u662f\u5426\u6709docker"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-shell"},"yum list docker-ce --showduplicates | sort -r\n## \u5982\u679c\u6ca1\u6709\n    ##\u7b2c\u4e00\u79cd\u529e\u6cd5                    \n    yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/rhel/docker-ce.repo\n    ##\u7b2c\u4e8c\u79cd\u91cd\u65b0\u751f\u6210yum\u7f13\u5b58\u529e\u6cd5\n    curl -o /etc/yum.repos.d/docker-ce.repo http://mirrors.aliyun.com/docker-ce/linux/rhel/docker-ce\n")),(0,o.yg)("h3",{id:"\u88c5docker"},"\u88c5docker"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-shell"},"##\u6839\u636e\u5217\u8868\uff0c\u5b89\u88c520.10.9\nyum install docker-ce-20.10.9 -y\n")),(0,o.yg)("h3",{id:"\u751f\u6210docker\u914d\u7f6e\u6587\u4ef6daemonjson"},"\u751f\u6210docker\u914d\u7f6e\u6587\u4ef6daemon.json"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-shell"},"##\u521b\u5efa\u76ee\u5f55\u4ee5\u53ca\u6587\u4ef6\nmkdir -p /etc/docker && touch /etc/docker/daemon.json\n")),(0,o.yg)("h3",{id:"\u914d\u7f6edaemonjson"},"\u914d\u7f6edaemon.json"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-shell"},'## \u4f7f\u7528\u963f\u91cc\u4e91\u955c\u50cf\u751f\u6210\u81ea\u5df1\u7684\u52a0\u901f\u955c\u50cfhttps://4efi3n2i.mirror.aliyuncs.com\u8fd9\u4e2a\u5730\u5740\u6bcf\u4e2a\u4eba\u751f\u6210\u7684\u4e0d\u4e00\u6837\n## \u5b9a\u4e49\u6570\u636e\u4f4d\u7f6e\uff0cdocker\u6839\u76ee\u5f55\u3002\u9ed8\u8ba4\u662fvar/lib/docker\n## \u8fd8\u914d\u7f6e\u4e86docker\u79c1\u670d\u5141\u8bb8\u901a\u8fc7http\u65b9\u5f0f\u63a8\u9001\u955c\u50cf\uff08\u79c1\u670d\u670d\u52a1\u5668\u548c\u5ba2\u6237\u673a\u90fd\u8981\u52a0\u8fd9\u53e5\uff09\uff08\u4f8b\u5982\uff1a\u5982\u679c\u79c1\u670d\u4f7f\u7528\u4e91\u670d\u52a1\u5668\uff0c\u8fd9\u4e2a\u5730\u5740\u5c31\u662f\u4e91\u670d\u52a1\u5668\u7684\u5916\u7f51IP\uff09\ntee /etc/docker/daemon.json <<-\'EOF\'\n{\n  "registry-mirrors": ["https://4efi3n2i.mirror.aliyuncs.com"],\n  "data-root": "/file",\n  "insecure_registries":["\u79c1\u670d\u4e3b\u673a\u7684IP:5000"]\n}\nEOF\n')),(0,o.yg)("h3",{id:"\u91cd\u65b0\u8f7d\u5165\u548c\u91cd\u542f\u52a8"},"\u91cd\u65b0\u8f7d\u5165\u548c\u91cd\u542f\u52a8"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-shell"},"##\u91cd\u65b0\u8f7d\u5165\u914d\u7f6e\nsystemctl daemon-reload\n##\u91cd\u542fdocker\nsystemctl restart docker\n##\u5f00\u542f\u81ea\u542f\u52a8docker\nsystemctl enable docker\n#\u4f1a\u5f39\u51faCreated symlink /etc/systemd/system/multi-user.target.wants/docker.service \u2192 /usr/lib/systemd/system/docker.service.\n")),(0,o.yg)("h3",{id:"\u67e5\u770bdocker\u72b6\u6001"},"\u67e5\u770bdocker\u72b6\u6001"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-shell"},"ps -ef|grep docker\n##\u5f39\u51fa \nroot       14595       1  0 16:14 ?        00:00:00 /usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock\nroot       14760    9539  0 16:15 pts/0    00:00:00 grep --color=auto docker\n")),(0,o.yg)("h3",{id:"\u5378\u8f7d"},"\u5378\u8f7d"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-shell"},"##\u65b0\u7248\u672c\u5378\u8f7d\nyum -y autoremove docker-ce docker-scan-plugin \n##\u8001\u7248\u672c\u5378\u8f7d \uff08 \\\uff09\u6362\u884c\u8f6c\u4e49\u7b26\nsudo yum -y remove docker \\\n                  docker-client \\\n                  docker-client-latest \\\n                  docker-common \\\n                  docker-latest \\\n                  docker-latest-logrotate \\\n                  docker-logrotate \\\n                  docker-engine\n\n##\u67e5\u770b\u5378\u8f7d\u5b8c\u6ca1\u6709\nrpm -qa |grep docker\n")))}p.isMDXComponent=!0},5680:(e,r,n)=>{n.d(r,{xA:()=>i,yg:()=>y});var t=n(6540);function o(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function c(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function a(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?c(Object(n),!0).forEach((function(r){o(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function l(e,r){if(null==e)return{};var n,t,o=function(e,r){if(null==e)return{};var n,t,o={},c=Object.keys(e);for(t=0;t<c.length;t++)n=c[t],r.indexOf(n)>=0||(o[n]=e[n]);return o}(e,r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(t=0;t<c.length;t++)n=c[t],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var d=t.createContext({}),s=function(e){var r=t.useContext(d),n=r;return e&&(n="function"==typeof e?e(r):a(a({},r),e)),n},i=function(e){var r=s(e.components);return t.createElement(d.Provider,{value:r},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var r=e.children;return t.createElement(t.Fragment,{},r)}},m=t.forwardRef((function(e,r){var n=e.components,o=e.mdxType,c=e.originalType,d=e.parentName,i=l(e,["components","mdxType","originalType","parentName"]),p=s(n),m=o,y=p["".concat(d,".").concat(m)]||p[m]||u[m]||c;return n?t.createElement(y,a(a({ref:r},i),{},{components:n})):t.createElement(y,a({ref:r},i))}));function y(e,r){var n=arguments,o=r&&r.mdxType;if("string"==typeof e||o){var c=n.length,a=new Array(c);a[0]=m;var l={};for(var d in r)hasOwnProperty.call(r,d)&&(l[d]=r[d]);l.originalType=e,l[p]="string"==typeof e?e:o,a[1]=l;for(var s=2;s<c;s++)a[s]=n[s];return t.createElement.apply(null,a)}return t.createElement.apply(null,n)}m.displayName="MDXCreateElement"}}]);