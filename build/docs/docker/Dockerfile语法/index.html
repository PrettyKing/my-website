<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.3">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="卫辰 Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="卫辰 Blog Atom Feed"><title data-react-helmet="true">Dockerfile语法 | 卫辰</title><meta data-react-helmet="true" property="og:url" content="http://githubci.faithcal.com/docs/docker/Dockerfile语法"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Dockerfile语法 | 卫辰"><meta data-react-helmet="true" name="description" content="FROM（指定基础 image）"><meta data-react-helmet="true" property="og:description" content="FROM（指定基础 image）"><link data-react-helmet="true" rel="shortcut icon" href="/favicon.ico"><link data-react-helmet="true" rel="canonical" href="http://githubci.faithcal.com/docs/docker/Dockerfile语法"><link data-react-helmet="true" rel="alternate" href="http://githubci.faithcal.com/docs/docker/Dockerfile语法" hreflang="en"><link data-react-helmet="true" rel="alternate" href="http://githubci.faithcal.com/docs/docker/Dockerfile语法" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.2a08f740.css">
<link rel="preload" href="/assets/js/runtime~main.047caa76.js" as="script">
<link rel="preload" href="/assets/js/main.da97ff1e.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/logo.png" alt="诗的远方" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/logo.png" alt="诗的远方" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">卫辰</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">大前端</a><a class="navbar__item navbar__link" href="/md/devops">devops</a><a class="navbar__item navbar__link" href="/blog">博客</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle displayOnlyInLargeViewport_cxYs react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/logo.png" alt="诗的远方" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/logo.png" alt="诗的远方" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">卫辰</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/intro">大前端</a></li><li class="menu__list-item"><a class="menu__link" href="/md/devops">devops</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">博客</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_lDyR"><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu menu--responsive thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_iZzd" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro">简介</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">浏览器</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/browser/base-1">base-1</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">函数速查</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/function/searchPrams">searchPrams</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">javascript</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/javascript/Proxy&amp;Reflect">Proxy 和 Reflect</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/javascript/design-pattern">设计模式</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/javascript/eventloop">EventLoop</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/javascript/javascript-functional">函数式编程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/javascript/meta-programming">元编程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/javascript/JavaScript高级技巧">JavaScript高级技巧</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/javascript/javaScript常见的错误类型">javaScript常见的错误类型</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/javascript/try-catch-finally执行顺序">有return的情况下try catch finally的执行顺序</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">node</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/node/node-framework">NodeJS 项目架构与优化</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/node/node-ioc">NodeJS 面向切面编程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/node/node-performance">NodeJS 性能调优</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/node/node-ssr">NodeJS 服务端渲染</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">性能调优</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optimize/http">HTTP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optimize/node-performance">NodeJS 性能调优</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optimize/performance-optimization-1">性能优化(一)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optimize/performance-optimization-2">性能优化(二)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optimize/performance-optimization-3">性能优化(三)</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">其他</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/other/C">C语言速成</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/other/CPP">C++ 速成</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/other/docker-publish">Docker 镜像打包和发布基本流程</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">问题描述</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/BFC">BFC相关</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/react-fiber">react的react-fiber</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/vueHooks">vue 中的Hooks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/DNS的解析过程">DNS的解析过程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/React中的有状态和无状态组件">React 中的有状态组件和无状态组件</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/React动态加载路由实现按需加载">React 路由的动态加载模块，实现按需加载</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/Redux属性传递的原理">Redux怎么实现属性传递，介绍下原理</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/TreeShaking的原理">tree-shaking 的原理</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/css-旋转图片">css一直旋转的图片</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/css-水波纹">css水波纹</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/dev-server的运行">dev-server 是怎么跑起来的</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/http3.0及http发展">http3.0 及 http发展历史</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/https获取加密秘钥的过程">https 获取加密秘钥的过程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/localStorage加密原理">LocalStorage 加密原理</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/react中的diff">react diff算法</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/vue&amp;react的异同">vue&amp;react的理解和他们的异同</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/vue.$set原理">vue的 $set原理</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/vue中$方法说明">vue 中所有带$方法的说明</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/vue中的v-model">vue 中的v-model</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/vue的data改编后会重新渲染吗">vue 中data中某个属性改变会触发视图重新渲染的吗</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/vue的dom-diff算法">vue中的dom diff算法</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/vue的keep-alive">vue keep-alive的实现</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/vue的nextTick原理">vue的$nextTick原理</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/vue的seo">vue 针对搜索引擎的seo优化</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/vue的指令">vue中的指令</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/vue移动端滚动穿透问题">vue移动端滚动穿透问题</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/vue组件的通信方式">vue组件的通信方式</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/webpack插件的实现">webpack中插件的实现</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/webpack热更新原理">webpack 热更新原理</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/webpack的loader和plugin">webpack 的loader和plugin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/webpack的优化">webpack 及其优化</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/webpack的模块引用">webpack是怎么处理模块循环引用的情况的?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/从URL到页面加载分析">从输入 URL 到页面加载全过程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/前端的单元测试">前端中的单元测试</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/可提供代码执行环境的沙箱">场景：需求前端有一个编辑器，可提供执行代码的功能，这个执行的沙箱需要注意什么，怎么实现</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/在H5中实现长按保存图片">在H5中实现长按保存图片</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/增量式垃圾回收算法怎么实现的">增量式垃圾回收算法怎么实现的</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/对react的看法">对react的看法，它的优缺点，使用过程中遇到的问题，如何解决的</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/浏览器渲染流程">浏览器渲染流程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/浏览器里点击复制到剪贴板">浏览器里点击复制到剪贴板的方法</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/组件曝光SDK">埋点场景题：如何设计一个通过组件曝光的sdk（计算路由跳转层级、停留时间等）</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/网站的seo处理">网站的seo处理</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/虚拟DOM">对虚拟DOM的理解?虚拟DOM主要做了什么?虚拟DOM本身是什么?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/解析HTML的过程">浏览器解析 HTML 文件的过程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/question/首页优化">提升页面性能和首页优化</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">docker</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docker/Docker image Build 高级">Docker image Build 高级</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docker/Docker-compose基本语法">Docker-compose基本语法</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/docker/Dockerfile语法">Dockerfile语法</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docker/Docker基础速查">Docker基础速查</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docker/Docker网络化配置">Docker网络化配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docker/Namespace-网络">Namespace-网络</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docker/Yaml语法">Yaml语法</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docker/docker中进程的信号">docker中进程的信号</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docker/安装Docker软件">安装Docker软件</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Kubernetes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/k8s/k8s-前置环境">k8s-前置环境</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/k8s/redhat8安装docker">redhat8安装docker</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">TypeScript</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/开篇：用正确的方式学习 TypeScript">开篇：用正确的方式学习 TypeScript</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/工欲善其事：打造最舒适的 TypeScript 开发环境">工欲善其事：打造最舒适的 TypeScript 开发环境</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/进入类型的世界：理解原始类型与对象类型">进入类型的世界：理解原始类型与对象类型</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/掌握字面量类型与枚举，让你的类型再精确一些">掌握字面量类型与枚举，让你的类型再精确一些</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/函数与 Class 中的类型：详解函数重载与面向对象">函数与 Class 中的类型：详解函数重载与面向对象</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/探秘内置类型：any、unknown、never 与类型断言">探秘内置类型：any、unknown、never 与类型断言</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/类型编程好帮手：TypeScript 类型工具（上）">类型编程好帮手：TypeScript 类型工具（上）</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/类型编程好帮手：TypeScript 类型工具（下）">类型编程好帮手：TypeScript 类型工具（下）</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/类型编程基石：TypeScript 中无处不在的泛型">类型编程基石：TypeScript 中无处不在的泛型</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/结构化类型系统：类型兼容性判断的幕后">结构化类型系统：类型兼容性判断的幕后</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/类型系统层级：从 Top Type 到 Bottom Type">类型系统层级：从 Top Type 到 Bottom Type</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/类型里的逻辑运算：条件类型与 infer">类型里的逻辑运算：条件类型与 infer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/内置工具类型基础：别再妖魔化工具类型了！">内置工具类型基础：别再妖魔化工具类型了！</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/反方向类型推导：用好上下文相关类型">反方向类型推导：用好上下文相关类型</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/函数类型：协变与逆变的比较">函数类型：协变与逆变的比较</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/了解类型编程与类型体操的意义，找到平衡点">了解类型编程与类型体操的意义，找到平衡点</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/内置工具类型进阶：类型编程进阶">内置工具类型进阶：类型编程进阶</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/基础类型新成员：模板字符串类型入门">基础类型新成员：模板字符串类型入门</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/类型编程新范式：模板字符串工具类型进阶">类型编程新范式：模板字符串工具类型进阶</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/工程层面的类型能力：类型声明、类型指令与命名空间">工程层面的类型能力：类型声明、类型指令与命名空间</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/在 React 中愉快地使用 TypeScript：内置类型与泛型坑位">在 React 中愉快地使用 TypeScript：内置类型与泛型坑位</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/让 ESLint 来约束你的 TypeScript 代码：配置与规则集介绍">让 ESLint 来约束你的 TypeScript 代码：配置与规则集介绍</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/全链路 TypeScript 工具库，找到适合你的工具">全链路 TypeScript 工具库，找到适合你的工具</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/说说 TypeScript 和 ECMAScript 之间那些事儿">说说 TypeScript 和 ECMAScript 之间那些事儿</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/装饰器与反射元数据：了解装饰器基本原理与应用">装饰器与反射元数据：了解装饰器基本原理与应用</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/控制反转与依赖注入：基于装饰器的依赖注入实现">控制反转与依赖注入：基于装饰器的依赖注入实现</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/TSConfig 全解（上）：构建相关配置">TSConfig 全解（上）：构建相关配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/TSConfig 全解（下）：检查相关、工程相关配置">TSConfig 全解（下）：检查相关、工程相关配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/基于 Prisma + NestJs 的 Node API ：前置知识储备">基于 Prisma + NestJs 的 Node API ：前置知识储备</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/基于 Prisma + NestJs 的 Node API ：项目开发与基于 Heroku 部署">基于 Prisma + NestJs 的 Node API ：项目开发与基于 Heroku 部署</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/玩转 TypeScript AST：AST Checker 与 CodeMod">玩转 TypeScript AST：AST Checker 与 CodeMod</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">工程化</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/devops/CICD">前端工程化之CI/CD</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/devops/K8S">K8S 基础</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="markdown"><header><h1 class="h1Heading_dC7a">Dockerfile语法</h1></header><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="from指定基础-image"></a>FROM（指定基础 image）<a class="hash-link" href="#from指定基础-image" title="Direct link to heading">#</a></h4><p>构建指令，必须指定且需要在 Dockerfile 其他指令的前面。后续的指令都依赖于该指令指定的 image。FROM 指令指定的基础 image 可以是官方远程仓库中的，也可以位于本地仓库</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI dockerfile"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">FROM centos:7.2</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM centos</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="maintainer用来指定镜像创建者信息"></a>MAINTAINER（用来指定镜像创建者信息）<a class="hash-link" href="#maintainer用来指定镜像创建者信息" title="Direct link to heading">#</a></h4><p>构建指令，用于将 image 的制作者相关的信息写入到 image 中。当我们对该 image 执行 docker inspect 命令时，输出中有相应的字段记录该信息。</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI dockerfile"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">MAINTAINER  wangyang &quot;wangyang@itxdl.cn&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>​		</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="label将元数据添加到镜像"></a>LABEL（将元数据添加到镜像）<a class="hash-link" href="#label将元数据添加到镜像" title="Direct link to heading">#</a></h4><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="标签的定义"></a>标签的定义<a class="hash-link" href="#标签的定义" title="Direct link to heading">#</a></h5><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI dockerfile"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain"># 指令将元数据添加到镜像。`LABEL` 是键值对。要在 `LABEL` 值中包含空格，请像在命令行中一样使用引号和反斜杠</span></span><span class="token-line" style="color:#393A34"><span class="token plain">LABEL &quot;com.example.vendor&quot;=&quot;ACME Incorporated&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">LABEL com.example.label-with-value=&quot;foo&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">LABEL version=&quot;1.0&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">LABEL description=&quot;This text illustrates \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">that label-values can span multiple lines.&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># 多行标签定义方式</span></span><span class="token-line" style="color:#393A34"><span class="token plain">LABEL multi.label1=&quot;value1&quot; multi.label2=&quot;value2&quot; other=&quot;value3&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">LABEL multi.label1=&quot;value1&quot; \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      multi.label2=&quot;value2&quot; \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      other=&quot;value3&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="标签的继承"></a>标签的继承<a class="hash-link" href="#标签的继承" title="Direct link to heading">#</a></h5><p>基础或父镜像（<code>FROM</code> 行中的镜像）中包含的标签由您的镜像继承。如果标签已经存在但具有不同的值，则最近应用的值将覆盖任何先前设置的值</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="查看镜像标签"></a>查看镜像标签<a class="hash-link" href="#查看镜像标签" title="Direct link to heading">#</a></h5><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> image inspect --format</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"> myimage</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="案例"></a>案例<a class="hash-link" href="#案例" title="Direct link to heading">#</a></h5><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI dockerfile"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain"># dockerfile</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM busybox</span></span><span class="token-line" style="color:#393A34"><span class="token plain">LABEL author=wangyanglinux</span></span><span class="token-line" style="color:#393A34"><span class="token plain">CMD echo wangyanglinux</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># 构建镜像</span></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master01 testd]# docker build -t wangyanglinux:0.0.1 . --no-cache</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># 安装 jq</span></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master01 testd]# yum install epel-release</span></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master01 testd]# yum install jq</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># 查看标签</span></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master01 testd]# docker image inspect wangyanglinux:0.0.1 --format &quot;{{json .ContainerConfig.Labels}}&quot; | jq</span></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;author&quot;: &quot;wangyanglinux&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="run安装软件用"></a>RUN（安装软件用）<a class="hash-link" href="#run安装软件用" title="Direct link to heading">#</a></h4><p>构建指令，RUN 可以运行任何被基础 image 支持的命令。如基础 image 选择了 Centos，那么软件管理部分只能使用 Centos 的包管理命令</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI dockerfile"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">RUN cd /tmp &amp;&amp; curl -L &#x27;http://archive.apache.org/dist/tomcat/tomcat-7/v7.0.8/bin/apache-tomcat-7.0.8.tar.gz&#x27; | tar -xz </span></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN [&quot;/bin/bash&quot;, &quot;-c&quot;, &quot;echo hello&quot;]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="user设置container容器的用户"></a>USER（设置container容器的用户）<a class="hash-link" href="#user设置container容器的用户" title="Direct link to heading">#</a></h4><p>设置指令，设置启动容器的用户，默认是 root 用户</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI dockerfile"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">USER daemon  =  ENTRYPOINT [&quot;memcached&quot;, &quot;-u&quot;, &quot;daemon&quot;]  </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="expose指定容器需要映射到宿主机器的端口"></a>EXPOSE（指定容器需要映射到宿主机器的端口）<a class="hash-link" href="#expose指定容器需要映射到宿主机器的端口" title="Direct link to heading">#</a></h4><p>设置指令，该指令会将容器中的端口映射成宿主机器中的某个端口。当你需要访问容器的时候，可以不是用容器的 IP 地址而是使用宿主机器的 IP 地址和映射后的端口。要完成整个操作需要两个步骤，首先在 Dockerfile 使用 EXPOSE 设置需要映射的容器端口，然后在运行容器的时候指定 -P 选项加上 EXPOSE 设置的端口，这样 EXPOSE 设置的端口号会被随机映射成宿主机器中的一个端口号。也可以指定需要映射到宿主机器的那个端口，这时要确保宿主机器上的端口号没有被使用。EXPOSE指令可以一次设置多个端口号，相应的运行容器的时候，可以配套的多次使用 -p 选项</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI dockerfile"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain"># 映射多个端口  </span></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPOSE port1 port2 port3  </span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># 随机暴露需要运行的端口</span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker run -P image</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># 相应的运行容器使用的命令  </span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker run -p port1 -p port2 -p port3 image  </span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># 还可以指定需要映射到宿主机器上的某个端口号  </span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker run -p host_port1:port1 -p host_port2:port2 -p host_port3:port3 image  </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="env用于设置环境变量"></a>ENV（用于设置环境变量）<a class="hash-link" href="#env用于设置环境变量" title="Direct link to heading">#</a></h4><p>构建指令，在 image 中设置一个环境变量。设置了后，后续的 RUN 命令都可以使用，container 启动后，可以通过 docker inspect 查看这个环境变量，也可以通过在 docker run --env key=value 时设置或修改环境变量。假如你安装了 JAVA 程序，需要设置 JAVA_HOME，那么可以在 Dockerfile 中这样写：</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI dockerfile"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">ENV JAVA_HOME /path/to/java/dirent</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="arg设置变量"></a>ARG（设置变量）<a class="hash-link" href="#arg设置变量" title="Direct link to heading">#</a></h4><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="起作用的时机"></a>起作用的时机<a class="hash-link" href="#起作用的时机" title="Direct link to heading">#</a></h5><ul><li>arg 是在 build 的时候存在的, 可以在 Dockerfile 中当做变量来使用</li><li>env 是容器构建好之后的环境变量, 不能在 Dockerfile 中当参数使用</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="案例-1"></a>案例<a class="hash-link" href="#案例-1" title="Direct link to heading">#</a></h5><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI dockerfile"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain"># Dockerfile</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM redis:3.2-alpine</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">LABEL maintainer=&quot;wangyanglinux@163.com&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ARG REDIS_SET_PASSWORD=developer</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ENV REDIS_PASSWORD ${REDIS_SET_PASSWORD}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">VOLUME /data</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPOSE 6379</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">CMD [&quot;sh&quot;, &quot;-c&quot;, &quot;exec redis-server --requirepass \&quot;$REDIS_PASSWORD\&quot;&quot;]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI dockerfile"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">FROM nginx:1.13.1-alpine</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">LABEL maintainer=&quot;wangyanglinux@163.com&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN mkdir -p /etc/nginx/cert \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &amp;&amp; mkdir -p /etc/nginx/conf.d \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &amp;&amp; mkdir -p /etc/nginx/sites</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY ./nginx.conf /etc/ngixn/nginx.conf</span></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY ./conf.d/ /etc/nginx/conf.d/</span></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY ./cert/ /etc/nginx/cert/</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY ./sites /etc/nginx/sites/</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ARG PHP_UPSTREAM_CONTAINER=php-fpm</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ARG PHP_UPSTREAM_PORT=9000</span></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN echo &quot;upstream php-upstream { server ${PHP_UPSTREAM_CONTAINER}:${PHP_UPSTREAM_PORT}; }&quot; &gt; /etc/nginx/conf.d/upstream.conf</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">VOLUME [&quot;/var/log/nginx&quot;, &quot;/var/www&quot;]</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">WORKDIR /usr/share/nginx/html</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="add从-src-复制文件到-container-的-dest-路径"></a>ADD（从 src 复制文件到 container 的 dest 路径）<a class="hash-link" href="#add从-src-复制文件到-container-的-dest-路径" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI dockerfile"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">ADD &lt;src&gt; &lt;dest&gt;  </span></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;src&gt; 是相对被构建的源目录的相对路径，可以是文件或目录的路径，也可以是一个远程的文件 url;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;dest&gt; 是 container 中的绝对路径</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="copy-从-src-复制文件到-container-的-dest-路径"></a>COPY （从 src 复制文件到 container 的 dest 路径）<a class="hash-link" href="#copy-从-src-复制文件到-container-的-dest-路径" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI dockerfile"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">COPY &lt;src&gt; &lt;dest&gt; </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="volume指定挂载点"></a>VOLUME（指定挂载点）<a class="hash-link" href="#volume指定挂载点" title="Direct link to heading">#</a></h4><p>设置指令，使容器中的一个目录具有持久化存储数据的功能，该目录可以被容器本身使用，也可以共享给其他容器使用。我们知道容器使用的是 AUFS，这种文件系统不能持久化数据，当容器关闭后，所有的更改都会丢失。当容器中的应用有持久化数据的需求时可以在 Dockerfile中 使用该指令</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI dockerfile"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">FROM base  </span></span><span class="token-line" style="color:#393A34"><span class="token plain">VOLUME [&quot;/tmp/data&quot;]  </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="workdir切换目录"></a>WORKDIR（切换目录）<a class="hash-link" href="#workdir切换目录" title="Direct link to heading">#</a></h4><p>设置指令，可以多次切换(相当于cd命令)，对RUN,CMD,ENTRYPOINT生效</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI dockerfile"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">WORKDIR /p1   </span></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN touch a.txt</span></span><span class="token-line" style="color:#393A34"><span class="token plain">WORKDIR p2 </span></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN vim a.txt</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="cmd设置-container-启动时执行的操作"></a>CMD（设置 container 启动时执行的操作）<a class="hash-link" href="#cmd设置-container-启动时执行的操作" title="Direct link to heading">#</a></h4><p>设置指令，用于 container 启动时指定的操作。该操作可以是执行自定义脚本，也可以是执行系统命令。该指令只能在文件中存在一次，如果有多个，则只执行最后一条</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI dockerfile"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">CMD echo “Hello, World!” </span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">CMD /usr/local/nginx/sbin/nginx  tail -f /usr/local/nginx/logs/access.log</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="entrypoint设置container启动时执行的操作"></a>ENTRYPOINT（设置container启动时执行的操作）<a class="hash-link" href="#entrypoint设置container启动时执行的操作" title="Direct link to heading">#</a></h4><p>设置指令，指定容器启动时执行的命令，可以多次设置，但是只有最后一个有效。</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI dockerfile"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">ENTRYPOINT ls -l </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>该指令的使用分为两种情况，一种是独自使用，另一种和 CMD 指令配合使用。当独自使用时，如果你还使用了 CMD 命令且 CMD 是一个完整的可执行的命令，那么 CMD 指令和 ENTRYPOINT 会互相覆盖只有最后一个 CMD 或者 ENTRYPOINT 有效</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI dockerfile"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">CMD echo “Hello, World!” </span></span><span class="token-line" style="color:#393A34"><span class="token plain">ENTRYPOINT ls -l</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># CMD 指令将不会被执行，只有 ENTRYPOINT 指令被执行 </span></span><span class="token-line" style="color:#393A34"><span class="token plain">ENTRYPOINT ls -l</span></span><span class="token-line" style="color:#393A34"><span class="token plain">CMD echo “Hello, World!” </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>另一种用法和 CMD 指令配合使用来指定 ENTRYPOINT 的默认参数，这时 CMD 指令不是一个完整的可执行命令，仅仅是参数部分；ENTRYPOINT 指令只能使用 JSON 方式指定执行命令，而不能指定参数</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI dockerfile"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">FROM ubuntu  </span></span><span class="token-line" style="color:#393A34"><span class="token plain">CMD [&quot;-l&quot;]  </span></span><span class="token-line" style="color:#393A34"><span class="token plain">ENTRYPOINT [&quot;/usr/bin/ls&quot;]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="cmd-与-entrypoint-的较量"></a>CMD 与 ENTRYPOINT 的较量<a class="hash-link" href="#cmd-与-entrypoint-的较量" title="Direct link to heading">#</a></h4><p>官方释义：<a href="https://docs.docker.com/engine/reference/builder/#cmd" target="_blank" rel="noopener noreferrer">https://docs.docker.com/engine/reference/builder/#cmd</a></p><p>cmd 给出的是一个容器的默认的可执行体。也就是容器启动以后，默认的执行的命令</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI dockerfile"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">FROM centos</span></span><span class="token-line" style="color:#393A34"><span class="token plain">CMD echo &quot;hello cmd!&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker run xx </span></span><span class="token-line" style="color:#393A34"><span class="token plain">==&gt; hello cmd!</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果我们在 run 时指定了命令或者有entrypoint，那么 cmd 就会被覆盖。仍然是上面的 image。run 命令变了：</span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker run xx echo glgl</span></span><span class="token-line" style="color:#393A34"><span class="token plain">==&gt; glgl</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>cmd 是默认体系，entrypoint 是正统地用于定义容器启动以后的执行体</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI dockerfile"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">FROM centos </span></span><span class="token-line" style="color:#393A34"><span class="token plain">CMD [&quot;p in cmd&quot;]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ENTRYPOINT [&quot;echo&quot;]</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master01 testd]# docker run --name test1  ent:v1</span></span><span class="token-line" style="color:#393A34"><span class="token plain">p in cmd</span></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master01 testd]# docker run --name test2 ent:v1  p in run</span></span><span class="token-line" style="color:#393A34"><span class="token plain">p in run</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># ENTRYPOINT shell 模式任何 run 和 cmd 的参数都无法被传入到 entrypoint 里。官网推荐第一种用法</span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM centos</span></span><span class="token-line" style="color:#393A34"><span class="token plain">CMD [&quot;p in cmd&quot;]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ENTRYPOINT echo</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="onbuild在子镜像中执行"></a>ONBUILD（在子镜像中执行）<a class="hash-link" href="#onbuild在子镜像中执行" title="Direct link to heading">#</a></h4><p>ONBUILD 指定的命令在构建镜像时并不执行，而是在它的子镜像中执行</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI dockerfile"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">ONBUILD ADD . /app/src</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ONBUILD RUN /usr/local/bin/python-build --dir /app/src</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="stopsignal-signal"></a>STOPSIGNAL signal<a class="hash-link" href="#stopsignal-signal" title="Direct link to heading">#</a></h4><p>STOPSIGNAL 指令设置将发送到容器以退出的系统调用信号。这个信号可以是一个有效的无符号数字，与内核的<code>syscall</code>表中的位置相匹配，例如<code>9</code>，或者是<code>SIGNAME</code>格式的信号名，例如：SIGKILL</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">SIGHUP </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> A 终端挂起或者控制进程终止</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">SIGINT </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> A 键盘中断（如break键被按下）</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">SIGQUIT </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> C 键盘的退出键被按下</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">SIGILL </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> C 非法指令</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">SIGABRT </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> C 由abort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">发出的退出指令</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">SIGFPE </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"> C 浮点异常</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">SIGKILL </span><span class="token number" style="color:#36acaa">9</span><span class="token plain"> AEF Kill信号</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">SIGSEGV </span><span class="token number" style="color:#36acaa">11</span><span class="token plain"> C 无效的内存引用</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">SIGPIPE </span><span class="token number" style="color:#36acaa">13</span><span class="token plain"> A 管道破裂: 写一个没有读端口的管道</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">SIGALRM </span><span class="token number" style="color:#36acaa">14</span><span class="token plain"> A 由alarm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">发出的信号</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">SIGTERM </span><span class="token number" style="color:#36acaa">15</span><span class="token plain"> A 终止信号</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">SIGUSR1 </span><span class="token number" style="color:#36acaa">30,10</span><span class="token plain">,16 A 用户自定义信号1</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">SIGUSR2 </span><span class="token number" style="color:#36acaa">31,12</span><span class="token plain">,17 A 用户自定义信号2</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">SIGCHLD </span><span class="token number" style="color:#36acaa">20,17</span><span class="token plain">,18 B 子进程结束信号</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">SIGCONT </span><span class="token number" style="color:#36acaa">19,18</span><span class="token plain">,25 进程继续（曾被停止的进程）</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">SIGSTOP </span><span class="token number" style="color:#36acaa">17,19</span><span class="token plain">,23 DEF 终止进程</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">SIGTSTP </span><span class="token number" style="color:#36acaa">18,20</span><span class="token plain">,24 D 控制终端（tty）上按下停止键</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">SIGTTIN </span><span class="token number" style="color:#36acaa">21,21</span><span class="token plain">,26 D 后台进程企图从控制终端读</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">SIGTTOU </span><span class="token number" style="color:#36acaa">22,22</span><span class="token plain">,27 D 后台进程企图从控制终端写</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>​	</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="shell-覆盖命令的shell模式所使用的默认-shell"></a>SHELL （覆盖命令的shell模式所使用的默认 shell）<a class="hash-link" href="#shell-覆盖命令的shell模式所使用的默认-shell" title="Direct link to heading">#</a></h4><p>Linux 的默认shell是 [“/bin/sh”, “-c”]，Windows 的是 [“cmd”, “/S”, “/C”]。SHELL 指令必须以 JSON 格式编写。SHELL 指令在有两个常用的且不太相同的本地 shell:cmd 和 powershell，以及可选的 sh 的 windows 上特别有用</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="healthcheck-容器健康状况检查命令"></a>HEALTHCHECK （容器健康状况检查命令）<a class="hash-link" href="#healthcheck-容器健康状况检查命令" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI dockerfile"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">HEALTHCHECK [OPTIONS] CMD command</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    [OPTIONS] 的选项支持以下三中选项</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        --interval=DURATION 两次检查默认的时间间隔为 30 秒</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    --timeout=DURATION 健康检查命令运行超时时长，默认 30 秒</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    --retries=N 当连续失败指定次数后，则容器被认为是不健康的，状态为 unhealthy，默认次数是3</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    CMD后边的命令的返回值决定了本次健康检查是否成功，具体的返回值如下：</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        0: success - 表示容器是健康的</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        1: unhealthy - 表示容器已经不能工作了</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        2: reserved - 保留值</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span><span class="token-line" style="color:#393A34"><span class="token plain">HEALTHCHECK NONE</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># 第一个的功能是在容器内部运行一个命令来检查容器的健康状况</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># 第二个的功能是在基础镜像中取消健康检查命令</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># 为了帮助调试失败的探测，command 写在 stdout 或 stderr 上的任何输出文本（UTF-8编码）都将存储在健康状态中，并且可以通过 docker inspect 进行查询。 这样的输出应该保持简短（目前只存储前4096个字节）</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="注意"></a>注意<a class="hash-link" href="#注意" title="Direct link to heading">#</a></h5><p>HEALTHCHECK 命令只能出现一次，如果出现了多次，只有最后一个生效</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="模板"></a>模板<a class="hash-link" href="#模板" title="Direct link to heading">#</a></h5><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI dockerfile"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">HEALTHCHECK --interval=5m --timeout=3s \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">CMD curl -f http://localhost/ || exit 1</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="查看容器的健康状态"></a>查看容器的健康状态<a class="hash-link" href="#查看容器的健康状态" title="Direct link to heading">#</a></h5><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> inspect –format ‘</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">json .State.Health.Status</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">’ cID</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/docker\Dockerfile语法.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_wj+Z"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/docker/Docker-compose基本语法"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Docker-compose基本语法</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/docker/Docker基础速查"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Docker基础速查 »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 From chalee.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.047caa76.js"></script>
<script src="/assets/js/main.da97ff1e.js"></script>
</body>
</html>