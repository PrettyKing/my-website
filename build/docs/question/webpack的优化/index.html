<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.3">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="卫辰 Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="卫辰 Blog Atom Feed"><title data-react-helmet="true">webpack 及其优化 | 卫辰</title><meta data-react-helmet="true" property="og:url" content="http://githubci.faithcal.com/docs/question/webpack的优化"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="webpack 及其优化 | 卫辰"><meta data-react-helmet="true" name="description" content="### 什么是webpack？"><meta data-react-helmet="true" property="og:description" content="### 什么是webpack？"><link data-react-helmet="true" rel="shortcut icon" href="/favicon.ico"><link data-react-helmet="true" rel="canonical" href="http://githubci.faithcal.com/docs/question/webpack的优化"><link data-react-helmet="true" rel="alternate" href="http://githubci.faithcal.com/docs/question/webpack的优化" hreflang="en"><link data-react-helmet="true" rel="alternate" href="http://githubci.faithcal.com/docs/question/webpack的优化" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.2a08f740.css">
<link rel="preload" href="/assets/js/runtime~main.047caa76.js" as="script">
<link rel="preload" href="/assets/js/main.da97ff1e.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/logo.png" alt="诗的远方" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/logo.png" alt="诗的远方" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">卫辰</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">大前端</a><a class="navbar__item navbar__link" href="/md/devops">devops</a><a class="navbar__item navbar__link" href="/blog">博客</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle displayOnlyInLargeViewport_cxYs react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/logo.png" alt="诗的远方" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/logo.png" alt="诗的远方" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">卫辰</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/intro">大前端</a></li><li class="menu__list-item"><a class="menu__link" href="/md/devops">devops</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">博客</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_lDyR"><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu menu--responsive thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_iZzd" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro">简介</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">浏览器</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/browser/base-1">base-1</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">函数速查</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/function/searchPrams">searchPrams</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">javascript</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/javascript/Proxy&amp;Reflect">Proxy 和 Reflect</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/javascript/design-pattern">设计模式</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/javascript/eventloop">EventLoop</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/javascript/javascript-functional">函数式编程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/javascript/meta-programming">元编程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/javascript/JavaScript高级技巧">JavaScript高级技巧</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/javascript/javaScript常见的错误类型">javaScript常见的错误类型</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/javascript/try-catch-finally执行顺序">有return的情况下try catch finally的执行顺序</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">node</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/node/node-framework">NodeJS 项目架构与优化</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/node/node-ioc">NodeJS 面向切面编程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/node/node-performance">NodeJS 性能调优</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/node/node-ssr">NodeJS 服务端渲染</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">性能调优</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optimize/http">HTTP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optimize/node-performance">NodeJS 性能调优</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optimize/performance-optimization-1">性能优化(一)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optimize/performance-optimization-2">性能优化(二)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optimize/performance-optimization-3">性能优化(三)</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">其他</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/other/C">C语言速成</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/other/CPP">C++ 速成</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/other/docker-publish">Docker 镜像打包和发布基本流程</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">问题描述</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/BFC">BFC相关</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/react-fiber">react的react-fiber</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/vueHooks">vue 中的Hooks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/DNS的解析过程">DNS的解析过程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/React中的有状态和无状态组件">React 中的有状态组件和无状态组件</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/React动态加载路由实现按需加载">React 路由的动态加载模块，实现按需加载</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/Redux属性传递的原理">Redux怎么实现属性传递，介绍下原理</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/TreeShaking的原理">tree-shaking 的原理</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/css-旋转图片">css一直旋转的图片</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/css-水波纹">css水波纹</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/dev-server的运行">dev-server 是怎么跑起来的</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/http3.0及http发展">http3.0 及 http发展历史</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/https获取加密秘钥的过程">https 获取加密秘钥的过程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/localStorage加密原理">LocalStorage 加密原理</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/react中的diff">react diff算法</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/vue&amp;react的异同">vue&amp;react的理解和他们的异同</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/vue.$set原理">vue的 $set原理</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/vue中$方法说明">vue 中所有带$方法的说明</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/vue中的v-model">vue 中的v-model</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/vue的data改编后会重新渲染吗">vue 中data中某个属性改变会触发视图重新渲染的吗</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/vue的dom-diff算法">vue中的dom diff算法</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/vue的keep-alive">vue keep-alive的实现</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/vue的nextTick原理">vue的$nextTick原理</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/vue的seo">vue 针对搜索引擎的seo优化</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/vue的指令">vue中的指令</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/vue移动端滚动穿透问题">vue移动端滚动穿透问题</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/vue组件的通信方式">vue组件的通信方式</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/webpack插件的实现">webpack中插件的实现</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/webpack热更新原理">webpack 热更新原理</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/webpack的loader和plugin">webpack 的loader和plugin</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/question/webpack的优化">webpack 及其优化</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/webpack的模块引用">webpack是怎么处理模块循环引用的情况的?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/从URL到页面加载分析">从输入 URL 到页面加载全过程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/前端的单元测试">前端中的单元测试</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/可提供代码执行环境的沙箱">场景：需求前端有一个编辑器，可提供执行代码的功能，这个执行的沙箱需要注意什么，怎么实现</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/在H5中实现长按保存图片">在H5中实现长按保存图片</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/增量式垃圾回收算法怎么实现的">增量式垃圾回收算法怎么实现的</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/对react的看法">对react的看法，它的优缺点，使用过程中遇到的问题，如何解决的</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/浏览器渲染流程">浏览器渲染流程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/浏览器里点击复制到剪贴板">浏览器里点击复制到剪贴板的方法</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/组件曝光SDK">埋点场景题：如何设计一个通过组件曝光的sdk（计算路由跳转层级、停留时间等）</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/网站的seo处理">网站的seo处理</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/虚拟DOM">对虚拟DOM的理解?虚拟DOM主要做了什么?虚拟DOM本身是什么?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/解析HTML的过程">浏览器解析 HTML 文件的过程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/question/首页优化">提升页面性能和首页优化</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">docker</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docker/Docker image Build 高级">Docker image Build 高级</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docker/Docker-compose基本语法">Docker-compose基本语法</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docker/Dockerfile语法">Dockerfile语法</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docker/Docker基础速查">Docker基础速查</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docker/Docker网络化配置">Docker网络化配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docker/Namespace-网络">Namespace-网络</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docker/Yaml语法">Yaml语法</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docker/docker中进程的信号">docker中进程的信号</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docker/安装Docker软件">安装Docker软件</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Kubernetes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/k8s/k8s-前置环境">k8s-前置环境</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/k8s/redhat8安装docker">redhat8安装docker</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">TypeScript</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/开篇：用正确的方式学习 TypeScript">开篇：用正确的方式学习 TypeScript</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/工欲善其事：打造最舒适的 TypeScript 开发环境">工欲善其事：打造最舒适的 TypeScript 开发环境</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/进入类型的世界：理解原始类型与对象类型">进入类型的世界：理解原始类型与对象类型</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/掌握字面量类型与枚举，让你的类型再精确一些">掌握字面量类型与枚举，让你的类型再精确一些</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/函数与 Class 中的类型：详解函数重载与面向对象">函数与 Class 中的类型：详解函数重载与面向对象</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/探秘内置类型：any、unknown、never 与类型断言">探秘内置类型：any、unknown、never 与类型断言</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/类型编程好帮手：TypeScript 类型工具（上）">类型编程好帮手：TypeScript 类型工具（上）</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/类型编程好帮手：TypeScript 类型工具（下）">类型编程好帮手：TypeScript 类型工具（下）</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/类型编程基石：TypeScript 中无处不在的泛型">类型编程基石：TypeScript 中无处不在的泛型</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/结构化类型系统：类型兼容性判断的幕后">结构化类型系统：类型兼容性判断的幕后</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/类型系统层级：从 Top Type 到 Bottom Type">类型系统层级：从 Top Type 到 Bottom Type</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/类型里的逻辑运算：条件类型与 infer">类型里的逻辑运算：条件类型与 infer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/内置工具类型基础：别再妖魔化工具类型了！">内置工具类型基础：别再妖魔化工具类型了！</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/反方向类型推导：用好上下文相关类型">反方向类型推导：用好上下文相关类型</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/函数类型：协变与逆变的比较">函数类型：协变与逆变的比较</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/了解类型编程与类型体操的意义，找到平衡点">了解类型编程与类型体操的意义，找到平衡点</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/内置工具类型进阶：类型编程进阶">内置工具类型进阶：类型编程进阶</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/基础类型新成员：模板字符串类型入门">基础类型新成员：模板字符串类型入门</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/类型编程新范式：模板字符串工具类型进阶">类型编程新范式：模板字符串工具类型进阶</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/工程层面的类型能力：类型声明、类型指令与命名空间">工程层面的类型能力：类型声明、类型指令与命名空间</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/在 React 中愉快地使用 TypeScript：内置类型与泛型坑位">在 React 中愉快地使用 TypeScript：内置类型与泛型坑位</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/让 ESLint 来约束你的 TypeScript 代码：配置与规则集介绍">让 ESLint 来约束你的 TypeScript 代码：配置与规则集介绍</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/全链路 TypeScript 工具库，找到适合你的工具">全链路 TypeScript 工具库，找到适合你的工具</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/说说 TypeScript 和 ECMAScript 之间那些事儿">说说 TypeScript 和 ECMAScript 之间那些事儿</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/装饰器与反射元数据：了解装饰器基本原理与应用">装饰器与反射元数据：了解装饰器基本原理与应用</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/控制反转与依赖注入：基于装饰器的依赖注入实现">控制反转与依赖注入：基于装饰器的依赖注入实现</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/TSConfig 全解（上）：构建相关配置">TSConfig 全解（上）：构建相关配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/TSConfig 全解（下）：检查相关、工程相关配置">TSConfig 全解（下）：检查相关、工程相关配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/基于 Prisma + NestJs 的 Node API ：前置知识储备">基于 Prisma + NestJs 的 Node API ：前置知识储备</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/基于 Prisma + NestJs 的 Node API ：项目开发与基于 Heroku 部署">基于 Prisma + NestJs 的 Node API ：项目开发与基于 Heroku 部署</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/typescript/玩转 TypeScript AST：AST Checker 与 CodeMod">玩转 TypeScript AST：AST Checker 与 CodeMod</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">工程化</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/devops/CICD">前端工程化之CI/CD</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/devops/K8S">K8S 基础</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="markdown"><header><h1 class="h1Heading_dC7a">webpack 及其优化</h1></header><blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="什么是webpack"></a>什么是webpack？<a class="hash-link" href="#什么是webpack" title="Direct link to heading">#</a></h3><p>webpack是个打包模 快化JavaScript的工具， 它将切文件 都视为模块， 通过loader编译转换文件， 通过plugin注入钩子，最后将输出的资源模块组合 成文件。它主要的配置信息有entry、output、 modules、 plugins. </p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="1优化webpack的构建速度"></a>1)优化Webpack的构建速度<a class="hash-link" href="#1优化webpack的构建速度" title="Direct link to heading">#</a></h2><ul><li>使用高版本的Webpack (使 用webpack4)</li><li>多线程/多实例构建: HappyPack(不维护 了)、thread-loader</li><li>缩小打包作用域:<ul><li>exclude/include (确定loader 规则范围)</li><li>resolve .modules指明第三方模块的绝对路径(减少不必要的查找)</li><li>resolve . extensions尽可能减少后缀尝试的可能性</li><li>noParse 对完全不需要解析的库进行忽略(不去解析但仍会打包到bundle 中，注意被忽略掉的文件里不应该包含import、 require、 define 等模块化语句)</li><li>lgnorePlugin (完全排除模块)</li><li>合理使用alias</li></ul></li><li>充分利用缓存提升二次构建速度;<ul><li>babel-loader 开启缓存</li><li>terser-webpack -plugin开启缓存</li><li>使用cache -loader或者hard-source -webpack -plugin
注意: thread-loader和cache-loader 兩個要一起使用的話， 請先放cache -loader接著是thread -loader最後才是heavy -loader </li></ul></li><li>DLL :<ul><li>使用 DIIPlugin 进行分包，使用DIIReferencePlugin(索引链接) 对manifest.json 引用，让一些基本不会改动的代码先打包成静态资源，避免反复编译浪 费时间。</li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="2使用webpack4优化及原因"></a>2)使用webpack4.优化及原因<a class="hash-link" href="#2使用webpack4优化及原因" title="Direct link to heading">#</a></h2><ul><li>(a)V8带来的优化(for of替代forEach、 Map和Set替代Object、 includes替代indexOf)</li><li>(b)默认使用更快的md4 hash算法</li><li>(c)webpacks AST可以直接从loader传递给AST,减少解析时间</li><li>(d)使用字符串方法替代正则表达式</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="-noparse"></a>① noParse<a class="hash-link" href="#-noparse" title="Direct link to heading">#</a></h3><ul><li>不去解析某个库内部的依赖关系</li><li>比如jquery 这个库是独立的，则不 去解析这个库内部依赖的其他的东西
在独立库的时候可以使用</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">module</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">noParse</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">jquery</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">rules</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="lgnoreplugin"></a>②lgnorePlugin<a class="hash-link" href="#lgnoreplugin" title="Direct link to heading">#</a></h3><ul><li>忽略掉某些内容不去解析依赖库内部引用的某些内容</li><li>从moment中引用. /ocol则忽略掉</li><li>如果要用local的话则必须在项目中必须手动引入</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> &#x27;moment</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">locale</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">zh</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">cn</span></span><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">plugins</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Webpack</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ignorePlugin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">/</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">local</span><span class="token operator" style="color:#393A34">/</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">moment</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="dilplugin"></a>③dilPlugin<a class="hash-link" href="#dilplugin" title="Direct link to heading">#</a></h3><ul><li>不会多次打包，</li><li>优化打包时间</li><li>先把依赖的不变的库打包</li><li>生成manifest.json文件</li><li>然后在webpack.config中引入</li><li>webpack. DIPlugin Webpack . lIReferencePlugin</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="happypack---thread-loader"></a>④happypack -&gt; thread-loader<a class="hash-link" href="#happypack---thread-loader" title="Direct link to heading">#</a></h3><ul><li>大项目的时候开启多线程打包</li><li>影响前端发布速度的有两个方面，一个是构建，-个就是压缩，把这两个东西优化起来，可以减少很多发布的时间。</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="thread-loader"></a>⑤thread-loader<a class="hash-link" href="#thread-loader" title="Direct link to heading">#</a></h3><p>thread-loader 会将您的loader 放置在一个worker 池里面运行，以达到多线程构建。把这个 loader 放置在其他loader之前(如下图example 的位置)，放置在这个loader 之后的loader 就会在-个单独的worker 池(worker pool)中运行。</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// webpack.config.js</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">module</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">rules</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">test</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">\.js$</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">include</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;src&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">use</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token string" style="color:#e3116c">&quot;thread-loader&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// 你的高开销的loader放置在此 (e.g babel-loader)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>每个worker都是一个 单独的有600ms限制的node.js 进程。同时跨进程的数据交换也会被限制。请在高开销的loader中使用， 否则效果不佳</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="压缩加速一开启-多线程压缩"></a>⑥压缩加速一开启 多线程压缩<a class="hash-link" href="#压缩加速一开启-多线程压缩" title="Direct link to heading">#</a></h3><ul><li>不推荐使用webpack-paralle uglify-plugin,项目基本处于没人维护的阶段，issue 没人处理，pr没人合并。
Webpack 4.0以前：uglifyjs-webpack-plugin,parallel参数</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">optimization</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">minimizer</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">UglifyJsPlugin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">parallel</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>推荐使用terser-webpack-plugin</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">optimization</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">minimizer</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">TerserPlugin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">parallel</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// 多线程</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="3优化webpack的打包体积"></a>3)优化Webpack的打包体积<a class="hash-link" href="#3优化webpack的打包体积" title="Direct link to heading">#</a></h2><ul><li>压缩代码<ul><li>webpack paralle-uglify -plugin</li><li>uglifyjs -webpack-plugin 开启parallel 参数(不支持ES6)</li><li>terser -webpack-plugin 开启parallel 参数</li><li>多进程并行压缩</li><li>通过mini-css -extract-plugin 提取Chunk 中的CSS代码到单独文件，通过optimize -CSS -assets -	-		- webpack -plugin插件 开启cssnano 压缩CSS.</li></ul></li><li>提取页面公共资源:<ul><li>使用html-webpack . externals-plugin, 将基础包通过CDN引入，不打入bundle中</li><li>使用SplitChunksPlugin 进行(公共脚本、基础包、页面公共文件)分离(Webpack4内置) ，替代了CommonsChunkPlugin 插件</li><li>基础包分离:将些基础库放到cdn, 比如vue, webpack 配置external是的vue不打入bundle</li></ul></li><li>Tree shaking<ul><li>purgecss-webpack-plugin 和mini-Css -extract- plugin配合使用(建议)</li><li>打包过程中检测工程中没有引用过的模块并进行标记，在资源压缩时将它们从最终的bundle中去掉(只能对ES6 Modlue生效) 开发中尽可能使用ES6 Module的模块，提高tree shaking效率</li><li>禁用babel-loader 的模块依赖解析，否则Webpack接收到的就都是转换过的CommonJS形式的模块，无法进行tree -shaking</li><li>使用PurifyCSS(不在维护) 或者uncss 去除无用CSS代码</li></ul></li><li>Scope hoisting<ul><li>构建后的代码会存在大量闭包，造成体积增大，运行代码时创建的函数作用域变多，内存开销变大。Scope hoisting 将所有模块的代码按照引用顺序放在一个图数作用域里，然后适当的重命名-些变量以防止变量名冲突</li><li>必须是ES6的语法，因为有很多第三方库仍采用CommonJS语法，为了充分发挥Scope hoisting 的作用，需要配置mainFields 对第三方模块优先采用jsnext:main中指向的ES6模块化语法</li></ul></li><li>图片压缩<ul><li>使用基于Node库的imagemin (很多定制选项、可以处理多种图片格式)</li><li>配置image -webpack -loader</li></ul></li><li>动态Polyfill<ul><li>建议采用polill-service 只给用户返回需要的polylill, 社区维护。(部分国内奇葩浏览器UA可能无法识别，但可以降级返回所需全部poyil)</li><li>@babel-preset-env 中通过useBuiltIns: &#x27;usage参数来动态加载plyill。</li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="4-speed-measure-webpack-plugin"></a>4) speed-measure-webpack-plugin<a class="hash-link" href="#4-speed-measure-webpack-plugin" title="Direct link to heading">#</a></h2><p>简称SMP,分析出Webpack打包过程中Loader 和Plugin 的耗时，有助于找到构建过程中的性能瓶颈。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="5构建流程"></a>5)构建流程<a class="hash-link" href="#5构建流程" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="基础概念"></a>基础概念<a class="hash-link" href="#基础概念" title="Direct link to heading">#</a></h3><ol><li><code>Compiler:</code> Webpack的运行入口，实例化时定义webpack构建主要流程，同时创建构建时使用的核心对象compilation</li><li><code>Compilation: </code>由Compiler实例化， 存储构建过程中流程使用到的数据，用于控制这些数据的变化，每次构建创建一 个Compilation实例</li><li><code>Chunk: </code>一般一个入口对应一个Chunk</li><li><code>Module: </code>用于表示代码模块的类型，有很多子类用于处理不同情况的模块，模块相关信息都可以从Module实例中获取，例如dependiencies记录模块的依赖信 息</li><li><code>Parser: </code>基于acorn来分析AST语法树， 解析出代码模块的依赖</li><li><code>Dependency:</code> 解析时用于保存代码模块对应的依赖使用的对象</li><li><code>Template:</code> 生成最终代码要使用到的代码模块</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="基本流程"></a>基本流程<a class="hash-link" href="#基本流程" title="Direct link to heading">#</a></h3><ol><li>创建Compiler实例， 用于控制构建流程，compiler实例包含webpack基本环境信息</li><li>根据配置 项转换成对应内部插件，并初始化options配置项</li><li>执行compiler.run</li><li>创建Compitation实例， 每次构建都会新创建一个Compliation实例， 包含了这次构建的基本信息</li><li>从entry开始递归分析依赖， 对每个依赖模块进行buildModule,通过L .oader将不同类型的模块转换成Webpack模块</li><li>调用Parser .parse将上面的结果转换成AST树</li><li>遍历AST树，收集依赖Dependency, 并保存在Compliation实例的dependiencies属性中</li><li>生成Chunks, 不同entry生 成不同chunk,动态导入也会生成自己的chunk,生成chunk后还会进行优化</li><li>使用Template基 于Compilation的数据生成结果代码</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="编译过程"></a>编译过程<a class="hash-link" href="#编译过程" title="Direct link to heading">#</a></h3><ul><li><code>第一步</code>先初始化参数，通过yargs 将webpack . config .js和hel脚本的配置信息合并，进行参数的初始化;</li><li><code>第二步</code>利用初始化的参数创建complier对象，complier可以视为一个webpack的实例， 存在于webpack从启动到结束的整个过程，它包含了webpack的module、plugin等 参数信息，然后调用complier .run方法开始编译。</li><li><code>第三步</code>根据entry配置信息找到入口文件，创建compilation对象， 可以理解为webpack-次编译的过程，包含了当前编译环境的所有资源，包括编译后的文件。</li><li><code>第四步</code>通过配置信息，调用loader进行模块翻译， 使用acorn将 模块转换为AST,当遇到require依赖时， 创建依赖并加入依赖数组，再找出依赖的依赖，递归异步的处理所有的依赖。</li><li><code>第五步</code>完成第四步后将得到所有模块的依赖关系和模块翻译后的文件，然后调用compilation.seal方法， 对这些模块和根据模块依赖关系创建的chunk进行整理，将所有资源进行合并拆分等操作。这
是最后次能修改输出内容的地方 。</li><li><code>第六步</code>根据配置信息中的output配置，进行最后模块的文件输出，指定输出文件名和文件路径。</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="原理"></a>原理<a class="hash-link" href="#原理" title="Direct link to heading">#</a></h3><p>webpack打包输出后的文件其实就是一一个闭包， 传入的参数是一个对象， 键值为所有输出文件的路径，内容为eval包裹的文件内容;闭包内重写了模块的加载方式，自己定义了<code>__webpack.require_</code> 方法，来实现模拟的commonjs规范模块加载机制。</p><p>Webpack实际上是基于事件流的，通过系列的插件 来运行。Webpack利用tapable库提供各种钩子来实现对于整个构建流程各个步骤的控制。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="持久化缓存"></a>持久化缓存<a class="hash-link" href="#持久化缓存" title="Direct link to heading">#</a></h2><ul><li>服务端设置HTTP缓存头(Cache-Control等)</li><li>打包依赖(dependencies) 和运行时(runtime) 到不同chunk (在 webpack中，编译后的单独文件称为chunk)，即作splitChunks, 因为它们几乎是不变的。</li><li>延迟加载:使用import() 方式， 可以将动态加载的文件分到独立的chunk, 以得到自己的chunkhash</li><li>保证hash值稳定:编译过程和文件内容的更改尽量不影响其他文件hash的计算。对于低版本webpack生成的增量数字ID 不稳定问题，可用HashedModuleIdsPlugin 基于 文件路径生成解决。</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="webpack做了什么"></a>Webpack做了什么<a class="hash-link" href="#webpack做了什么" title="Direct link to heading">#</a></h2><ol><li>webpack本质上只是一个js引用程序的静态打包器，他能够基于文件的依赖，递归的构建-一个文件依赖关系图，最终将文件打包成为一个或者多个bundle; </li><li>webpack基 于entry识别那个/哪些模块是构建打包的入口;</li><li>webpack基于output, 将构建打包的文件输出到指定的目录;</li><li>从入口文件出发 ，调用所有配置的Loader 对模块进行翻译，再找出该模块依赖的模块,再递归本步骤直到所有入口依赖的文件都经过了本步骤的处理。</li><li>经过Loader 翻译完所有模块后，得到了每个模块被翻译后的最终内容以及它们之间的依赖关系。根据入口和模块之间的依赖关系，组装成一个个包含多个模块的Chunk,再把每个Chunk 转换成一个单独的文件加入到输出列表</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="webpack构建时有无做--些自定义操作做的一些自定义操作"></a>webpack构建时有无做- 些自定义操作做的一些自定义操作<a class="hash-link" href="#webpack构建时有无做--些自定义操作做的一些自定义操作" title="Direct link to heading">#</a></h2><ol><li>alias: 指定别名，能在一 定程度上降低开发对文件路径的输入难度，缓存路径能些微提升打包速度;</li><li>module对loader处理添加fallback, 能在loader处理中，依次进行指定的预处理或后处理，自定义loader组件也可以在此进行特殊替换;</li><li>optimization - splitChunks - cacheGroups 自定义打包中的性能优化部分，对共用模块的拆分，识别以及提取后的指定工作;</li><li>自定 义的plugins配置: CopyWebpackPlugin对静态 文件的拷贝，ProgressBarPlugin打 包进度的监控, HappyPack多线程打包等等;</li><li>stats调整打 包过程中控制台的输出，详细到每个文件的大小，耗时及打包状态(warning)等各种显示优化;</li><li>devServer ”before: 添加打包前的优化，可以实现较为简洁的mock数据</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="webpack的整个生命周期"></a>webpack的整个生命周期<a class="hash-link" href="#webpack的整个生命周期" title="Direct link to heading">#</a></h2><p>Webpack的运行流程是一个串行的过程，从启动到结束会依次执行以下流程</p><ul><li><code>初始化参数</code>从配置文件和Shell 语句中读取与合并参数，得出最终的参数</li><li><code>开始编译</code>用上一步得到的参数初始化Compiler 对象，加载所有配置的插件，执行对象的run方法开始执行编译</li><li><code>确定入口</code>根据配置中的entry 找出所有的入口文件</li><li><code>编译模块</code>从入口文件出发，调用所有配置的Loader 对模块进行翻译，再找出该模块依赖的模块，再递归本步骤直到所有入口依赖的文件都经过了本步骤的处理</li><li><code>完成模块编译</code>在经过第4步使用Loader 翻译完所有模块后，得到了每个模块被翻译后的最终内容以及它们之间的依赖关系</li><li><code>输出资源</code>根据入口和模块之间的依赖关系，组装成一个个包含多个模块的Chunk,再把每个Chunk转换成一个单独的文件加入到输出列表，这步是可以修改输出内容的最后机会</li><li><code>输出完成</code>在确定好输出内容后，根据配置确定输出的路径和文件名，把文件内容写入到文件系统</li></ul><p>在以上过程中，Webpack会在特定的时间点广播出特定的事件，插件在监听到感兴趣的事件后会执行特定的逻辑，并且插件可以调用Webpack提供的API改变Webpack的运行结果。</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/question\webpack的优化.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_wj+Z"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/question/webpack的loader和plugin"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« webpack 的loader和plugin</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/question/webpack的模块引用"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">webpack是怎么处理模块循环引用的情况的? »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1优化webpack的构建速度" class="table-of-contents__link">1)优化Webpack的构建速度</a></li><li><a href="#2使用webpack4优化及原因" class="table-of-contents__link">2)使用webpack4.优化及原因</a><ul><li><a href="#-noparse" class="table-of-contents__link">① noParse</a></li><li><a href="#lgnoreplugin" class="table-of-contents__link">②lgnorePlugin</a></li><li><a href="#dilplugin" class="table-of-contents__link">③dilPlugin</a></li><li><a href="#happypack---thread-loader" class="table-of-contents__link">④happypack -&gt; thread-loader</a></li><li><a href="#thread-loader" class="table-of-contents__link">⑤thread-loader</a></li><li><a href="#压缩加速一开启-多线程压缩" class="table-of-contents__link">⑥压缩加速一开启 多线程压缩</a></li></ul></li><li><a href="#3优化webpack的打包体积" class="table-of-contents__link">3)优化Webpack的打包体积</a></li><li><a href="#4-speed-measure-webpack-plugin" class="table-of-contents__link">4) speed-measure-webpack-plugin</a></li><li><a href="#5构建流程" class="table-of-contents__link">5)构建流程</a><ul><li><a href="#基础概念" class="table-of-contents__link">基础概念</a></li><li><a href="#基本流程" class="table-of-contents__link">基本流程</a></li><li><a href="#编译过程" class="table-of-contents__link">编译过程</a></li><li><a href="#原理" class="table-of-contents__link">原理</a></li></ul></li><li><a href="#持久化缓存" class="table-of-contents__link">持久化缓存</a></li><li><a href="#webpack做了什么" class="table-of-contents__link">Webpack做了什么</a></li><li><a href="#webpack构建时有无做--些自定义操作做的一些自定义操作" class="table-of-contents__link">webpack构建时有无做- 些自定义操作做的一些自定义操作</a></li><li><a href="#webpack的整个生命周期" class="table-of-contents__link">webpack的整个生命周期</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 From chalee.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.047caa76.js"></script>
<script src="/assets/js/main.da97ff1e.js"></script>
</body>
</html>