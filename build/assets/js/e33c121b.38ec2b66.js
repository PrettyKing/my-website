"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1497],{1010:(e,a,t)=>{t.r(a),t.d(a,{contentTitle:()=>p,default:()=>s,frontMatter:()=>g,metadata:()=>l,toc:()=>i});var n=t(8168),r=(t(6540),t(5680));const g={},p="DevOps",l={type:"mdx",permalink:"/md/devops",source:"@site/src/pages/md/devops.md"},i=[{value:"\u4e00\u3001DevOps\u4ecb\u7ecd",id:"\u4e00devops\u4ecb\u7ecd",children:[]},{value:"\u4e8c\u3001Code\u9636\u6bb5\u5de5\u5177",id:"\u4e8ccode\u9636\u6bb5\u5de5\u5177",children:[]},{value:"\u4e09\u3001Build\u9636\u6bb5\u5de5\u5177",id:"\u4e09build\u9636\u6bb5\u5de5\u5177",children:[]},{value:"\u56db\u3001Operate\u9636\u6bb5\u5de5\u5177",id:"\u56dboperate\u9636\u6bb5\u5de5\u5177",children:[]},{value:"\u4e94\u3001Integrate\u5de5\u5177",id:"\u4e94integrate\u5de5\u5177",children:[]},{value:"\u516d\u3001CI\u3001CD\u5165\u95e8\u64cd\u4f5c",id:"\u516dcicd\u5165\u95e8\u64cd\u4f5c",children:[]},{value:"\u4e03\u3001\u96c6\u6210Sonar Qube",id:"\u4e03\u96c6\u6210sonar-qube",children:[]},{value:"\u516b\u3001\u96c6\u6210Harbor",id:"\u516b\u96c6\u6210harbor",children:[]},{value:"\u4e5d\u3001Jenkins\u6d41\u6c34\u7ebf",id:"\u4e5djenkins\u6d41\u6c34\u7ebf",children:[]},{value:"\u5341\u3001Kubernetes\u7f16\u6392\u5de5\u5177",id:"\u5341kubernetes\u7f16\u6392\u5de5\u5177",children:[]}],m={toc:i},y="wrapper";function s(e){let{components:a,...t}=e;return(0,r.yg)(y,(0,n.A)({},m,t,{components:a,mdxType:"MDXLayout"}),(0,r.yg)("h1",{id:"devops"},"DevOps"),(0,r.yg)("h3",{id:"\u4e00devops\u4ecb\u7ecd"},"\u4e00\u3001DevOps\u4ecb\u7ecd"),(0,r.yg)("p",null,"\u8f6f\u4ef6\u5f00\u53d1\u6700\u5f00\u59cb\u662f\u7531\u4e24\u4e2a\u56e2\u961f\u7ec4\u6210\uff1a"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"\u5f00\u53d1\u8ba1\u5212\u7531",(0,r.yg)("a",{parentName:"li",href:"https://www.faithcal.com"},"\u5f00\u53d1\u56e2\u961f"),"\u4ece\u5934\u5f00\u59cb\u8bbe\u8ba1\u548c\u6574\u4f53\u7cfb\u7edf\u7684\u6784\u5efa\u3002\u9700\u8981\u7cfb\u7edf\u4e0d\u505c\u7684\u8fed\u4ee3\u66f4\u65b0\u3002"),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"https://www.faithcal.com"},"\u8fd0\u7ef4\u56e2\u961f"),"\u5c06\u5f00\u53d1\u56e2\u961f\u7684Code\u8fdb\u884c\u6d4b\u8bd5\u540e\u90e8\u7f72\u4e0a\u7ebf\u3002\u5e0c\u671b\u7cfb\u7edf\u7a33\u5b9a\u5b89\u5168\u8fd0\u884c\u3002")),(0,r.yg)("p",null,"\u8fd9\u770b\u4f3c\u4e24\u4e2a\u76ee\u6807\u4e0d\u540c\u7684\u56e2\u961f\u9700\u8981\u534f\u540c\u5b8c\u6210\u4e00\u4e2a\u8f6f\u4ef6\u7684\u5f00\u53d1\u3002"),(0,r.yg)("p",null,"\u5728\u5f00\u53d1\u56e2\u961f\u6307\u5b9a\u597d\u8ba1\u5212\u5e76\u5b8c\u6210coding\u540e\uff0c\u9700\u8981\u63d0\u4f9b\u5230\u8fd0\u7ef4\u56e2\u961f\u3002"),(0,r.yg)("p",null,"\u8fd0\u7ef4\u56e2\u961f\u5411\u5f00\u53d1\u56e2\u961f\u53cd\u9988\u9700\u8981\u4fee\u590d\u7684BUG\u4ee5\u53ca\u4e00\u4e9b\u9700\u8981\u8fd4\u5de5\u7684\u4efb\u52a1\u3002"),(0,r.yg)("p",null,"\u8fd9\u65f6\u5f00\u53d1\u56e2\u961f\u9700\u8981\u7ecf\u5e38\u7b49\u5f85\u8fd0\u7ef4\u56e2\u961f\u7684\u53cd\u9988\u3002\u8fd9\u65e0\u7591\u5ef6\u957f\u4e86\u4e8b\u4ef6\u5e76\u63a8\u8fdf\u4e86\u6574\u4e2a\u8f6f\u4ef6\u5f00\u53d1\u7684\u5468\u671f\u3002"),(0,r.yg)("p",null,"\u4f1a\u6709\u4e00\u79cd\u65b9\u5f0f\uff0c\u5728\u5f00\u53d1\u56e2\u961f\u7b49\u5f85\u7684\u65f6\u5019\uff0c\u8ba9\u5f00\u53d1\u56e2\u961f\u8f6c\u79fb\u5230\u4e0b\u4e00\u4e2a\u9879\u76ee\u4e2d\u3002\u7b49\u5f85\u8fd0\u7ef4\u56e2\u961f\u4e3a\u4e4b\u524d\u7684\u4ee3\u7801\u63d0\u4f9b\u53cd\u9988\u3002"),(0,r.yg)("p",null,"\u53ef\u662f\u8fd9\u6837\u5c31\u610f\u5473\u7740\u4e00\u4e2a\u5b8c\u6574\u7684\u9879\u76ee\u9700\u8981\u4e00\u4e2a\u66f4\u957f\u7684\u5468\u671f\u624d\u53ef\u4ee5\u5f00\u53d1\u51fa\u6700\u7ec8\u4ee3\u7801\u3002"),(0,r.yg)("hr",null),(0,r.yg)("p",null,"\u57fa\u4e8e\u73b0\u5728\u7684\u4e92\u8054\u7f51\u73b0\u72b6\uff0c\u66f4\u63a8\u5d07\u654f\u6377\u5f0f\u5f00\u53d1\uff0c\u8fd9\u6837\u5c31\u5bfc\u81f4\u9879\u76ee\u7684\u8fed\u4ee3\u901f\u5ea6\u66f4\u5feb\uff0c\u4f46\u662f\u7531\u4e8e\u5f00\u53d1\u56e2\u961f\u4e0e\u8fd0\u7ef4\u56e2\u961f\u7684\u6c9f\u901a\u95ee\u9898\uff0c\u4f1a\u5bfc\u81f4\u65b0\u7248\u672c\u4e0a\u7ebf\u7684\u65f6\u95f4\u6210\u672c\u5f88\u9ad8\u3002\u8fd9\u53c8\u8fdd\u80cc\u7684\u654f\u6377\u5f0f\u5f00\u53d1\u7684\u6700\u521d\u7684\u76ee\u7684\u3002"),(0,r.yg)("p",null,"\u90a3\u4e48\u5982\u679c\u8ba9\u5f00\u53d1\u56e2\u961f\u548c\u8fd0\u7ef4\u56e2\u961f\u6574\u5408\u5230\u6210\u4e00\u4e2a\u56e2\u961f\uff0c\u534f\u540c\u5e94\u5bf9\u4e00\u5957\u8f6f\u4ef6\u5462\uff1f\u8fd9\u5c31\u88ab\u79f0\u4e3a",(0,r.yg)("a",{parentName:"p",href:"https://www.faithcal.com"},"DevOps"),"\u3002"),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://www.faithcal.com"},"DevOps"),"\uff0c\u5b57\u9762\u610f\u601d\u662fDevelopment &Operations\u7684\u7f29\u5199\uff0c\u4e5f\u5c31\u662f\u5f00\u53d1&\u8fd0\u7ef4\u3002"),(0,r.yg)("p",null,"\u867d\u7136\u5b57\u9762\u610f\u601d\u53ea\u6d89\u53ca\u5230\u4e86\u5f00\u53d1\u56e2\u961f\u548c\u8fd0\u7ef4\u56e2\u961f\uff0c\u5176\u5b9eQA\u6d4b\u8bd5\u56e2\u961f\u4e5f\u662f\u53c2\u4e0e\u5176\u4e2d\u7684\u3002"),(0,r.yg)("p",null,"\u7f51\u4e0a\u53ef\u4ee5\u67e5\u770b\u5230",(0,r.yg)("a",{parentName:"p",href:"https://www.faithcal.com"},"DevOps"),"\u7684\u7b26\u53f7\u7c7b\u4f3c\u4e8e\u4e00\u4e2a\u65e0\u7a77\u5927\u7684\u7b26\u53f7"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},(0,r.yg)("a",{parentName:"th",href:"https://www.faithcal.com"},"DevOps")))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211124130409521.png",alt:"image-20211124130409521"}))))),(0,r.yg)("p",null,"\u8fd9\u8868\u660e",(0,r.yg)("a",{parentName:"p",href:"https://www.faithcal.com"},"DevOps"),"\u662f\u4e00\u4e2a\u4e0d\u65ad\u63d0\u9ad8\u6548\u7387\u5e76\u4e14\u6301\u7eed\u4e0d\u65ad\u5de5\u4f5c\u7684\u8fc7\u7a0b"),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://www.faithcal.com"},"DevOps"),"\u7684\u65b9\u5f0f\u53ef\u4ee5\u8ba9\u516c\u53f8\u80fd\u591f\u66f4\u5feb\u5730\u5e94\u5bf9\u66f4\u65b0\u548c\u5e02\u573a\u53d1\u5c55\u53d8\u5316\uff0c\u5f00\u53d1\u53ef\u4ee5\u5feb\u901f\u4ea4\u4ed8\uff0c\u90e8\u7f72\u4e5f\u66f4\u52a0\u7a33\u5b9a\u3002"),(0,r.yg)("p",null,"\u6838\u5fc3\u5c31\u5728\u4e8e",(0,r.yg)("a",{parentName:"p",href:"https://www.faithcal.com"},"\u7b80\u5316Dev\u548cOps\u56e2\u961f\u4e4b\u95f4\u7684\u6d41\u7a0b\uff0c\u4f7f\u6574\u4f53\u8f6f\u4ef6\u5f00\u53d1\u8fc7\u7a0b\u66f4\u5feb\u901f\u3002")),(0,r.yg)("p",null,"\u6574\u4f53\u7684\u8f6f\u4ef6\u5f00\u53d1\u6d41\u7a0b\u5305\u62ec\uff1a"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"PLAN\uff1a\u5f00\u53d1\u56e2\u961f\u6839\u636e\u5ba2\u6237\u7684\u76ee\u6807\u5236\u5b9a\u5f00\u53d1\u8ba1\u5212"),(0,r.yg)("li",{parentName:"ul"},"CODE\uff1a\u6839\u636ePLAN\u5f00\u59cb\u7f16\u7801\u8fc7\u7a0b\uff0c\u9700\u8981\u5c06\u4e0d\u540c\u7248\u672c\u7684\u4ee3\u7801\u5b58\u50a8\u5728\u4e00\u4e2a\u5e93\u4e2d\u3002"),(0,r.yg)("li",{parentName:"ul"},"BUILD\uff1a\u7f16\u7801\u5b8c\u6210\u540e\uff0c\u9700\u8981\u5c06\u4ee3\u7801\u6784\u5efa\u5e76\u4e14\u8fd0\u884c\u3002"),(0,r.yg)("li",{parentName:"ul"},"TEST\uff1a\u6210\u529f\u6784\u5efa\u9879\u76ee\u540e\uff0c\u9700\u8981\u6d4b\u8bd5\u4ee3\u7801\u662f\u5426\u5b58\u5728BUG\u6216\u9519\u8bef\u3002"),(0,r.yg)("li",{parentName:"ul"},"DEPLOY\uff1a\u4ee3\u7801\u7ecf\u8fc7\u624b\u52a8\u6d4b\u8bd5\u548c\u81ea\u52a8\u5316\u6d4b\u8bd5\u540e\uff0c\u8ba4\u5b9a\u4ee3\u7801\u5df2\u7ecf\u51c6\u5907\u597d\u90e8\u7f72\u5e76\u4e14\u4ea4\u7ed9\u8fd0\u7ef4\u56e2\u961f\u3002"),(0,r.yg)("li",{parentName:"ul"},"OPERATE\uff1a\u8fd0\u7ef4\u56e2\u961f\u5c06\u4ee3\u7801\u90e8\u7f72\u5230\u751f\u4ea7\u73af\u5883\u4e2d\u3002"),(0,r.yg)("li",{parentName:"ul"},"MONITOR\uff1a\u9879\u76ee\u90e8\u7f72\u4e0a\u7ebf\u540e\uff0c\u9700\u8981\u6301\u7eed\u7684\u76d1\u63a7\u4ea7\u54c1\u3002"),(0,r.yg)("li",{parentName:"ul"},"INTEGRATE\uff1a\u7136\u540e\u5c06\u76d1\u63a7\u9636\u6bb5\u6536\u5230\u7684\u53cd\u9988\u53d1\u9001\u56dePLAN\u9636\u6bb5\uff0c\u6574\u4f53\u53cd\u590d\u7684\u6d41\u7a0b\u5c31\u662f",(0,r.yg)("a",{parentName:"li",href:"https://www.faithcal.com"},"DevOps"),"\u7684\u6838\u5fc3\uff0c\u5373\u6301\u7eed\u96c6\u6210\u3001\u6301\u7eed\u90e8\u7f72\u3002")),(0,r.yg)("p",null,"\u4e3a\u4e86\u4fdd\u8bc1\u6574\u4f53\u6d41\u7a0b\u53ef\u4ee5\u9ad8\u6548\u7684\u5b8c\u6210\uff0c\u5404\u4e2a\u9636\u6bb5\u90fd\u6709\u6bd4\u8f83\u5e38\u89c1\u7684\u5de5\u5177\uff0c\u5982\u4e0b\u56fe\uff1a"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u8f6f\u4ef6\u5f00\u53d1\u8fc7\u7a0b&\u6d89\u53ca\u5de5\u5177"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/2021-11-23_175935.png",alt:"2021-11-23_175935"}))))),(0,r.yg)("p",null,"\u6700\u7ec8\u53ef\u4ee5\u7ed9",(0,r.yg)("a",{parentName:"p",href:"https://www.faithcal.com"},"DevOps"),"\u4e0b\u4e00\u4e2a\u5b9a\u4e49\uff1a",(0,r.yg)("a",{parentName:"p",href:"https://www.faithcal.com"},"DevOps \u5f3a\u8c03\u7684\u662f\u9ad8\u6548\u7ec4\u7ec7\u56e2\u961f\u4e4b\u95f4\u5982\u4f55\u901a\u8fc7\u81ea\u52a8\u5316\u7684\u5de5\u5177\u534f\u4f5c\u548c\u6c9f\u901a\u6765\u5b8c\u6210\u8f6f\u4ef6\u7684\u751f\u547d\u5468\u671f\u7ba1\u7406\uff0c\u4ece\u800c\u66f4\u5feb\u3001\u66f4\u9891\u7e41\u5730\u4ea4\u4ed8\u66f4\u7a33\u5b9a\u7684\u8f6f\u4ef6\u3002")),(0,r.yg)("p",null,"\u81ea\u52a8\u5316\u7684\u5de5\u5177\u534f\u4f5c\u548c\u6c9f\u901a\u6765\u5b8c\u6210\u8f6f\u4ef6\u7684\u751f\u547d\u5468\u671f\u7ba1\u7406"),(0,r.yg)("h3",{id:"\u4e8ccode\u9636\u6bb5\u5de5\u5177"},"\u4e8c\u3001Code\u9636\u6bb5\u5de5\u5177"),(0,r.yg)("p",null,"\u5728code\u9636\u6bb5\uff0c\u6211\u4eec\u9700\u8981\u5c06\u4e0d\u540c\u7248\u672c\u7684\u4ee3\u7801\u5b58\u50a8\u5230\u4e00\u4e2a\u4ed3\u5e93\u4e2d\uff0c\u5e38\u89c1\u7684\u7248\u672c\u63a7\u5236\u5de5\u5177\u5c31\u662fSVN\u6216\u8005Git\uff0c\u8fd9\u91cc\u6211\u4eec\u91c7\u7528Git\u4f5c\u4e3a\u7248\u672c\u63a7\u5236\u5de5\u5177\uff0cGitLab\u4f5c\u4e3a\u8fdc\u7a0b\u4ed3\u5e93\u3002"),(0,r.yg)("h4",{id:"21-git\u5b89\u88c5"},"2.1 Git\u5b89\u88c5"),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://git-scm.com/%EF%BC%88%E5%82%BB%E7%93%9C%E5%BC%8F%E5%AE%89%E8%A3%85%EF%BC%89"},"https://git-scm.com/\uff08\u50bb\u74dc\u5f0f\u5b89\u88c5\uff09")),(0,r.yg)("h4",{id:"22-gitlab\u5b89\u88c5"},"2.2 GitLab\u5b89\u88c5"),(0,r.yg)("p",null,"\u5355\u72ec\u51c6\u5907\u670d\u52a1\u5668\uff0c\u91c7\u7528Docker\u5b89\u88c5"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u67e5\u770bGitLab\u955c\u50cf"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"docker search gitlab\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u62c9\u53d6GitLab\u955c\u50cf"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"docker pull gitlab/gitlab-ce\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u51c6\u5907docker-compose.yml\u6587\u4ef6"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-yml"},"version: '3.1'\nservices:\n  gitlab:\n    image: 'gitlab/gitlab-ce:latest'\n    container_name: gitlab\n    restart: always\n    environment:\n      GITLAB_OMNIBUS_CONFIG: |\n        external_url 'http://192.168.11.11:8929'\n        gitlab_rails['gitlab_shell_ssh_port'] = 2224\n    ports:\n      - '8929:8929'\n      - '2224:2224'\n    volumes:\n      - './config:/etc/gitlab'\n      - './logs:/var/log/gitlab'\n      - './data:/var/opt/gitlab'\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u542f\u52a8\u5bb9\u5668\uff08\u9700\u8981\u7a0d\u7b49\u4e00\u5c0f\u4f1a\u2026\u2026\uff09"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"docker-compose up -d\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u8bbf\u95eeGitLab\u9996\u9875"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u9996\u9875"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211124182140596.png",alt:"image-20211124182140596"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u67e5\u770broot\u7528\u6237\u521d\u59cb\u5bc6\u7801"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"docker exec -it gitlab cat /etc/gitlab/initial_root_password\n")),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u521d\u59cb\u5bc6\u7801"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211124182921234.png",alt:"image-20211124182921234"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u767b\u5f55root\u7528\u6237"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u767b\u5f55\u6210\u529f\u540e\u8df3\u8f6c\u9875\u9762"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211124183003858.png",alt:"image-20211124183003858"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u7b2c\u4e00\u6b21\u767b\u5f55\u540e\u9700\u8981\u4fee\u6539\u5bc6\u7801"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u4fee\u6539\u5bc6\u7801"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211124193444561.png",alt:"image-20211124193444561"}))))))),(0,r.yg)("p",null,"\u641e\u5b9a\u540e\uff0c\u5373\u53ef\u50cfGitee\u3001GitHub\u4e00\u6837\u4f7f\u7528\u3002"),(0,r.yg)("h3",{id:"\u4e09build\u9636\u6bb5\u5de5\u5177"},"\u4e09\u3001Build\u9636\u6bb5\u5de5\u5177"),(0,r.yg)("p",null,"\u6784\u5efaJava\u9879\u76ee\u7684\u5de5\u5177\u4e00\u822c\u6709\u4e24\u79cd\u9009\u62e9\uff0c\u4e00\u4e2a\u662fMaven\uff0c\u4e00\u4e2a\u662fGradle\u3002"),(0,r.yg)("p",null,"\u8fd9\u91cc\u6211\u4eec\u9009\u62e9Maven\u4f5c\u4e3a\u9879\u76ee\u7684\u7f16\u8bd1\u5de5\u5177\u3002"),(0,r.yg)("p",null,"\u5177\u4f53\u5b89\u88c5Maven\u6d41\u7a0b\u4e0d\u505a\u9610\u8ff0\uff0c\u4f46\u662f\u9700\u8981\u786e\u4fdd\u914d\u7f6e\u597dMaven\u4ed3\u5e93\u79c1\u670d\u4ee5\u53caJDK\u7f16\u8bd1\u7248\u672c\u3002"),(0,r.yg)("h3",{id:"\u56dboperate\u9636\u6bb5\u5de5\u5177"},"\u56db\u3001Operate\u9636\u6bb5\u5de5\u5177"),(0,r.yg)("p",null,"\u90e8\u7f72\u8fc7\u7a0b\uff0c\u4f1a\u91c7\u7528Docker\u8fdb\u884c\u90e8\u7f72\uff0c\u6682\u65f6\u53ea\u5b89\u88c5Docker\u5373\u53ef\uff0c\u540e\u7eed\u8fd8\u9700\u5b89\u88c5Kubenetes"),(0,r.yg)("h4",{id:"41-docker\u5b89\u88c5"},"4.1 Docker\u5b89\u88c5"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u51c6\u5907\u6d4b\u8bd5\u73af\u5883&\u751f\u4ea7\u73af\u5883")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u4e0b\u8f7dDocker\u4f9d\u8d56\u7ec4\u4ef6"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"yum -y install yum-utils device-mapper-persistent-data lvm2\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u8bbe\u7f6e\u4e0b\u8f7dDocker\u7684\u955c\u50cf\u6e90\u4e3a\u963f\u91cc\u4e91"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u5b89\u88c5Docker\u670d\u52a1"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"yum -y install docker-ce\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u5b89\u88c5\u6210\u529f\u540e\uff0c\u542f\u52a8Docker\u5e76\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"# \u542f\u52a8Docker\u670d\u52a1\nsystemctl start docker\n# \u8bbe\u7f6e\u5f00\u673a\u81ea\u52a8\u542f\u52a8\nsystemctl enable docker\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u6d4b\u8bd5\u5b89\u88c5\u6210\u529f"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"docker version\n")),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u6548\u679c"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211124200317795.png",alt:"image-20211124200317795"}))))))),(0,r.yg)("h4",{id:"42-docker-compose\u5b89\u88c5"},"4.2 Docker-Compose\u5b89\u88c5"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u4e0b\u8f7dDocker/Compose\uff1a",(0,r.yg)("a",{parentName:"p",href:"https://github.com/docker/compose"},"https://github.com/docker/compose"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u5c06\u4e0b\u8f7d\u597d\u7684",(0,r.yg)("a",{parentName:"p",href:"https://www.faithcal.com"},"docker-compose-Linux-x86_64"),"\u6587\u4ef6\u79fb\u52a8\u5230Linux\u64cd\u4f5c\u7cfb\u7edf\uff1a\u2026\u2026")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u8bbe\u7f6e",(0,r.yg)("a",{parentName:"p",href:"https://www.faithcal.com"},"docker-compose-Linux-x86_64"),"\u6587\u4ef6\u6743\u9650\uff0c\u5e76\u79fb\u52a8\u5230$PATH\u76ee\u5f55\u4e2d"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"# \u8bbe\u7f6e\u6587\u4ef6\u6743\u9650\nchmod a+x docker-compose-Linux-x86_64\n# \u79fb\u52a8\u5230/usr/bin\u76ee\u5f55\u4e0b\uff0c\u5e76\u91cd\u547d\u540d\u4e3adocker-compose\nmv docker-compose-Linux-x86_64 /usr/bin/docker-compose\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u6d4b\u8bd5\u5b89\u88c5\u6210\u529f"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"docker-compose version\n")),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u6548\u679c"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211124200658107.png",alt:"image-20211124200658107"}))))))),(0,r.yg)("h3",{id:"\u4e94integrate\u5de5\u5177"},"\u4e94\u3001Integrate\u5de5\u5177"),(0,r.yg)("p",null,"\u6301\u7eed\u96c6\u6210\u3001\u6301\u7eed\u90e8\u7f72\u7684\u5de5\u5177\u5f88\u591a\uff0c\u5176\u4e2dJenkins\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u6301\u7eed\u96c6\u6210\u5e73\u53f0\u3002"),(0,r.yg)("p",null,"Jenkins\u6d89\u53ca\u5230\u5c06\u7f16\u5199\u5b8c\u6bd5\u7684\u4ee3\u7801\u53d1\u5e03\u5230\u6d4b\u8bd5\u73af\u5883\u548c\u751f\u4ea7\u73af\u5883\u7684\u4efb\u52a1\uff0c\u5e76\u4e14\u8fd8\u6d89\u53ca\u5230\u4e86\u6784\u5efa\u9879\u76ee\u7b49\u4efb\u52a1\u3002"),(0,r.yg)("p",null,"Jenkins\u9700\u8981\u5927\u91cf\u7684\u63d2\u4ef6\u4fdd\u8bc1\u5de5\u4f5c\uff0c\u5b89\u88c5\u6210\u672c\u8f83\u9ad8\uff0c\u4e0b\u9762\u4f1a\u57fa\u4e8eDocker\u642d\u5efaJenkins\u3002"),(0,r.yg)("h4",{id:"51-jenkins\u4ecb\u7ecd"},"5.1 Jenkins\u4ecb\u7ecd"),(0,r.yg)("p",null,"Jenkins\u662f\u4e00\u4e2a\u5f00\u6e90\u8f6f\u4ef6\u9879\u76ee\uff0c\u662f\u57fa\u4e8eJava\u5f00\u53d1\u7684\u4e00\u79cd\u6301\u7eed\u96c6\u6210\u5de5\u5177"),(0,r.yg)("p",null,"Jenkins\u5e94\u7528\u5e7f\u6cdb\uff0c\u5927\u591a\u6570\u4e92\u8054\u7f51\u516c\u53f8\u90fd\u91c7\u7528Jenkins\u914d\u5408GitLab\u3001Docker\u3001K8s\u4f5c\u4e3a\u5b9e\u73b0",(0,r.yg)("a",{parentName:"p",href:"https://www.faithcal.com"},"DevOps"),"\u7684\u6838\u5fc3\u5de5\u5177\u3002"),(0,r.yg)("p",null,"Jenkins\u6700\u5f3a\u5927\u7684\u5c31\u5728\u4e8e\u63d2\u4ef6\uff0cJenkins\u5b98\u65b9\u63d0\u4f9b\u4e86\u5927\u91cf\u7684\u63d2\u4ef6\u5e93\uff0c\u6765\u81ea\u52a8\u5316CI/CD\u8fc7\u7a0b\u4e2d\u7684\u5404\u79cd\u7410\u788e\u529f\u80fd\u3002"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"}),(0,r.yg)("th",{parentName:"tr",align:"center"}))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211125141950900.png",alt:"image-20211125141950900"})),(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211125141701495.png",alt:"image-20211124200317795"}))))),(0,r.yg)("p",null,"Jenkins\u6700\u4e3b\u8981\u7684\u5de5\u4f5c\u5c31\u662f\u5c06GitLab\u4e0a\u53ef\u4ee5\u6784\u5efa\u7684\u5de5\u7a0b\u4ee3\u7801\u62c9\u53d6\u5e76\u4e14\u8fdb\u884c\u6784\u5efa\uff0c\u518d\u6839\u636e\u6d41\u7a0b\u53ef\u4ee5\u9009\u62e9\u53d1\u5e03\u5230\u6d4b\u8bd5\u73af\u5883\u6216\u662f\u751f\u4ea7\u73af\u5883\u3002"),(0,r.yg)("p",null,"\u4e00\u822c\u662fGitLab\u4e0a\u7684\u4ee3\u7801\u7ecf\u8fc7\u5927\u91cf\u7684\u6d4b\u8bd5\u540e\uff0c\u786e\u5b9a\u53d1\u884c\u7248\u672c\uff0c\u518d\u53d1\u5e03\u5230\u751f\u4ea7\u73af\u5883\u3002"),(0,r.yg)("p",null,"CI/CD\u53ef\u4ee5\u7406\u89e3\u4e3a\uff1a"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"CI\u8fc7\u7a0b\u5373\u662f\u901a\u8fc7Jenkins\u5c06\u4ee3\u7801\u62c9\u53d6\u3001\u6784\u5efa\u3001\u5236\u4f5c\u955c\u50cf\u4ea4\u7ed9\u6d4b\u8bd5\u4eba\u5458\u6d4b\u8bd5\u3002",(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},"\u6301\u7eed\u96c6\u6210\uff1a\u8ba9\u8f6f\u4ef6\u4ee3\u7801\u53ef\u4ee5\u6301\u7eed\u7684\u96c6\u6210\u5230\u4e3b\u5e72\u4e0a\uff0c\u5e76\u81ea\u52a8\u6784\u5efa\u548c\u6d4b\u8bd5\u3002"))),(0,r.yg)("li",{parentName:"ul"},"CD\u8fc7\u7a0b\u5373\u662f\u901a\u8fc7Jenkins\u5c06\u6253\u597d\u6807\u7b7e\u7684\u53d1\u884c\u7248\u672c\u4ee3\u7801\u62c9\u53d6\u3001\u6784\u5efa\u3001\u5236\u4f5c\u955c\u50cf\u4ea4\u7ed9\u8fd0\u7ef4\u4eba\u5458\u90e8\u7f72\u3002",(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},"\u6301\u7eed\u4ea4\u4ed8\uff1a\u8ba9\u7ecf\u8fc7\u6301\u7eed\u96c6\u6210\u7684\u4ee3\u7801\u53ef\u4ee5\u8fdb\u884c\u624b\u52a8\u90e8\u7f72\u3002"),(0,r.yg)("li",{parentName:"ul"},"\u6301\u7eed\u90e8\u7f72\uff1a\u8ba9\u53ef\u4ee5\u6301\u7eed\u4ea4\u4ed8\u7684\u4ee3\u7801\u968f\u65f6\u968f\u5730\u7684\u81ea\u52a8\u5316\u90e8\u7f72\u3002")))),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"CI\u3001CD"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211125154112097.png",alt:"image-20211125154112097"}))))),(0,r.yg)("h4",{id:"52-jenkins\u5b89\u88c5"},"5.2 Jenkins\u5b89\u88c5"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u62c9\u53d6Jenkins\u955c\u50cf"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre"},"docker pull jenkins/jenkins\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u7f16\u5199docker-compose.yml"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-yml"},'version: "3.1"\nservices:\n  jenkins:\n    image: jenkins/jenkins\n    container_name: jenkins\n    ports:\n      - 8080:8080\n      - 50000:50000\n    volumes:\n      - ./data/:/var/jenkins_home/\n'))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u9996\u6b21\u542f\u52a8\u4f1a\u56e0\u4e3a\u6570\u636e\u5377data\u76ee\u5f55\u6ca1\u6709\u6743\u9650\u5bfc\u81f4\u542f\u52a8\u5931\u8d25\uff0c\u8bbe\u7f6edata\u76ee\u5f55\u5199\u6743\u9650"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u9519\u8bef\u65e5\u5fd7"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211124202610243.png",alt:"image-20211124202610243"}))))),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"chmod -R a+w data/\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u91cd\u65b0\u542f\u52a8Jenkins\u5bb9\u5668\u540e\uff0c\u7531\u4e8eJenkins\u9700\u8981\u4e0b\u8f7d\u5927\u91cf\u5185\u5bb9\uff0c\u4f46\u662f\u7531\u4e8e\u9ed8\u8ba4\u4e0b\u8f7d\u5730\u5740\u4e0b\u8f7d\u901f\u5ea6\u8f83\u6162\uff0c\u9700\u8981\u91cd\u65b0\u8bbe\u7f6e\u4e0b\u8f7d\u5730\u5740\u4e3a\u56fd\u5185\u955c\u50cf\u7ad9"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"# \u4fee\u6539\u6570\u636e\u5377\u4e2d\u7684hudson.model.UpdateCenter.xml\u6587\u4ef6\n<?xml version='1.1' encoding='UTF-8'?>\n<sites>\n  <site>\n    <id>default</id>\n    <url>https://updates.jenkins.io/update-center.json</url>\n  </site>\n</sites>\n# \u5c06\u4e0b\u8f7d\u5730\u5740\u66ff\u6362\u4e3ahttp://mirror.esuni.jp/jenkins/updates/update-center.json\n<?xml version='1.1' encoding='UTF-8'?>\n<sites>\n  <site>\n    <id>default</id>\n    <url>http://mirror.esuni.jp/jenkins/updates/update-center.json</url>\n  </site>\n</sites>\n# \u6e05\u534e\u5927\u5b66\u7684\u63d2\u4ef6\u6e90\u4e5f\u53ef\u4ee5https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u518d\u6b21\u91cd\u542fJenkins\u5bb9\u5668\uff0c\u8bbf\u95eeJenkins\uff08\u9700\u8981\u7a0d\u5fae\u7b49\u4f1a\uff09"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"Jenkins\u9996\u9875"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211124204517433.png",alt:"image-20211124204517433"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211124203336300.png",alt:"image-20211124203336300"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u67e5\u770b\u5bc6\u7801\u767b\u5f55Jenkins\uff0c\u5e76\u767b\u5f55\u4e0b\u8f7d\u63d2\u4ef6"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"docker exec -it jenkins cat /var/jenkins_home/secrets/initialAdminPassword\n")),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u767b\u5f55\u5e76\u4e0b\u8f7d\u63d2\u4ef6"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211124205050484.png",alt:"image-20211124205050484"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211124205513465.png",alt:"image-20211124205513465"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u9009\u62e9\u9700\u8981\u5b89\u88c5\u7684\u63d2\u4ef6"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u9009\u62e9\u9700\u8981\u5b89\u88c5\u7684\u63d2\u4ef6"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211124205854418.png",alt:"image-20211124205854418"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211124205858730.png",alt:"image-20211124205858730"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211124205917317.png",alt:"image-20211124205917317"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u4e0b\u8f7d\u5b8c\u6bd5\u8bbe\u7f6e\u4fe1\u606f\u8fdb\u5165\u9996\u9875\uff08\u53ef\u80fd\u4f1a\u51fa\u73b0\u4e0b\u8f7d\u5931\u8d25\u7684\u63d2\u4ef6\uff09"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null}))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211124211635550.png",alt:"image-20211124211635550"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211124211700999.png",alt:"image-20211124211700999"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211124211720836.png",alt:"image-20211124211720836"}))))))),(0,r.yg)("h4",{id:"53-jenkins\u5165\u95e8\u914d\u7f6e"},"5.3 Jenkins\u5165\u95e8\u914d\u7f6e"),(0,r.yg)("p",null,"\u7531\u4e8eJenkins\u9700\u8981\u4eceGit\u62c9\u53d6\u4ee3\u7801\u3001\u9700\u8981\u672c\u5730\u6784\u5efa\u3001\u751a\u81f3\u9700\u8981\u76f4\u63a5\u53d1\u5e03\u81ea\u5b9a\u4e49\u955c\u50cf\u5230Docker\u4ed3\u5e93\uff0c\u6240\u4ee5Jenkins\u9700\u8981\u914d\u7f6e\u5927\u91cf\u5185\u5bb9\u3002"),(0,r.yg)("h5",{id:"531-\u6784\u5efa\u4efb\u52a1"},"5.3.1 \u6784\u5efa\u4efb\u52a1"),(0,r.yg)("p",null,"\u51c6\u5907\u597dGitLab\u4ed3\u5e93\u4e2d\u7684\u9879\u76ee\uff0c\u5e76\u4e14\u901a\u8fc7Jenkins\u914d\u7f6e\u9879\u76ee\u7684\u5b9e\u73b0\u5f53\u524d\u9879\u76ee\u7684",(0,r.yg)("a",{parentName:"p",href:"https://www.faithcal.com"},"DevOps"),"\u57fa\u672c\u6d41\u7a0b\u3002"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u6784\u5efaMaven\u5de5\u7a0b\u53d1\u5e03\u5230GitLab\uff08Gitee\u3001Github\u5747\u53ef\uff09"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"GitLab\u67e5\u770b\u9879\u76ee"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211125195818670.png",alt:"image-20211125195818670"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"Jenkins\u70b9\u51fb\u5de6\u4fa7\u5bfc\u822a\u65b0\u5efa\u4efb\u52a1"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u65b0\u5efa\u4efb\u52a1"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211125163541645.png",alt:"image-20211125163541645"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u9009\u62e9\u81ea\u7531\u98ce\u683c\u6784\u5efa\u4efb\u52a1"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u6784\u5efa\u4efb\u52a1"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211125170350811.png",alt:"image-20211125170350811"}))))))),(0,r.yg)("h5",{id:"531-\u914d\u7f6e\u6e90\u7801\u62c9\u53d6\u5730\u5740"},"5.3.1 \u914d\u7f6e\u6e90\u7801\u62c9\u53d6\u5730\u5740"),(0,r.yg)("p",null,"Jenkins\u9700\u8981\u5c06Git\u4e0a\u5b58\u653e\u7684\u6e90\u7801\u5b58\u50a8\u5230Jenkins\u670d\u52a1\u6240\u5728\u78c1\u76d8\u7684\u672c\u5730"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u914d\u7f6e\u4efb\u52a1\u6e90\u7801\u62c9\u53d6\u7684\u5730\u5740"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u6e90\u7801\u7ba1\u7406"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211125170418337.png",alt:"image-20211125170418337"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"Jenkins\u7acb\u5373\u6784\u5efa"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u70b9\u51fb\u4efb\u52a1test\u4e2d\u7684\u7acb\u5373\u6784\u5efa"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211125200218093.png",alt:"image-20211125200218093"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u67e5\u770b\u6784\u5efa\u5de5\u7a0b\u7684\u65e5\u5fd7\uff0c\u70b9\u51fb\u4e0a\u8ff0\u2462\u7684\u4efb\u52a1\u6761\u5373\u53ef"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u67e5\u770b\u4efb\u52a1\u62c9\u53d6Git\u6e90\u7801\u65e5\u5fd7"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211125201701443.png",alt:"image-20211125201701443"}))))),(0,r.yg)("p",{parentName:"li"},"\u53ef\u4ee5\u770b\u5230\u6e90\u7801\u5df2\u7ecf\u62c9\u53d6\u5e26Jenkins\u672c\u5730\uff0c\u53ef\u4ee5\u6839\u636e\u7b2c\u4e09\u884c\u65e5\u5fd7\u4fe1\u606f\uff0c\u67e5\u770bJenkins\u672c\u5730\u62c9\u53d6\u5230\u7684\u6e90\u7801\u3002")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u67e5\u770bJenkins\u5bb9\u5668\u4e2d",(0,r.yg)("a",{parentName:"p",href:"https://www.faithcal.com"},"/var/jenkins_home/workspace/test"),"\u7684\u6e90\u7801"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u6e90\u7801\u5b58\u653e\u4f4d\u7f6e"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211125201919108.png",alt:"image-20211125201919108"}))))))),(0,r.yg)("h5",{id:"532-\u914d\u7f6emaven\u6784\u5efa\u4ee3\u7801"},"5.3.2 \u914d\u7f6eMaven\u6784\u5efa\u4ee3\u7801"),(0,r.yg)("p",null,"\u4ee3\u7801\u62c9\u53d6\u5230Jenkins\u672c\u5730\u540e\uff0c\u9700\u8981\u5728Jenkins\u4e2d\u5bf9\u4ee3\u7801\u8fdb\u884c\u6784\u5efa\uff0c\u8fd9\u91cc\u9700\u8981Maven\u7684\u73af\u5883\uff0c\u800cMaven\u9700\u8981Java\u7684\u73af\u5883\uff0c\u63a5\u4e0b\u6765\u9700\u8981\u5728Jenkins\u4e2d\u5b89\u88c5JDK\u548cMaven\uff0c\u5e76\u4e14\u914d\u7f6e\u5230Jenkins\u670d\u52a1\u3002"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u51c6\u5907JDK\u3001Maven\u538b\u7f29\u5305\u901a\u8fc7\u6570\u636e\u5377\u6620\u5c04\u5230Jenkins\u5bb9\u5668\u5185\u90e8"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u6570\u636e\u5377\u5b58\u653e\u4f4d\u7f6e"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211125203757232.png",alt:"image-20211125203757232"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u89e3\u538b\u538b\u7f29\u5305\uff0c\u5e76\u914d\u7f6eMaven\u7684settings.xml"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-xml"},"\x3c!-- \u963f\u91cc\u4e91\u955c\u50cf\u5730\u5740 --\x3e\n<mirror>  \n    <id>alimaven</id>  \n    <name>aliyun maven</name>  \n    <url>http://maven.aliyun.com/nexus/content/groups/public/</url>\n    <mirrorOf>central</mirrorOf>          \n</mirror>\n\x3c!-- JDK1.8\u7f16\u8bd1\u63d2\u4ef6 --\x3e\n<profile>\n    <id>jdk-1.8</id>\n    <activation>\n        <activeByDefault>true</activeByDefault>\n        <jdk>1.8</jdk>\n    </activation>\n    <properties>\n        <maven.compiler.source>1.8</maven.compiler.source>\n        <maven.compiler.target>1.8</maven.compiler.target>\n        <maven.compiler.compilerVersion>1.8</maven.compiler.compilerVersion>\n    </properties>        \n</profile>\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"Jenkins\u914d\u7f6eJDK&Maven\u5e76\u4fdd\u5b58"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null}))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211125204811759.png",alt:"image-20211125204811759"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211125204818869.png",alt:"image-20211125204818869"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u914d\u7f6eJenkins\u4efb\u52a1\u6784\u5efa\u4ee3\u7801"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u914d\u7f6eMaven\u6784\u5efa\u4ee3\u7801"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211125205027013.png",alt:"image-20211125205027013"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211125205020738.png",alt:"image-20211125205020738"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u7acb\u5373\u6784\u5efa\u6d4b\u8bd5\uff0c\u67e5\u770btarget\u4e0b\u7684jar\u5305"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u6784\u5efa\u6e90\u7801"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211125205240208.png",alt:"image-20211125205240208"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211125205725948.png",alt:"image-20211125205725948"}))))))),(0,r.yg)("h5",{id:"533-\u914d\u7f6epublish\u53d1\u5e03\u8fdc\u7a0b\u64cd\u4f5c"},"5.3.3 \u914d\u7f6ePublish\u53d1\u5e03&\u8fdc\u7a0b\u64cd\u4f5c"),(0,r.yg)("p",null,"jar\u5305\u6784\u5efa\u597d\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u6839\u636e\u60c5\u51b5\u53d1\u5e03\u5230\u6d4b\u8bd5\u6216\u751f\u4ea7\u73af\u5883\uff0c\u8fd9\u91cc\u9700\u8981\u7528\u5230\u4e4b\u524d\u4e0b\u8f7d\u597d\u7684\u63d2\u4ef6Publish Over SSH\u3002"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u914d\u7f6ePublish Over SSH\u8fde\u63a5\u6d4b\u8bd5\u3001\u751f\u4ea7\u73af\u5883"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"Publish Over SSH\u914d\u7f6e"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211125210148202.png",alt:"image-20211125210148202"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u914d\u7f6e\u4efb\u52a1\u7684\u6784\u5efa\u540e\u64cd\u4f5c\uff0c\u53d1\u5e03jar\u5305\u5230\u76ee\u6807\u670d\u52a1"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u914d\u7f6e\u6784\u5efa\u540e\u64cd\u4f5c"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211125205027013.png",alt:"image-20211125205027013"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211125210424346.png",alt:"image-20211125210424346"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211125210626631.png",alt:"image-20211125210626631"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u7acb\u5373\u6784\u5efa\u4efb\u52a1\uff0c\u5e76\u53bb\u76ee\u6807\u670d\u52a1\u67e5\u770b"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u7acb\u5373\u6784\u5efa"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211125210755556.png",alt:"image-20211125210755556"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211125210826057.png",alt:"image-20211125210826057"}))))))),(0,r.yg)("h3",{id:"\u516dcicd\u5165\u95e8\u64cd\u4f5c"},"\u516d\u3001CI\u3001CD\u5165\u95e8\u64cd\u4f5c"),(0,r.yg)("p",null,"\u57fa\u4e8eJenkins\u62c9\u53d6GitLab\u7684SpringBoot\u4ee3\u7801\u8fdb\u884c\u6784\u5efa\u53d1\u5e03\u5230\u6d4b\u8bd5\u73af\u5883\u5b9e\u73b0\u6301\u7eed\u96c6\u6210"),(0,r.yg)("p",null,"\u57fa\u4e8eJenkins\u62c9\u53d6GitLab\u6307\u5b9a\u53d1\u884c\u7248\u672c\u7684SpringBoot\u4ee3\u7801\u8fdb\u884c\u6784\u5efa\u53d1\u5e03\u5230\u751f\u4ea7\u73af\u5883\u5b9e\u73b0CD\u5b9e\u73b0\u6301\u7eed\u90e8\u7f72"),(0,r.yg)("h4",{id:"61-\u6301\u7eed\u96c6\u6210"},"6.1 \u6301\u7eed\u96c6\u6210"),(0,r.yg)("p",null,"\u4e3a\u4e86\u8ba9\u7a0b\u5e8f\u4ee3\u7801\u53ef\u4ee5\u81ea\u52a8\u63a8\u9001\u5230\u6d4b\u8bd5\u73af\u5883\u57fa\u4e8eDocker\u670d\u52a1\u8fd0\u884c\uff0c\u9700\u8981\u6dfb\u52a0Docker\u914d\u7f6e\u548c\u811a\u672c\u6587\u4ef6\u8ba9\u7a0b\u5e8f\u53ef\u4ee5\u5728\u96c6\u6210\u5230\u4e3b\u5e72\u7684\u540c\u65f6\u8fd0\u884c\u8d77\u6765\u3002"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u6dfb\u52a0Dockerfile\u6587\u4ef6"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u6784\u5efa\u81ea\u5b9a\u4e49\u955c\u50cf"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211126161304485.png",alt:"image-20211126161304485"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u6dfb\u52a0docker-compose.yml\u6587\u4ef6"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u52a0\u8f7d\u81ea\u5b9a\u4e49\u955c\u50cf\u542f\u52a8\u5bb9\u5668"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211126161331991.png",alt:"image-20211126161331991"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u8ffd\u52a0Jenkins\u6784\u5efa\u540e\u64cd\u4f5c\u811a\u672c\u547d\u4ee4"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u6784\u5efa\u540e\u53d1\u5e03\u5e76\u6267\u884c\u811a\u672c\u547d\u4ee4"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211126161408514.png",alt:"image-20211126161408514"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u53d1\u5e03\u5230GitLab\u540e\u7531Jenkins\u7acb\u5373\u6784\u5efa\u5e76\u6258\u9001\u5230\u76ee\u6807\u670d\u52a1\u5668"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u6784\u5efa\u65e5\u5fd7"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211126161448527.png",alt:"image-20211126161448527"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u6d4b\u8bd5\u90e8\u7f72\u5230\u76ee\u6807\u670d\u52a1\u5668\u7a0b\u5e8f"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u67e5\u770b\u76ee\u6807\u670d\u52a1\u5668\u5e76\u6d4b\u8bd5\u63a5\u53e3"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211126161504715.png",alt:"image-20211126161504715"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211126161509411.png",alt:"image-20211126161509411"}))))))),(0,r.yg)("h4",{id:"62-\u6301\u7eed\u4ea4\u4ed8\u90e8\u7f72"},"6.2 \u6301\u7eed\u4ea4\u4ed8\u3001\u90e8\u7f72"),(0,r.yg)("p",null,"\u7a0b\u5e8f\u4ee3\u7801\u5728\u7ecf\u8fc7\u591a\u6b21\u96c6\u6210\u64cd\u4f5c\u5230\u8fbe\u6700\u7ec8\u53ef\u4ee5\u4ea4\u4ed8\uff0c\u6301\u7eed\u4ea4\u4ed8\u6574\u4f53\u6d41\u7a0b\u548c\u6301\u7eed\u96c6\u6210\u7c7b\u4f3c\uff0c\u4e0d\u8fc7\u9700\u8981\u9009\u53d6\u6307\u5b9a\u7684\u53d1\u884c\u7248\u672c"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u4e0b\u8f7dGit Parameter\u63d2\u4ef6"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u4e0b\u8f7dGit Parameter"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211126165209057.png",alt:"image-20211126165209057"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u8bbe\u7f6e\u9879\u76ee\u53c2\u6570\u5316\u6784\u5efa"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u57fa\u4e8eGit\u6807\u7b7e\u6784\u5efa"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211126165444124.png",alt:"image-20211126165444124"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211126172828266.png",alt:"image-20211126172828266"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u7ed9\u9879\u76ee\u6dfb\u52a0tag\u7248\u672c"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u6dfb\u52a0tag\u7248\u672c"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211126165639286.png",alt:"image-20211126165639286"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u4efb\u52a1\u6784\u5efa\u65f6\uff0c\u91c7\u7528Shell\u65b9\u5f0f\u6784\u5efa\uff0c\u62c9\u53d6\u6307\u5b9atag\u7248\u672c\u4ee3\u7801"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u5207\u6362\u6307\u5b9a\u6807\u7b7e\u5e76\u6784\u5efa\u9879\u76ee"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211126174715028.png",alt:"image-20211126174715028"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u57fa\u4e8eParameter\u6784\u5efa\u4efb\u52a1\uff0c\u4efb\u52a1\u53d1\u5e03\u5230\u76ee\u6807\u670d\u52a1\u5668"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u6784\u5efa\u4efb\u52a1"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211126174159487.png",alt:"image-20211126174159487"}))))))),(0,r.yg)("h3",{id:"\u4e03\u96c6\u6210sonar-qube"},"\u4e03\u3001\u96c6\u6210Sonar Qube"),(0,r.yg)("h4",{id:"71-sonar-qube\u4ecb\u7ecd"},"7.1 Sonar Qube\u4ecb\u7ecd"),(0,r.yg)("p",null,"Sonar Qube\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u4ee3\u7801\u5206\u6790\u5e73\u53f0\uff0c\u652f\u6301Java\u3001Python\u3001PHP\u3001JavaScript\u3001CSS\u7b4925\u79cd\u4ee5\u4e0a\u7684\u8bed\u8a00\uff0c\u53ef\u4ee5\u68c0\u6d4b\u51fa\u91cd\u590d\u4ee3\u7801\u3001\u4ee3\u7801\u6f0f\u6d1e\u3001\u4ee3\u7801\u89c4\u8303\u548c\u5b89\u5168\u6027\u6f0f\u6d1e\u7684\u95ee\u9898\u3002"),(0,r.yg)("p",null,"Sonar Qube\u53ef\u4ee5\u4e0e\u591a\u79cd\u8f6f\u4ef6\u6574\u5408\u8fdb\u884c\u4ee3\u7801\u626b\u63cf\uff0c\u6bd4\u5982Maven\uff0cGradle\uff0cGit\uff0cJenkins\u7b49\uff0c\u5e76\u4e14\u4f1a\u5c06\u4ee3\u7801\u68c0\u6d4b\u7ed3\u679c\u63a8\u9001\u56deSonar Qube\u5e76\u4e14\u5728\u7cfb\u7edf\u63d0\u4f9b\u7684UI\u754c\u9762\u4e0a\u663e\u793a\u51fa\u6765"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"Sonar Qube\u7684UI\u754c\u9762"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211129190039986.png",alt:"image-20211129190039986"}))))),(0,r.yg)("h4",{id:"72-sonar-qube\u73af\u5883\u642d\u5efa"},"7.2 Sonar Qube\u73af\u5883\u642d\u5efa"),(0,r.yg)("h5",{id:"721-sonar-qube\u5b89\u88c5"},"7.2.1 Sonar Qube\u5b89\u88c5"),(0,r.yg)("p",null,"Sonar Qube\u57287.9\u7248\u672c\u4e2d\u5df2\u7ecf\u653e\u5f03\u4e86\u5bf9MySQL\u7684\u652f\u6301\uff0c\u5e76\u4e14\u5efa\u8bae\u5728\u5546\u4e1a\u73af\u5883\u4e2d\u91c7\u7528PostgreSQL\uff0c\u90a3\u4e48\u5b89\u88c5Sonar Qube\u65f6\u9700\u8981\u4f9d\u8d56PostgreSQL\u3002"),(0,r.yg)("p",null,"\u5e76\u4e14\u8fd9\u91cc\u4f1a\u5b89\u88c5Sonar Qube\u7684\u957f\u671f\u652f\u6301\u7248\u672c",(0,r.yg)("a",{parentName:"p",href:"https://www.faithcal.com"},"8.9")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u62c9\u53d6\u955c\u50cf"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"docker pull postgres\ndocker pull sonarqube:8.9.3-community\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u7f16\u5199docker-compoe.yml"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-yml"},'version: "3.1"\nservices:\n  db:\n    image: postgres\n    container_name: db\n    ports:\n      - 5432:5432\n    networks:\n      - sonarnet\n    environment:\n      POSTGRES_USER: sonar\n      POSTGRES_PASSWORD: sonar\n  sonarqube:\n    image: sonarqube:8.9.3-community\n    container_name: sonarqube\n    depends_on:\n      - db\n    ports:\n      - "9000:9000"\n    networks:\n      - sonarnet\n    environment:\n      SONAR_JDBC_URL: jdbc:postgresql://db:5432/sonar\n      SONAR_JDBC_USERNAME: sonar\n      SONAR_JDBC_PASSWORD: sonar\nnetworks:\n  sonarnet:\n    driver: bridge\n'))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u542f\u52a8\u5bb9\u5668"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre"},"docker-compose up -d\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u9700\u8981\u8bbe\u7f6esysctl.conf\u6587\u4ef6\u4fe1\u606f"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u8bbe\u7f6evm.max_map_count"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211207145215817.png",alt:"image-20211207145215817"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211207145342350.png",alt:"image-20211207145342350"}))))),(0,r.yg)("p",{parentName:"li"},"\u5e76\u6267\u884c\u547d\u4ee4\u5237\u65b0"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre"},"sysctl -p\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u91cd\u65b0\u542f\u52a8\u9700\u8981\u4e00\u5b9a\u65f6\u95f4\u542f\u52a8\uff0c\u53ef\u4ee5\u53ef\u4ee5\u67e5\u770b\u5bb9\u5668\u65e5\u5fd7\uff0c\u770b\u5230\u5982\u4e0b\u5185\u5bb9\u4ee3\u8868\u542f\u52a8\u6210\u529f"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u5bb9\u5668\u65e5\u5fd7"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211129191426344.png",alt:"image-20211129191426344"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u8bbf\u95eeSonar Qube\u9996\u9875"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u767b\u5f55"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211129191537050.png",alt:"image-20211129191537050"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u8fd8\u9700\u8981\u91cd\u65b0\u8bbe\u7f6e\u4e00\u6b21\u5bc6\u7801"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u91cd\u65b0\u8bbe\u7f6e\u5bc6\u7801"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211129193824428.png",alt:"image-20211129193824428"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"Sonar Qube\u9996\u9875"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"Sonar Qube\u9996\u9875"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211129194148239.png",alt:"image-20211129194148239"}))))))),(0,r.yg)("h5",{id:"722-\u5b89\u88c5\u4e2d\u6587\u63d2\u4ef6"},"7.2.2 \u5b89\u88c5\u4e2d\u6587\u63d2\u4ef6"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u5b89\u88c5\u4e2d\u6587\u63d2\u4ef6"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211129194621820.png",alt:"image-20211129194621820"}))))),(0,r.yg)("p",null,"\u5b89\u88c5\u6210\u529f\u540e\u9700\u8981\u91cd\u542f\uff0c\u5b89\u88c5\u5931\u8d25\u91cd\u65b0\u70b9\u51fbinstall\u91cd\u88c5\u5373\u53ef\u3002"),(0,r.yg)("p",null,"\u5b89\u88c5\u6210\u529f\u540e\uff0c\u4f1a\u67e5\u770b\u5230\u91cd\u542f\u6309\u94ae\uff0c\u70b9\u51fb\u5373\u53ef"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u91cd\u542f\u6309\u94ae"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211129194748765.png",alt:"image-20211129194748765"}))))),(0,r.yg)("p",null,"\u91cd\u542f\u540e\u67e5\u770b\u6548\u679c"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u9996\u9875\u6548\u679c"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211129194931944.png",alt:"image-20211129194931944"}))))),(0,r.yg)("h4",{id:"73-sonar-qube\u57fa\u672c\u4f7f\u7528"},"7.3 Sonar Qube\u57fa\u672c\u4f7f\u7528"),(0,r.yg)("p",null,"Sonar Qube\u7684\u4f7f\u7528\u65b9\u5f0f\u5f88\u591a\uff0cMaven\u53ef\u4ee5\u6574\u5408\uff0c\u4e5f\u53ef\u4ee5\u91c7\u7528sonar-scanner\u7684\u65b9\u5f0f\uff0c\u518d\u67e5\u770bSonar Qube\u7684\u68c0\u6d4b\u6548\u679c"),(0,r.yg)("h5",{id:"731-maven\u5b9e\u73b0\u4ee3\u7801\u68c0\u6d4b"},"7.3.1 Maven\u5b9e\u73b0\u4ee3\u7801\u68c0\u6d4b"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u4fee\u6539Maven\u7684settings.xml\u6587\u4ef6\u914d\u7f6eSonar Qube\u4fe1\u606f"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-xml"},"<profile>\n    <id>sonar</id>\n    <activation>\n        <activeByDefault>true</activeByDefault>\n    </activation>\n    <properties>\n        <sonar.login>admin</sonar.login>\n        <sonar.password>123456789</sonar.password>\n        <sonar.host.url>http://192.168.11.11:9000</sonar.host.url>\n    </properties>\n</profile>\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u5728\u4ee3\u7801\u4f4d\u7f6e\u6267\u884c\u547d\u4ee4\uff1amvn sonar:sonar"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u6267\u884c\u4ee3\u7801\u68c0\u6d4b"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211129195430146.png",alt:"image-20211129195430146"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u67e5\u770bSonar Qube\u754c\u9762\u68c0\u6d4b\u7ed3\u679c"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"Sonar Qube\u68c0\u6d4b\u7ed3\u679c"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211129195503762.png",alt:"image-20211129195503762"}))))))),(0,r.yg)("h5",{id:"732-sonar-scanner\u5b9e\u73b0\u4ee3\u7801\u68c0\u6d4b"},"7.3.2 Sonar-scanner\u5b9e\u73b0\u4ee3\u7801\u68c0\u6d4b"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u4e0b\u8f7dSonar-scanner\uff1a",(0,r.yg)("a",{parentName:"p",href:"https://binaries.sonarsource.com/Distribution/sonar-scanner-cli/"},"https://binaries.sonarsource.com/Distribution/sonar-scanner-cli/")),(0,r.yg)("p",{parentName:"li"},"\u4e0b\u8f7d4.6.x\u7248\u672c\u5373\u53ef\uff0c\u8981\u6c42Linux\u7248\u672c")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u89e3\u538b\u5e76\u914d\u7f6esonar\u670d\u52a1\u7aef\u4fe1\u606f"),(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u7531\u4e8e\u662fzip\u538b\u7f29\u5305\uff0c\u9700\u8981\u5b89\u88c5unzip\u89e3\u538b\u63d2\u4ef6"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"yum -y install unzip\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u89e3\u538b\u538b\u7f29\u5305"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"unzip sonar-scanner-cli/sonar-scanner-cli-4.6.0.2311-linux.zip\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u914d\u7f6esonarQube\u670d\u52a1\u7aef\u5730\u5740\uff0c\u4fee\u6539conf\u4e0b\u7684sonar-scanner.properties"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u914d\u7f6e\u670d\u52a1\u7aef\u4fe1\u606f"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211130140043382.png",alt:"image-20211130140043382"})))))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u6267\u884c\u547d\u4ee4\u68c0\u6d4b\u4ee3\u7801"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"# \u5728\u9879\u76ee\u6240\u5728\u76ee\u5f55\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\n~/sonar-scanner/bin/sonar-scanner -Dsonar.sources=./ -Dsonar.projectname=demo -Dsonar.projectKey=java -Dsonar.java.binaries=target/\n")),(0,r.yg)("p",{parentName:"li"},(0,r.yg)("a",{parentName:"p",href:"https://www.faithcal.com"},"Ps\uff1a\u4e3b\u8981\u67e5\u770b\u6211\u7684sonar-scanner\u6267\u884c\u547d\u4ee4\u7684\u4f4d\u7f6e")),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u67e5\u770b\u65e5\u5fd7\u4fe1\u606f"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211130141303457.png",alt:"image-20211130141303457"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u67e5\u770bSonarQube\u754c\u9762\u68c0\u6d4b\u7ed3\u679c"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u68c0\u6d4b\u7ed3\u679c"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211130144608025.png",alt:"image-20211130144608025"}))))))),(0,r.yg)("h4",{id:"74-jenkins\u96c6\u6210sonar-qube"},"7.4 Jenkins\u96c6\u6210Sonar Qube"),(0,r.yg)("p",null,"Jenkins\u7ee7\u627fSonar Qube\u5b9e\u73b0\u4ee3\u7801\u626b\u63cf\u9700\u8981\u5148\u4e0b\u8f7d\u6574\u5408\u63d2\u4ef6"),(0,r.yg)("h5",{id:"741-jenkins\u5b89\u88c5\u63d2\u4ef6"},"7.4.1 Jenkins\u5b89\u88c5\u63d2\u4ef6"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u4e0b\u8f7dSonar Qube\u63d2\u4ef6"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211129201625561.png",alt:"image-20211129201625561"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211129201607240.png",alt:"image-20211129201607240"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211129202147390.png",alt:"image-20211129202147390"}))))),(0,r.yg)("h5",{id:"742-jenkins\u914d\u7f6esonar-qube"},"7.4.2 Jenkins\u914d\u7f6eSonar Qube"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u5f00\u542fSonar Qube\u6743\u9650\u9a8c\u8bc1"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u5f00\u542fSonar Qube\u6743\u9650\u6821\u9a8c"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211130144850186.png",alt:"image-20211130144850186"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u83b7\u53d6Sonar Qube\u7684\u4ee4\u724c"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u83b7\u53d6\u4ee4\u724c"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211129203102334.png",alt:"image-20211129203102334"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u914d\u7f6eJenkins\u7684Sonar Qube\u4fe1\u606f"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null}))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211129203235019.png",alt:"image-20211129203235019"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211129203342171.png",alt:"image-20211129203342171"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211129203457604.png",alt:"image-20211129203457604"}))))))),(0,r.yg)("h5",{id:"743-\u914d\u7f6esonar-scanner"},"7.4.3 \u914d\u7f6eSonar-scanner"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u5c06Sonar-scaner\u6dfb\u52a0\u5230Jenkins\u6570\u636e\u5377\u4e2d\u5e76\u914d\u7f6e\u5168\u5c40\u914d\u7f6e"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u914d\u7f6eSonar-scanner"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211130153628925.png",alt:"image-20211130153628925"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u914d\u7f6e\u4efb\u52a1\u7684Sonar-scanner"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u914d\u7f6e\u4efb\u52a1\u7684Sonar-scanner"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211130155849143.png",alt:"image-20211130155849143"}))))))),(0,r.yg)("h5",{id:"744-\u6784\u5efa\u4efb\u52a1"},"7.4.4 \u6784\u5efa\u4efb\u52a1"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u6784\u5efa\u4efb\u52a1"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211130160017465.png",alt:"image-20211130160017465"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211130160047648.png",alt:"image-20211130160047648"}))))),(0,r.yg)("h3",{id:"\u516b\u96c6\u6210harbor"},"\u516b\u3001\u96c6\u6210Harbor"),(0,r.yg)("h4",{id:"81-harbor\u4ecb\u7ecd"},"8.1 Harbor\u4ecb\u7ecd"),(0,r.yg)("p",null,"\u524d\u9762\u5728\u90e8\u7f72\u9879\u76ee\u65f6\uff0c\u6211\u4eec\u4e3b\u8981\u91c7\u7528Jenkins\u63a8\u9001jar\u5305\u5230\u6307\u5b9a\u670d\u52a1\u5668\uff0c\u518d\u901a\u8fc7\u811a\u672c\u547d\u4ee4\u8ba9\u76ee\u6807\u670d\u52a1\u5668\u5bf9\u5f53\u524djar\u8fdb\u884c\u90e8\u7f72\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5728\u9879\u76ee\u8f83\u591a\u65f6\uff0c\u6bcf\u4e2a\u76ee\u6807\u670d\u52a1\u5668\u90fd\u9700\u8981\u5c06jar\u5305\u5236\u4f5c\u6210\u81ea\u5b9a\u4e49\u955c\u50cf\u518d\u901a\u8fc7docker\u8fdb\u884c\u542f\u52a8\uff0c\u91cd\u590d\u64cd\u4f5c\u6bd4\u8f83\u591a\uff0c\u4f1a\u964d\u4f4e\u9879\u76ee\u90e8\u7f72\u65f6\u95f4\u3002"),(0,r.yg)("p",null,"\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7Harbor\u4f5c\u4e3a\u79c1\u6709\u7684Docker\u955c\u50cf\u4ed3\u5e93\u3002\u8ba9Jenkins\u7edf\u4e00\u5c06\u9879\u76ee\u6253\u5305\u5e76\u5236\u4f5c\u6210Docker\u955c\u50cf\u53d1\u5e03\u5230Harbor\u4ed3\u5e93\u4e2d\uff0c\u53ea\u9700\u8981\u901a\u77e5\u76ee\u6807\u670d\u52a1\uff0c\u8ba9\u76ee\u6807\u670d\u52a1\u7edf\u4e00\u53bbHarbor\u4ed3\u5e93\u4e0a\u62c9\u53d6\u955c\u50cf\u5e76\u5728\u672c\u5730\u90e8\u7f72\u5373\u53ef\u3002"),(0,r.yg)("p",null,"Docker\u5b98\u65b9\u63d0\u4f9b\u4e86Registry\u955c\u50cf\u4ed3\u5e93\uff0c\u4f46\u662fRegistry\u7684\u529f\u80fd\u76f8\u5bf9\u7b80\u964b\u3002Harbor\u662fVMware\u516c\u53f8\u63d0\u4f9b\u7684\u4e00\u6b3e\u955c\u50cf\u4ed3\u5e93\uff0c\u63d0\u4f9b\u4e86\u6743\u9650\u63a7\u5236\u3001\u5206\u5e03\u5f0f\u53d1\u5e03\u3001\u5f3a\u5927\u7684\u5b89\u5168\u626b\u63cf\u4e0e\u5ba1\u67e5\u673a\u5236\u7b49\u529f\u80fd"),(0,r.yg)("h4",{id:"82-harbor\u5b89\u88c5"},"8.2 Harbor\u5b89\u88c5"),(0,r.yg)("p",null,"\u8fd9\u91cc\u91c7\u7528\u539f\u751f\u7684\u65b9\u5f0f\u5b89\u88c5Harbor\u3002"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u4e0b\u8f7dHarbor\u5b89\u88c5\u5305\uff1a",(0,r.yg)("a",{parentName:"p",href:"https://github.com/goharbor/harbor/releases/download/v2.3.4/harbor-offline-installer-v2.3.4.tgz"},"https://github.com/goharbor/harbor/releases/download/v2.3.4/harbor-offline-installer-v2.3.4.tgz"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u62d6\u62fd\u5230Linux\u5e76\u89e3\u538b\uff1a"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre"},"tar -zxvf harbor-offline-installer-v2.3.4.tgz -C /usr/local/\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u4fee\u6539Harbor\u914d\u7f6e\u6587\u4ef6\uff1a"),(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u9996\u5148\u590d\u5236\u4e00\u4efdharbor.yml\u914d\u7f6e"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"cp harbor.yml.tmpl harbor.yml\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u7f16\u8f91harbor.yml\u914d\u7f6e\u6587\u4ef6"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u914d\u7f6eHarbor\u6587\u4ef6"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211130215555218.png",alt:"image-20211130215555218"})))))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u542f\u52a8Harbor"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"./install.sh\n")),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u67e5\u770b\u65e5\u5fd7"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211130215941857.png",alt:"image-20211130215941857"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u767b\u5f55Harbor"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u767b\u5f55Harbor"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211130220028840.png",alt:"image-20211130220028840"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u9996\u9875\u4fe1\u606f"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u9996\u9875\u4fe1\u606f"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211130220111602.png",alt:"image-20211130220111602"}))))))),(0,r.yg)("h4",{id:"83-harbor\u4f7f\u7528\u65b9\u5f0f"},"8.3 Harbor\u4f7f\u7528\u65b9\u5f0f"),(0,r.yg)("p",null,"Harbor\u4f5c\u4e3a\u955c\u50cf\u4ed3\u5e93\uff0c\u4e3b\u8981\u7684\u4ea4\u4e92\u65b9\u5f0f\u5c31\u662f\u5c06\u955c\u50cf\u4e0a\u4f20\u5230Harbor\u4e0a\uff0c\u4ee5\u53ca\u4eceHarbor\u4e0a\u4e0b\u8f7d\u6307\u5b9a\u955c\u50cf"),(0,r.yg)("p",null,"\u5728\u4f20\u8f93\u955c\u50cf\u524d\uff0c\u53ef\u4ee5\u5148\u4f7f\u7528Harbor\u63d0\u4f9b\u7684\u6743\u9650\u7ba1\u7406\uff0c\u5c06\u9879\u76ee\u8bbe\u7f6e\u4e3a\u79c1\u6709\u9879\u76ee\uff0c\u5e76\u5bf9\u4e0d\u540c\u7528\u6237\u8bbe\u7f6e\u4e0d\u540c\u89d2\u8272\uff0c\u4ece\u800c\u66f4\u65b9\u4fbf\u7ba1\u7406\u955c\u50cf\u3002"),(0,r.yg)("h5",{id:"831-\u6dfb\u52a0\u7528\u6237\u6784\u5efa\u9879\u76ee"},"8.3.1 \u6dfb\u52a0\u7528\u6237\u6784\u5efa\u9879\u76ee"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u521b\u5efa\u7528\u6237"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u521b\u5efa\u7528\u6237"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211201213427157.png",alt:"image-20211201213427157"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u6784\u5efa\u9879\u76ee\uff08\u8bbe\u7f6e\u4e3a\u79c1\u6709\uff09"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u6784\u5efa\u9879\u76ee"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211201213751780.png",alt:"image-20211201213751780"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u7ed9\u9879\u76ee\u8ffd\u52a0\u7528\u6237"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u8ffd\u52a0\u7528\u6237\u7ba1\u7406"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211201213832458.png",alt:"image-20211201213832458"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u5207\u6362\u6d4b\u8bd5\u7528\u6237"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u5207\u6362\u6d4b\u8bd5\u7528\u6237"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211201214008303.png",alt:"image-20211201214008303"}))))))),(0,r.yg)("h5",{id:"832-\u53d1\u5e03\u955c\u50cf\u5230harbor"},"8.3.2 \u53d1\u5e03\u955c\u50cf\u5230Harbor"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u4fee\u6539\u955c\u50cf\u540d\u79f0"),(0,r.yg)("p",{parentName:"li"},"\u540d\u79f0\u8981\u6c42\uff1a",(0,r.yg)("a",{parentName:"p",href:"https://www.faithcal.com"},"harbor\u5730\u5740/\u9879\u76ee\u540d/\u955c\u50cf\u540d:\u7248\u672c")),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"\u4fee\u6539\u955c\u50cf\u540d\u79f0"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211201221040200.png",alt:"image-20211201221040200"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u4fee\u6539daemon.json\uff0c\u652f\u6301Docker\u4ed3\u5e93\uff0c\u5e76\u91cd\u542fDocker"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u4fee\u6539daemon.json\uff0c\u652f\u6301Docker\u4ed3\u5e93"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211201215931237.png",alt:"image-20211201215931237"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u8bbe\u7f6e\u767b\u5f55\u4ed3\u5e93\u4fe1\u606f"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"docker login -u \u7528\u6237\u540d -p \u5bc6\u7801 Harbor\u5730\u5740\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u63a8\u9001\u955c\u50cf\u5230Harbor"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u63a8\u9001\u955c\u50cf\u5230Harbor"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211201221225196.png",alt:"image-20211201221225196"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211201221300055.png",alt:"image-20211201221300055"}))))))),(0,r.yg)("h5",{id:"833-\u4eceharbor\u62c9\u53d6\u955c\u50cfls"},"8.3.3 \u4eceHarbor\u62c9\u53d6\u955c\u50cfls"),(0,r.yg)("p",null,"\u8ddf\u4f20\u7edf\u65b9\u5f0f\u4e00\u6837\uff0c\u4e0d\u8fc7\u9700\u8981\u5148\u914d\u7f6e",(0,r.yg)("a",{parentName:"p",href:"https://www.faithcal.com"},"/etc/docker/daemon.json"),"\u6587\u4ef6"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-json"},'{\n        "registry-mirrors": ["https://pee6w651.mirror.aliyuncs.com"],\n        "insecure-registries": ["192.168.11.11:80"]\n}\n')),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u62c9\u53d6\u955c\u50cf"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211201222450091.png",alt:"image-20211201222450091"}))))),(0,r.yg)("h5",{id:"834-jenkins\u5bb9\u5668\u4f7f\u7528\u5bbf\u4e3b\u673adocker"},"8.3.4 Jenkins\u5bb9\u5668\u4f7f\u7528\u5bbf\u4e3b\u673aDocker"),(0,r.yg)("p",null,"\u6784\u5efa\u955c\u50cf\u548c\u53d1\u5e03\u955c\u50cf\u5230harbor\u90fd\u9700\u8981\u4f7f\u7528\u5230docker\u547d\u4ee4\u3002\u800c\u5728Jenkins\u5bb9\u5668\u5185\u90e8\u5b89\u88c5Docker\u5b98\u65b9\u63a8\u8350\u76f4\u63a5\u91c7\u7528\u5bbf\u4e3b\u673a\u5e26\u7684Docker\u5373\u53ef\u3002"),(0,r.yg)("p",null,"\u8bbe\u7f6eJenkins\u5bb9\u5668\u4f7f\u7528\u5bbf\u4e3b\u673aDocker"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u8bbe\u7f6e\u5bbf\u4e3b\u673adocker.sock\u6743\u9650\uff1a"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"sudo chown root:root /var/run/docker.sock\nsudo chmod o+rw /var/run/docker.sock\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u6dfb\u52a0\u6570\u636e\u5377"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-yml"},'version: "3.1"\nservices:\n  jenkins:\n    image: jenkins/jenkins\n    container_name: jenkins\n    ports:\n      - 8080:8080\n      - 50000:50000\n    volumes:\n      - ./data/:/var/jenkins_home/\n      - /usr/bin/docker:/usr/bin/docker\n      - /var/run/docker.sock:/var/run/docker.sock\n      - /etc/docker/daemon.json:/etc/docker/daemon.json\n')))),(0,r.yg)("h5",{id:"835-\u6dfb\u52a0\u6784\u5efa\u64cd\u4f5c"},"8.3.5 \u6dfb\u52a0\u6784\u5efa\u64cd\u4f5c"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u5236\u4f5c\u81ea\u5b9a\u4e49\u955c\u50cf"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211229155834500.png",alt:"image-20211229155834500"}))))),(0,r.yg)("h5",{id:"836-\u7f16\u5199\u90e8\u7f72\u811a\u672c"},"8.3.6 \u7f16\u5199\u90e8\u7f72\u811a\u672c"),(0,r.yg)("p",null,"\u90e8\u7f72\u9879\u76ee\u9700\u8981\u901a\u8fc7Publish Over SSH\u63d2\u4ef6\uff0c\u8ba9\u76ee\u6807\u670d\u52a1\u5668\u6267\u884c\u547d\u4ee4\u3002\u4e3a\u4e86\u65b9\u4fbf\u4e00\u6b21\u6027\u5b9e\u73b0\u62c9\u53d6\u955c\u50cf\u548c\u542f\u52a8\u7684\u547d\u4ee4\uff0c\u63a8\u8350\u91c7\u7528\u811a\u672c\u6587\u4ef6\u7684\u65b9\u5f0f\u3002"),(0,r.yg)("p",null,"\u6dfb\u52a0\u811a\u672c\u6587\u4ef6\u5230\u76ee\u6807\u670d\u52a1\u5668\uff0c\u518d\u901a\u8fc7Publish Over SSH\u63d2\u4ef6\u8ba9\u76ee\u6807\u670d\u52a1\u5668\u6267\u884c\u811a\u672c\u5373\u53ef\u3002"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u7f16\u5199\u811a\u672c\u6587\u4ef6\uff0c\u6dfb\u52a0\u5230\u76ee\u6807\u670d\u52a1\u5668"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},'harbor_url=$1\nharbor_project_name=$2\nproject_name=$3\ntag=$4\nport=$5\n\nimageName=$harbor_url/$harbor_project_name/$project_name:$tag\n\ncontainerId=`docker ps -a | grep ${project_name} | awk \'{print $1}\'`\nif [ "$containerId" != "" ] ; then\n    docker stop $containerId\n    docker rm $containerId\n    echo "Delete Container Success"\nfi\n\nimageId=`docker images | grep ${project_name} | awk \'{print $3}\'`\n\nif [ "$imageId" != "" ] ; then\n    docker rmi -f $imageId\n    echo "Delete Image Success"\nfi\n\ndocker login -u DevOps -p P@ssw0rd $harbor_url\n\ndocker pull $imageName\n\ndocker run -d -p $port:$port --name $project_name $imageName\n\necho "Start Container Success"\necho $project_name\n')),(0,r.yg)("p",{parentName:"li"},"\u5e76\u8bbe\u7f6e\u6743\u9650\u4e3a\u53ef\u6267\u884c"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre"},"chmod a+x deploy.sh\n")),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u5982\u56fe"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211203192047357.png",alt:"image-20211203192047357"}))))))),(0,r.yg)("h5",{id:"837-\u914d\u7f6e\u6784\u5efa\u540e\u64cd\u4f5c"},"8.3.7 \u914d\u7f6e\u6784\u5efa\u540e\u64cd\u4f5c"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u6267\u884c\u811a\u672c\u6587\u4ef6"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211229155949038.png",alt:"image-20211229155949038"}))))),(0,r.yg)("h3",{id:"\u4e5djenkins\u6d41\u6c34\u7ebf"},"\u4e5d\u3001Jenkins\u6d41\u6c34\u7ebf"),(0,r.yg)("h4",{id:"91-jenkins\u6d41\u6c34\u7ebf\u4efb\u52a1\u4ecb\u7ecd"},"9.1 Jenkins\u6d41\u6c34\u7ebf\u4efb\u52a1\u4ecb\u7ecd"),(0,r.yg)("p",null,"\u4e4b\u524d\u91c7\u7528Jenkins\u7684\u81ea\u7531\u98ce\u683c\u6784\u5efa\u7684\u9879\u76ee\uff0c\u6bcf\u4e2a\u6b65\u9aa4\u6d41\u7a0b\u90fd\u8981\u901a\u8fc7\u4e0d\u540c\u7684\u65b9\u5f0f\u8bbe\u7f6e\uff0c\u5e76\u4e14\u6784\u5efa\u8fc7\u7a0b\u4e2d\u6574\u4f53\u6d41\u7a0b\u662f\u4e0d\u53ef\u89c1\u7684\uff0c\u65e0\u6cd5\u786e\u8ba4\u6bcf\u4e2a\u6d41\u7a0b\u82b1\u8d39\u7684\u65f6\u95f4\uff0c\u5e76\u4e14\u95ee\u9898\u4e0d\u65b9\u4fbf\u5b9a\u4f4d\u95ee\u9898\u3002"),(0,r.yg)("p",null,"Jenkins\u7684Pipeline\u53ef\u4ee5\u8ba9\u9879\u76ee\u7684\u53d1\u5e03\u6574\u4f53\u6d41\u7a0b\u53ef\u89c6\u5316\uff0c\u660e\u786e\u6267\u884c\u7684\u9636\u6bb5\uff0c\u53ef\u4ee5\u5feb\u901f\u7684\u5b9a\u4f4d\u95ee\u9898\u3002\u5e76\u4e14\u6574\u4e2a\u9879\u76ee\u7684\u751f\u547d\u5468\u671f\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2aJenkinsfile\u6587\u4ef6\u7ba1\u7406\uff0c\u800c\u4e14Jenkinsfile\u6587\u4ef6\u662f\u53ef\u4ee5\u653e\u5728\u9879\u76ee\u4e2d\u7ef4\u62a4\u3002"),(0,r.yg)("p",null,"\u6240\u4ee5Pipeline\u76f8\u5bf9\u81ea\u7531\u98ce\u683c\u6216\u8005\u5176\u4ed6\u7684\u9879\u76ee\u98ce\u683c\u66f4\u5bb9\u6613\u64cd\u4f5c\u3002"),(0,r.yg)("h4",{id:"92-jenkins\u6d41\u6c34\u7ebf\u4efb\u52a1"},"9.2 Jenkins\u6d41\u6c34\u7ebf\u4efb\u52a1"),(0,r.yg)("h5",{id:"921-\u6784\u5efajenkins\u6d41\u6c34\u7ebf\u4efb\u52a1"},"9.2.1 \u6784\u5efaJenkins\u6d41\u6c34\u7ebf\u4efb\u52a1"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u6784\u5efa\u4efb\u52a1"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"\u6784\u5efaJenkins\u6d41\u6c34\u7ebf\u4efb\u52a1"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211202144429302.png",alt:"image-20211202144429302"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u751f\u6210Groovy\u811a\u672c"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"Hello World\u811a\u672c\u751f\u6210"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211202144531749.png",alt:"image-20211202144531749"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u6784\u5efa\u540e\u67e5\u770b\u89c6\u56fe"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u6784\u5efa\u540e\u67e5\u770b\u89c6\u56fe"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211202144616117.png",alt:"image-20211202144616117"}))))))),(0,r.yg)("h5",{id:"922-groovy\u811a\u672c"},"9.2.2 Groovy\u811a\u672c"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"Groovy\u811a\u672c\u57fa\u7840\u8bed\u6cd5"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"// \u6240\u6709\u811a\u672c\u547d\u4ee4\u5305\u542b\u5728pipeline{}\u4e2d\npipeline {  \n    // \u6307\u5b9a\u4efb\u52a1\u5728\u54ea\u4e2a\u8282\u70b9\u6267\u884c\uff08Jenkins\u652f\u6301\u5206\u5e03\u5f0f\uff09\n    agent any\n    \n    // \u914d\u7f6e\u5168\u5c40\u73af\u5883\uff0c\u6307\u5b9a\u53d8\u91cf\u540d=\u53d8\u91cf\u503c\u4fe1\u606f\n    environment{\n        host = '192.168.11.11'\n    }\n\n    // \u5b58\u653e\u6240\u6709\u4efb\u52a1\u7684\u5408\u96c6\n    stages {\n        // \u5355\u4e2a\u4efb\u52a1\n        stage('\u4efb\u52a11') {\n            // \u5b9e\u73b0\u4efb\u52a1\u7684\u5177\u4f53\u6d41\u7a0b\n            steps {\n                echo 'do something'\n            }\n        }\n        // \u5355\u4e2a\u4efb\u52a1\n        stage('\u4efb\u52a12') {\n            // \u5b9e\u73b0\u4efb\u52a1\u7684\u5177\u4f53\u6d41\u7a0b\n            steps {\n                echo 'do something'\n            }\n        }\n        // \u2026\u2026\n    }\n}\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u7f16\u5199\u4f8b\u5b50\u6d4b\u8bd5"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"pipeline {\n    agent any\n\n    // \u5b58\u653e\u6240\u6709\u4efb\u52a1\u7684\u5408\u96c6\n    stages {\n        stage('\u62c9\u53d6Git\u4ee3\u7801') {\n            steps {\n                echo '\u62c9\u53d6Git\u4ee3\u7801'\n            }\n        }\n\n        stage('\u68c0\u6d4b\u4ee3\u7801\u8d28\u91cf') {\n            steps {\n                echo '\u68c0\u6d4b\u4ee3\u7801\u8d28\u91cf'\n            }\n        }\n\n        stage('\u6784\u5efa\u4ee3\u7801') {\n            steps {\n                echo '\u6784\u5efa\u4ee3\u7801'\n            }\n        }\n\n        stage('\u5236\u4f5c\u81ea\u5b9a\u4e49\u955c\u50cf\u5e76\u53d1\u5e03Harbor') {\n            steps {\n                echo '\u5236\u4f5c\u81ea\u5b9a\u4e49\u955c\u50cf\u5e76\u53d1\u5e03Harbor'\n            }\n        }\n\n        stage('\u57fa\u4e8eHarbor\u90e8\u7f72\u5de5\u7a0b') {\n            steps {\n                echo '\u57fa\u4e8eHarbor\u90e8\u7f72\u5de5\u7a0b'\n            }\n        }\n    }\n}\n")),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u914d\u7f6eGrovvy\u811a\u672c"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211202145155428.png",alt:"image-20211202145155428"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u67e5\u770b\u6548\u679c"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u67e5\u770b\u6548\u679c"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211202145240166.png",alt:"image-20211202145240166"}))))))),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://www.faithcal.com"},"Ps\uff1a\u6d89\u53ca\u5230\u7279\u5b9a\u811a\u672c\uff0cJenkins\u7ed9\u4e88\u4e86\u5145\u8db3\u7684\u63d0\u793a\uff0c\u53ef\u4ee5\u81ea\u52a8\u751f\u6210\u547d\u4ee4")),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u751f\u6210\u547d\u4ee4\u4f4d\u7f6e"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211202145349043.png",alt:"image-20211202145349043"}))))),(0,r.yg)("h5",{id:"923-jenkinsfile\u5b9e\u73b0"},"9.2.3 Jenkinsfile\u5b9e\u73b0"),(0,r.yg)("p",null,"Jenkinsfile\u65b9\u5f0f\u9700\u8981\u5c06\u811a\u672c\u5185\u5bb9\u7f16\u5199\u5230\u9879\u76ee\u4e2d\u7684Jenkinsfile\u6587\u4ef6\u4e2d\uff0c\u6bcf\u6b21\u6784\u5efa\u4f1a\u81ea\u52a8\u62c9\u53d6\u9879\u76ee\u5e76\u4e14\u83b7\u53d6\u9879\u76ee\u4e2dJenkinsfile\u6587\u4ef6\u5bf9\u9879\u76ee\u8fdb\u884c\u6784\u5efa"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u914d\u7f6epipeline"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u914d\u7f6epipeline"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211202151127254.png",alt:"image-20211202151127254"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u51c6\u5907Jenkinsfile"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u51c6\u5907Jenkinsfile\u6587\u4ef6"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211202151155145.png",alt:"image-20211202151155145"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u6d4b\u8bd5\u6548\u679c"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u6d4b\u8bd5\u6548\u679c"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211202151225161.png",alt:"image-20211202151225161"}))))))),(0,r.yg)("h4",{id:"93-jenkins\u6d41\u6c34\u7ebf\u4efb\u52a1\u5b9e\u73b0"},"9.3 Jenkins\u6d41\u6c34\u7ebf\u4efb\u52a1\u5b9e\u73b0"),(0,r.yg)("h5",{id:"931-\u53c2\u6570\u5316\u6784\u5efa"},"9.3.1 \u53c2\u6570\u5316\u6784\u5efa"),(0,r.yg)("p",null,"\u6dfb\u52a0\u53c2\u6570\u5316\u6784\u5efa\uff0c\u65b9\u4fbf\u9009\u62e9\u4e0d\u7684\u9879\u76ee\u7248\u672c"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"Git\u53c2\u6570\u5316\u6784\u5efa"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211202191944277.png",alt:"image-20211202191944277"}))))),(0,r.yg)("h5",{id:"932-\u62c9\u53d6git\u4ee3\u7801"},"9.3.2 \u62c9\u53d6Git\u4ee3\u7801"),(0,r.yg)("p",null,"\u901a\u8fc7\u6d41\u6c34\u7ebf\u8bed\u6cd5\u751f\u6210Checkout\u4ee3\u7801\u7684\u811a\u672c"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u8bed\u6cd5\u751f\u6210"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211202192047619.png",alt:"image-20211202192047619"}))))),(0,r.yg)("p",null,(0,r.yg)("img",{parentName:"p",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211202192129895.png",alt:"image-20211202192129895"}),"\u5c06*/master\u66f4\u6539\u4e3a\u6807\u7b7e",(0,r.yg)("a",{parentName:"p",href:"https://www.faithcal.com"},"${tag}")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"pipeline {\n    agent any\n    stages {\n\n        stage('\u62c9\u53d6Git\u4ee3\u7801') {\n            steps {\n                checkout([$class: 'GitSCM', branches: [[name: '${tag}']], extensions: [], userRemoteConfigs: [[url: 'http://49.233.115.171:8929/root/test.git']]])\n            }\n        }\n    }\n}\n")),(0,r.yg)("h5",{id:"933-\u6784\u5efa\u4ee3\u7801"},"9.3.3 \u6784\u5efa\u4ee3\u7801"),(0,r.yg)("p",null,"\u901a\u8fc7\u811a\u672c\u6267\u884cmvn\u7684\u6784\u5efa\u547d\u4ee4"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"pipeline {\n    agent any\n\n    stages {\n\n        stage('\u62c9\u53d6Git\u4ee3\u7801') {\n            steps {\n                checkout([$class: 'GitSCM', branches: [[name: '${tag}']], extensions: [], userRemoteConfigs: [[url: 'http://49.233.115.171:8929/root/test.git']]])\n            }\n        }\n\n        stage('\u6784\u5efa\u4ee3\u7801') {\n            steps {\n                sh '/var/jenkins_home/maven/bin/mvn clean package -DskipTests'\n            }\n        }\n}\n\n")),(0,r.yg)("h5",{id:"934-\u4ee3\u7801\u8d28\u91cf\u68c0\u6d4b"},"9.3.4 \u4ee3\u7801\u8d28\u91cf\u68c0\u6d4b"),(0,r.yg)("p",null,"\u901a\u8fc7\u811a\u672c\u6267\u884csonar-scanner\u547d\u4ee4\u5373\u53ef"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"pipeline {\n    agent any\n\n    stages {\n\n        stage('\u62c9\u53d6Git\u4ee3\u7801') {\n            steps {\n                checkout([$class: 'GitSCM', branches: [[name: '${tag}']], extensions: [], userRemoteConfigs: [[url: 'http://49.233.115.171:8929/root/test.git']]])\n            }\n        }\n\n        stage('\u6784\u5efa\u4ee3\u7801') {\n            steps {\n                sh '/var/jenkins_home/maven/bin/mvn clean package -DskipTests'\n            }\n        }\n\n        stage('\u68c0\u6d4b\u4ee3\u7801\u8d28\u91cf') {\n            steps {\n                sh '/var/jenkins_home/sonar-scanner/bin/sonar-scanner -Dsonar.sources=./ -Dsonar.projectname=${JOB_NAME} -Dsonar.projectKey=${JOB_NAME} -Dsonar.java.binaries=target/ -Dsonar.login=31388be45653876c1f51ec02f0d478e2d9d0e1fa' \n            }\n        }\n    }\n}\n\n")),(0,r.yg)("h5",{id:"935-\u5236\u4f5c\u81ea\u5b9a\u4e49\u955c\u50cf\u5e76\u53d1\u5e03"},"9.3.5 \u5236\u4f5c\u81ea\u5b9a\u4e49\u955c\u50cf\u5e76\u53d1\u5e03"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u751f\u6210\u81ea\u5b9a\u4e49\u955c\u50cf\u811a\u672c"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"pipeline {\n    agent any\n    environment{\n        harborHost = '192.168.11.11:80'\n        harborRepo = 'repository'\n        harborUser = 'DevOps'\n        harborPasswd = 'P@ssw0rd'\n    }\n\n    // \u5b58\u653e\u6240\u6709\u4efb\u52a1\u7684\u5408\u96c6\n    stages {\n\n        stage('\u62c9\u53d6Git\u4ee3\u7801') {\n            steps {\n                checkout([$class: 'GitSCM', branches: [[name: '${tag}']], extensions: [], userRemoteConfigs: [[url: 'http://49.233.115.171:8929/root/test.git']]])\n            }\n        }\n\n        stage('\u6784\u5efa\u4ee3\u7801') {\n            steps {\n                sh '/var/jenkins_home/maven/bin/mvn clean package -DskipTests'\n            }\n        }\n\n        stage('\u68c0\u6d4b\u4ee3\u7801\u8d28\u91cf') {\n            steps {\n                sh '/var/jenkins_home/sonar-scanner/bin/sonar-scanner -Dsonar.sources=./ -Dsonar.projectname=${JOB_NAME} -Dsonar.projectKey=${JOB_NAME} -Dsonar.java.binaries=target/ -Dsonar.login=31388be45653876c1f51ec02f0d478e2d9d0e1fa' \n            }\n        }\n\n        stage('\u5236\u4f5c\u81ea\u5b9a\u4e49\u955c\u50cf\u5e76\u53d1\u5e03Harbor') {\n            steps {\n                sh '''cp ./target/*.jar ./docker/\n                cd ./docker\n                docker build -t ${JOB_NAME}:${tag} ./'''\n\n                sh '''docker login -u ${harborUser} -p ${harborPasswd} ${harborHost}\n                docker tag ${JOB_NAME}:${tag} ${harborHost}/${harborRepo}/${JOB_NAME}:${tag}\n                docker push ${harborHost}/${harborRepo}/${JOB_NAME}:${tag}'''\n            }\n        }\n    }\n}\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u751f\u6210Publish Over SSH\u811a\u672c"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"pipeline {\n    agent any\n    environment{\n        harborHost = '192.168.11.11:80'\n        harborRepo = 'repository'\n        harborUser = 'DevOps'\n        harborPasswd = 'P@ssw0rd'\n    }\n\n    // \u5b58\u653e\u6240\u6709\u4efb\u52a1\u7684\u5408\u96c6\n    stages {\n\n        stage('\u62c9\u53d6Git\u4ee3\u7801') {\n            steps {\n                checkout([$class: 'GitSCM', branches: [[name: '${tag}']], extensions: [], userRemoteConfigs: [[url: 'http://49.233.115.171:8929/root/test.git']]])\n            }\n        }\n\n        stage('\u6784\u5efa\u4ee3\u7801') {\n            steps {\n                sh '/var/jenkins_home/maven/bin/mvn clean package -DskipTests'\n            }\n        }docker\n\n        stage('\u68c0\u6d4b\u4ee3\u7801\u8d28\u91cf') {\n            steps {\n                sh '/var/jenkins_home/sonar-scanner/bin/sonar-scanner -Dsonar.sources=./ -Dsonar.projectname=${JOB_NAME} -Dsonar.projectKey=${JOB_NAME} -Dsonar.java.binaries=target/ -Dsonar.login=7d66af4b39cfe4f52ac0a915d4c9d5c513207098' \n            }\n        }\n\n        stage('\u5236\u4f5c\u81ea\u5b9a\u4e49\u955c\u50cf\u5e76\u53d1\u5e03Harbor') {\n            steps {\n                sh '''cp ./target/*.jar ./docker/\n                cd ./docker\n                docker build -t ${JOB_NAME}:${tag} ./'''\n\n                sh '''docker login -u ${harborUser} -p ${harborPasswd} ${harborHost}\n                docker tag ${JOB_NAME}:${tag} ${harborHost}/${harborRepo}/${JOB_NAME}:${tag}\n                docker push ${harborHost}/${harborRepo}/${JOB_NAME}:${tag}'''\n            }\n        }\n        \n        stage('\u76ee\u6807\u670d\u52a1\u5668\u62c9\u53d6\u955c\u50cf\u5e76\u8fd0\u884c') {\n            steps {\n                sshPublisher(publishers: [sshPublisherDesc(configName: 'testEnvironment', transfers: [sshTransfer(cleanRemote: false, excludes: '', execCommand: \"/usr/bin/deploy.sh $harborHost $harborRepo $JOB_NAME $tag $port \", execTimeout: 120000, flatten: false, makeEmptyDirs: false, noDefaultExcludes: false, patternSeparator: '[, ]+', remoteDirectory: '', remoteDirectorySDF: false, removePrefix: '', sourceFiles: '')], usePromotionTimestamp: false, useWorkspaceInPromotion: false, verbose: false)])\n            }\n        }\n    }\n}\n")))),(0,r.yg)("p",null,"[Ps\uff1a\u7531\u4e8e\u91c7\u7528\u53d8\u91cf\uff0c\u8bb0\u5f97\u4f7f\u7528\u53cc\u5f15\u53f7]"),(0,r.yg)("h4",{id:"94-jenkins\u6d41\u6c34\u7ebf\u6574\u5408\u9489\u9489"},"9.4 Jenkins\u6d41\u6c34\u7ebf\u6574\u5408\u9489\u9489"),(0,r.yg)("p",null,"\u5728\u7a0b\u5e8f\u90e8\u7f72\u6210\u529f\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u9489\u9489\u7684\u673a\u5668\u4eba\u53ca\u65f6\u5411\u7fa4\u4f17\u53d1\u9001\u90e8\u7f72\u7684\u6700\u7ec8\u7ed3\u679c\u901a\u77e5"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u5b89\u88c5\u63d2\u4ef6"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u5b89\u88c5\u63d2\u4ef6"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211209151549412.png",alt:"image-20211209151549412"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u9489\u9489\u5185\u90e8\u521b\u5efa\u7fa4\u7ec4\u5e76\u6784\u5efa\u673a\u5668\u4eba"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u9489\u9489\u5185\u90e8\u521b\u5efa\u7fa4\u7ec4\u5e76\u6784\u5efa\u673a\u5668\u4eba"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211209152217433.png",alt:"image-20211209152217433"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211209152252050.png",alt:"image-20211209152252050"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211209152403312.png",alt:"image-20211209152403312"}))))),(0,r.yg)("p",{parentName:"li"},"\u6700\u7ec8\u6216\u83b7\u53d6\u5230Webhook\u4fe1\u606f"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre"},"https://oapi.dingtalk.com/robot/send?access_token=kej4ehkj34gjhg34jh5bh5jb34hj53b4\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u7cfb\u7edf\u914d\u7f6e\u6dfb\u52a0\u9489\u9489\u901a\u77e5"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u914d\u7f6e\u9489\u9489\u901a\u77e5"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211209162923440.png",alt:"image-20211209162923440"}))))))),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u4efb\u52a1\u4e2d\u8ffd\u52a0\u6d41\u6c34\u7ebf\u914d\u7f6e"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"pipeline {\n    agent any\n\n    environment {\n        sonarLogin = '2bab7bf7d5af25e2c2ca2f178af2c3c55c64d5d8'\n        harborUser = 'admin'\n        harborPassword = 'Harbor12345'\n        harborHost = '192.168.11.12:8888'\n        harborRepo = 'repository'\n    }\n\n    stages {\n        stage('\u62c9\u53d6Git\u4ee3\u7801'){\n            steps {\n                checkout([$class: 'GitSCM', branches: [[name: '$tag']], extensions: [], userRemoteConfigs: [[url: 'http://49.233.115.171:8929/root/lsx.git']]])\n            }\n        }\n        stage('Maven\u6784\u5efa\u4ee3\u7801'){\n            steps {\n                sh '/var/jenkins_home/maven/bin/mvn clean package -DskipTests'\n            }\n        }\n        stage('SonarQube\u68c0\u6d4b\u4ee3\u7801'){\n            steps {\n                sh '/var/jenkins_home/sonar-scanner/bin/sonar-scanner -Dsonar.sources=./ -Dsonar.projectname=${JOB_NAME} -Dsonar.projectKey=${JOB_NAME} -Dsonar.java.binaries=target/ -Dsonar.login=${sonarLogin}'\n            }\n        }\n        stage('\u5236\u4f5c\u81ea\u5b9a\u4e49\u955c\u50cf'){\n            steps {\n                sh '''cd docker\n                mv ../target/*.jar ./\n                docker build -t ${JOB_NAME}:$tag .\n                '''\n            }\n        }\n\n        stage('\u63a8\u9001\u81ea\u5b9a\u4e49\u955c\u50cf'){\n            steps {\n                sh '''docker login -u ${harborUser} -p ${harborPassword} ${harborHost}\n                docker tag ${JOB_NAME}:$tag ${harborHost}/${harborRepo}/${JOB_NAME}:$tag\n                docker push ${harborHost}/${harborRepo}/${JOB_NAME}:$tag'''\n            }\n        }\n\n        stage('\u901a\u77e5\u76ee\u6807\u670d\u52a1\u5668'){\n            steps {\n                sshPublisher(publishers: [sshPublisherDesc(configName: 'centos-docker', transfers: [sshTransfer(cleanRemote: false, excludes: '', execCommand: \"/usr/bin/deploy.sh $harborHost $harborRepo $JOB_NAME $tag $port\", execTimeout: 120000, flatten: false, makeEmptyDirs: false, noDefaultExcludes: false, patternSeparator: '[, ]+', remoteDirectory: '', remoteDirectorySDF: false, removePrefix: '', sourceFiles: '')], usePromotionTimestamp: false, useWorkspaceInPromotion: false, verbose: false)])\n            }  \n        }\n    }\n    post {\n        success {\n            dingtalk (\n                robot: 'Jenkins-DingDing',\n                type:'MARKDOWN',\n                title: \"success: ${JOB_NAME}\",\n                text: [\"- \u6210\u529f\u6784\u5efa:${JOB_NAME}\u9879\u76ee!\\n- \u7248\u672c:${tag}\\n- \u6301\u7eed\u65f6\u95f4:${currentBuild.durationString}\\n- \u4efb\u52a1:#${JOB_NAME}\"]\n            )\n        }\n        failure {\n            dingtalk (\n                robot: 'Jenkins-DingDing',\n                type:'MARKDOWN',\n                title: \"fail: ${JOB_NAME}\",\n                text: [\"- \u5931\u8d25\u6784\u5efa:${JOB_NAME}\u9879\u76ee!\\n- \u7248\u672c:${tag}\\n- \u6301\u7eed\u65f6\u95f4:${currentBuild.durationString}\\n- \u4efb\u52a1:#${JOB_NAME}\"]\n            )\n        }\n    }\n}\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u67e5\u770b\u6548\u679c"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u9489\u9489\u901a\u77e5\u6548\u679c"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211209163021396.png",alt:"image-20211209163021396"}))))))),(0,r.yg)("h3",{id:"\u5341kubernetes\u7f16\u6392\u5de5\u5177"},"\u5341\u3001Kubernetes\u7f16\u6392\u5de5\u5177"),(0,r.yg)("h4",{id:"101-kubernetes\u4ecb\u7ecd"},"10.1 Kubernetes\u4ecb\u7ecd"),(0,r.yg)("p",null,"Kubernetes\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\uff0c\u7528\u4e8e\u7ba1\u7406\u4e91\u5e73\u53f0\u4e2d\u591a\u4e2a\u4e3b\u673a\u4e0a\u7684\u5bb9\u5668\u5316\u7684\u5e94\u7528\uff0cKubernetes\u7684\u76ee\u6807\u662f\u8ba9\u90e8\u7f72\u5bb9\u5668\u5316\u7684\u5e94\u7528\u7b80\u5355\u5e76\u4e14\u9ad8\u6548\uff08powerful\uff09\uff0cKubernetes\u63d0\u4f9b\u4e86\u5e94\u7528\u90e8\u7f72\uff0c\u89c4\u5212\uff0c\u66f4\u65b0\uff0c\u7ef4\u62a4\u7684\u4e00\u79cd\u673a\u5236\u3002"),(0,r.yg)("p",null,"Kubernetes\u4e00\u4e2a\u6838\u5fc3\u7684\u7279\u70b9\u5c31\u662f\u80fd\u591f\u81ea\u4e3b\u7684\u7ba1\u7406\u5bb9\u5668\u6765\u4fdd\u8bc1\u4e91\u5e73\u53f0\u4e2d\u7684\u5bb9\u5668\u6309\u7167\u7528\u6237\u7684\u671f\u671b\u72b6\u6001\u8fd0\u884c\u7740\uff0c\u7ba1\u7406\u5458\u53ef\u4ee5\u52a0\u8f7d\u4e00\u4e2a\u5fae\u578b\u670d\u52a1\uff0c\u8ba9\u89c4\u5212\u5668\u6765\u627e\u5230\u5408\u9002\u7684\u4f4d\u7f6e\uff0c\u540c\u65f6\uff0cKubernetes\u4e5f\u7cfb\u7edf\u63d0\u5347\u5de5\u5177\u4ee5\u53ca\u4eba\u6027\u5316\u65b9\u9762\uff0c\u8ba9\u7528\u6237\u80fd\u591f\u65b9\u4fbf\u7684\u90e8\u7f72\u81ea\u5df1\u7684\u5e94\u7528\u3002"),(0,r.yg)("p",null,"Kubernetes\u4e3b\u8981\u80fd\u5e2e\u52a9\u6211\u4eec\u5b8c\u6210\uff1a"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u670d\u52a1\u53d1\u73b0\u548c\u8d1f\u8f7d\u5747\u8861"),(0,r.yg)("p",{parentName:"li"},"Kubernetes \u53ef\u4ee5\u4f7f\u7528 DNS \u540d\u79f0\u6216\u81ea\u5df1\u7684 IP \u5730\u5740\u516c\u5f00\u5bb9\u5668\uff0c\u5982\u679c\u8fdb\u5165\u5bb9\u5668\u7684\u6d41\u91cf\u5f88\u5927\uff0c Kubernetes \u53ef\u4ee5\u8d1f\u8f7d\u5747\u8861\u5e76\u5206\u914d\u7f51\u7edc\u6d41\u91cf\uff0c\u4ece\u800c\u4f7f\u90e8\u7f72\u7a33\u5b9a\u3002")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u5b58\u50a8\u7f16\u6392"),(0,r.yg)("p",{parentName:"li"},"Kubernetes \u5141\u8bb8\u4f60\u81ea\u52a8\u6302\u8f7d\u4f60\u9009\u62e9\u7684\u5b58\u50a8\u7cfb\u7edf\uff0c\u6bd4\u5982\u672c\u5730\u5b58\u50a8\uff0c\u7c7b\u4f3cDocker\u7684\u6570\u636e\u5377\u3002")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u81ea\u52a8\u90e8\u7f72\u548c\u56de\u6eda"),(0,r.yg)("p",{parentName:"li"},"\u4f60\u53ef\u4ee5\u4f7f\u7528 Kubernetes \u63cf\u8ff0\u5df2\u90e8\u7f72\u5bb9\u5668\u7684\u6240\u9700\u72b6\u6001\uff0c\u5b83\u53ef\u4ee5\u4ee5\u53d7\u63a7\u7684\u901f\u7387\u5c06\u5b9e\u9645\u72b6\u6001 \u66f4\u6539\u4e3a\u671f\u671b\u72b6\u6001\u3002Kubernetes \u4f1a\u81ea\u52a8\u5e2e\u4f60\u6839\u636e\u60c5\u51b5\u90e8\u7f72\u521b\u5efa\u65b0\u5bb9\u5668\uff0c\u5e76\u5220\u9664\u73b0\u6709\u5bb9\u5668\u7ed9\u65b0\u5bb9\u5668\u63d0\u4f9b\u8d44\u6e90\u3002")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u81ea\u52a8\u5b8c\u6210\u88c5\u7bb1\u8ba1\u7b97"),(0,r.yg)("p",{parentName:"li"},"Kubernetes \u5141\u8bb8\u4f60\u8bbe\u7f6e\u6bcf\u4e2a\u5bb9\u5668\u7684\u8d44\u6e90\uff0c\u6bd4\u5982CPU\u548c\u5185\u5b58\u3002")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u81ea\u6211\u4fee\u590d"),(0,r.yg)("p",{parentName:"li"},"Kubernetes \u91cd\u65b0\u542f\u52a8\u5931\u8d25\u7684\u5bb9\u5668\u3001\u66ff\u6362\u5bb9\u5668\u3001\u6740\u6b7b\u4e0d\u54cd\u5e94\u7528\u6237\u5b9a\u4e49\u7684\u5bb9\u5668\uff0c\u5e76\u8fd0\u884c\u72b6\u51b5\u68c0\u67e5\u7684\u5bb9\u5668\u3002")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u79d8\u94a5\u4e0e\u914d\u7f6e\u7ba1\u7406"),(0,r.yg)("p",{parentName:"li"},"Kubernetes \u5141\u8bb8\u4f60\u5b58\u50a8\u548c\u7ba1\u7406\u654f\u611f\u4fe1\u606f\uff0c\u4f8b\u5982\u5bc6\u7801\u3001OAuth \u4ee4\u724c\u548c ssh \u5bc6\u94a5\u3002\u4f60\u53ef\u4ee5\u5728\u4e0d\u91cd\u5efa\u5bb9\u5668\u955c\u50cf\u7684\u60c5\u51b5\u4e0b\u90e8\u7f72\u548c\u66f4\u65b0\u5bc6\u94a5\u548c\u5e94\u7528\u7a0b\u5e8f\u914d\u7f6e\uff0c\u4e5f\u65e0\u9700\u5728\u5806\u6808\u914d\u7f6e\u4e2d\u66b4\u9732\u5bc6\u94a5\u3002"))),(0,r.yg)("h4",{id:"102-kubernetes\u67b6\u6784"},"10.2 Kubernetes\u67b6\u6784"),(0,r.yg)("p",null,"Kubernetes \u642d\u5efa\u9700\u8981\u81f3\u5c11\u4e24\u4e2a\u8282\u70b9\uff0c\u4e00\u4e2aMaster\u8d1f\u8d23\u7ba1\u7406\uff0c\u4e00\u4e2aSlave\u642d\u5efa\u5728\u5de5\u4f5c\u670d\u52a1\u5668\u4e0a\u8d1f\u8d23\u5206\u914d\u3002"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"kubernetes\u67b6\u6784"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211210114507638.png",alt:"image-20211210114507638"}))))),(0,r.yg)("p",null,"\u4ece\u56fe\u4e2d\u53ef\u4ee5\u770b\u5230\u5404\u4e2a\u7ec4\u4ef6\u7684\u57fa\u672c\u529f\u80fd\uff1a"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"API Server\uff1a\u4f5c\u4e3aK8s\u901a\u8baf\u7684\u6838\u5fc3\u7ec4\u4ef6\uff0cK8s\u5185\u90e8\u4ea4\u4e92\u4ee5\u53ca\u63a5\u6536\u53d1\u9001\u6307\u4ee4\u7684\u7ec4\u4ef6\u3002"),(0,r.yg)("li",{parentName:"ul"},"controller-manager\uff1a\u4f5c\u4e3aK8s\u7684\u6838\u5fc3\u7ec4\u4ef6\uff0c\u4e3b\u8981\u505a\u8d44\u6e90\u8c03\u5ea6\uff0c\u6839\u636e\u96c6\u7fa4\u60c5\u51b5\u5206\u914d\u8d44\u6e90"),(0,r.yg)("li",{parentName:"ul"},"etcd\uff1a\u4e00\u4e2akey-value\u7684\u6570\u636e\u5e93\uff0c\u5b58\u50a8\u5b58\u50a8\u96c6\u7fa4\u7684\u72b6\u6001\u4fe1\u606f"),(0,r.yg)("li",{parentName:"ul"},"scheduler\uff1a\u8d1f\u8d23\u8c03\u5ea6\u6bcf\u4e2a\u5de5\u4f5c\u8282\u70b9"),(0,r.yg)("li",{parentName:"ul"},"cloud-controller-manager\uff1a\u8d1f\u8d23\u8c03\u5ea6\u5176\u4ed6\u4e91\u670d\u52a1\u4ea7\u54c1"),(0,r.yg)("li",{parentName:"ul"},"kubelet\uff1a\u7ba1\u7406Pods\u4e0a\u9762\u7684\u5bb9\u5668\u3002"),(0,r.yg)("li",{parentName:"ul"},"kube-proxy\uff1a\u8d1f\u8d23\u5904\u7406\u5176\u4ed6Slave\u6216\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u3002"),(0,r.yg)("li",{parentName:"ul"},"Pod\uff1a\u53ef\u4ee5\u7406\u89e3\u4e3a\u5c31\u662f\u8fd0\u884c\u7684\u5bb9\u5668")),(0,r.yg)("h4",{id:"103-kubernetes\u5b89\u88c5"},"10.3 Kubernetes\u5b89\u88c5"),(0,r.yg)("p",null,"\u8fd9\u91cc\u4f1a\u91c7\u7528",(0,r.yg)("a",{parentName:"p",href:"https://kuboard.cn/%E6%8F%90%E4%BE%9B%E7%9A%84%E6%96%B9%E5%BC%8F%E5%AE%89%E8%A3%85K8s%EF%BC%8C%E5%AE%89%E8%A3%85%E5%8D%95Master%E8%8A%82%E7%82%B9"},"https://kuboard.cn/\u63d0\u4f9b\u7684\u65b9\u5f0f\u5b89\u88c5K8s\uff0c\u5b89\u88c5\u5355Master\u8282\u70b9")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"\u8981\u6c42\u4f7f\u7528Centos7.8\u7248\u672c\uff1a",(0,r.yg)("a",{parentName:"li",href:"https://vault.centos.org/7.8.2003/isos/x86_64/CentOS-7-x86_64-Minimal-2003.iso"},"https://vault.centos.org/7.8.2003/isos/x86_64/CentOS-7-x86_64-Minimal-2003.iso")),(0,r.yg)("li",{parentName:"ul"},"\u81f3\u5c112\u53f0 ",(0,r.yg)("strong",{parentName:"li"},"2\u68384G")," \u7684\u670d\u52a1\u5668")),(0,r.yg)("p",null,"\u5b89\u88c5\u6d41\u7a0b"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u5b89\u88c5\u6d41\u7a0b"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211210190653687.png",alt:"image-20211210190653687"}))))),(0,r.yg)("p",null,"\u51c6\u5907\u597d\u670d\u52a1\u5668\u540e\u5f00\u59cb\u5b89\u88c5"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u91cd\u65b0\u8bbe\u7f6ehostname\uff0c\u4e0d\u5141\u8bb8\u4e3alocalhost"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},'# \u4fee\u6539 hostname\uff0c\u540d\u5b57\u4e0d\u5141\u8bb8\u4f7f\u7528\u4e0b\u5212\u7ebf\u3001\u5c0f\u6570\u70b9\u3001\u5927\u5199\u5b57\u6bcd\uff0c\u4e0d\u80fd\u53ebmaster\nhostnamectl set-hostname your-new-host-name\n# \u67e5\u770b\u4fee\u6539\u7ed3\u679c\nhostnamectl status\n# \u8bbe\u7f6e hostname \u89e3\u6790\necho "127.0.0.1   $(hostname)" >> /etc/hosts\n'))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u8981\u6c422\u53f0\u670d\u52a1\u4e4b\u95f4\u53ef\u4ee5\u76f8\u4e92\u901a\u8baf")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u5b89\u88c5\u8f6f\u4ef6"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"# \u963f\u91cc\u4e91 docker hub \u955c\u50cf\nexport REGISTRY_MIRROR=https://registry.cn-hangzhou.aliyuncs.com\ncurl -sSL https://kuboard.cn/install-script/v1.19.x/install_kubelet.sh | sh -s 1.19.5\n")))),(0,r.yg)("p",null,"\u9996\u5148\u521d\u59cb\u5316Master\u8282\u70b9"),(0,r.yg)("blockquote",null,(0,r.yg)("p",{parentName:"blockquote"},"\u5173\u4e8e\u521d\u59cb\u5316\u65f6\u7528\u5230\u7684\u73af\u5883\u53d8\u91cf"),(0,r.yg)("ul",{parentName:"blockquote"},(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"APISERVER_NAME")," \u4e0d\u80fd\u662f master \u7684 hostname"),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"APISERVER_NAME")," \u5fc5\u987b\u5168\u4e3a\u5c0f\u5199\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u5c0f\u6570\u70b9\uff0c\u4e0d\u80fd\u5305\u542b\u51cf\u53f7"),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"POD_SUBNET")," \u6240\u4f7f\u7528\u7684\u7f51\u6bb5\u4e0d\u80fd\u4e0e ",(0,r.yg)("strong",{parentName:"li"},(0,r.yg)("em",{parentName:"strong"},"master\u8282\u70b9/worker\u8282\u70b9"))," \u6240\u5728\u7684\u7f51\u6bb5\u91cd\u53e0\u3002\u8be5\u5b57\u6bb5\u7684\u53d6\u503c\u4e3a\u4e00\u4e2a ",(0,r.yg)("a",{parentName:"li",href:"https://kuboard.cn/glossary/cidr.html"},"CIDR")," \u503c\uff0c\u5982\u679c\u60a8\u5bf9 CIDR \u8fd9\u4e2a\u6982\u5ff5\u8fd8\u4e0d\u719f\u6089\uff0c\u8bf7\u4ecd\u7136\u6267\u884c export POD_SUBNET=10.100.0.0/16 \u547d\u4ee4\uff0c\u4e0d\u505a\u4fee\u6539"))),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u8bbe\u7f6eip\uff0c\u57df\u540d\uff0c\u7f51\u6bb5\u5e76\u6267\u884c\u521d\u59cb\u5316\u64cd\u4f5c"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},'# \u53ea\u5728 master \u8282\u70b9\u6267\u884c\n# \u66ff\u6362 x.x.x.x \u4e3a master \u8282\u70b9\u5b9e\u9645 IP\uff08\u8bf7\u4f7f\u7528\u5185\u7f51 IP\uff09\n# export \u547d\u4ee4\u53ea\u5728\u5f53\u524d shell \u4f1a\u8bdd\u4e2d\u6709\u6548\uff0c\u5f00\u542f\u65b0\u7684 shell \u7a97\u53e3\u540e\uff0c\u5982\u679c\u8981\u7ee7\u7eed\u5b89\u88c5\u8fc7\u7a0b\uff0c\u8bf7\u91cd\u65b0\u6267\u884c\u6b64\u5904\u7684 export \u547d\u4ee4\nexport MASTER_IP=192.168.11.32\n# \u66ff\u6362 apiserver.demo \u4e3a \u60a8\u60f3\u8981\u7684 dnsName\nexport APISERVER_NAME=apiserver.demo\n# Kubernetes \u5bb9\u5668\u7ec4\u6240\u5728\u7684\u7f51\u6bb5\uff0c\u8be5\u7f51\u6bb5\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u7531 kubernetes \u521b\u5efa\uff0c\u4e8b\u5148\u5e76\u4e0d\u5b58\u5728\u4e8e\u60a8\u7684\u7269\u7406\u7f51\u7edc\u4e2d\nexport POD_SUBNET=10.100.0.1/16\necho "${MASTER_IP}    ${APISERVER_NAME}" >> /etc/hosts\ncurl -sSL https://kuboard.cn/install-script/v1.19.x/init_master.sh | sh -s 1.19.5\n'))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u68c0\u67e5Master\u542f\u52a8\u72b6\u6001"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"# \u53ea\u5728 master \u8282\u70b9\u6267\u884c\n\n# \u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff0c\u7b49\u5f85 3-10 \u5206\u949f\uff0c\u76f4\u5230\u6240\u6709\u7684\u5bb9\u5668\u7ec4\u5904\u4e8e Running \u72b6\u6001\nwatch kubectl get pod -n kube-system -o wide\n\n# \u67e5\u770b master \u8282\u70b9\u521d\u59cb\u5316\u7ed3\u679c\nkubectl get nodes -o wide\n")))),(0,r.yg)("p",null,(0,r.yg)("inlineCode",{parentName:"p"},"Ps\uff1a\u5982\u679c\u51fa\u73b0NotReady\u7684\u60c5\u51b5\u6267\u884c\uff08\u6700\u65b0\u7248\u672c\u7684BUG\uff0c1.19\u4e00\u822c\u6ca1\u6709\uff09")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},'docker pull quay.io/coreos/flannel:v0.10.0-amd64 \nmkdir -p /etc/cni/net.d/\ncat <<EOF> /etc/cni/net.d/10-flannel.conf\n{"name":"cbr0","type":"flannel","delegate": {"isDefaultGateway": true}}\nEOF\nmkdir /usr/share/oci-umount/oci-umount.d -p\nmkdir /run/flannel/\ncat <<EOF> /run/flannel/subnet.env\nFLANNEL_NETWORK=172.100.0.0/16\nFLANNEL_SUBNET=172.100.1.0/24\nFLANNEL_MTU=1450\nFLANNEL_IPMASQ=true\nEOF\nkubectl apply -f https://raw.githubusercontent.com/coreos/flannel/v0.9.1/Documentation/kube-flannel.yml\n')),(0,r.yg)("p",null,"\u5b89\u88c5\u7f51\u7edc\u670d\u52a1\u63d2\u4ef6"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},'export POD_SUBNET=10.100.0.0/16\nkubectl apply -f https://kuboard.cn/install-script/v1.22.x/calico-operator.yaml\nwget https://kuboard.cn/install-script/v1.22.x/calico-custom-resources.yaml\nsed -i "s#192.168.0.0/16#${POD_SUBNET}#" calico-custom-resources.yaml\nkubectl apply -f calico-custom-resources.yaml\n')),(0,r.yg)("p",null,"\u521d\u59cb\u5316worker\u8282\u70b9"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u83b7\u53d6Join\u547d\u4ee4\u53c2\u6570\uff0c\u5728Master\u8282\u70b9\u6267\u884c"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"# \u53ea\u5728 master \u8282\u70b9\u6267\u884c\nkubeadm token create --print-join-command\n")),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u83b7\u53d6\u547d\u4ee4"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211213183025291.png",alt:"image-20211213183025291"}))))))),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u5728worker\u8282\u70b9\u521d\u59cb\u5316"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},'# \u53ea\u5728 worker \u8282\u70b9\u6267\u884c\n# \u66ff\u6362 x.x.x.x \u4e3a master \u8282\u70b9\u7684\u5185\u7f51 IP\nexport MASTER_IP=192.168.11.32\n# \u66ff\u6362 apiserver.demo \u4e3a\u521d\u59cb\u5316 master \u8282\u70b9\u65f6\u6240\u4f7f\u7528\u7684 APISERVER_NAME\nexport APISERVER_NAME=apiserver.demo\necho "${MASTER_IP}    ${APISERVER_NAME}" >> /etc/hosts\n\n# \u66ff\u6362\u4e3a master \u8282\u70b9\u4e0a kubeadm token create \u547d\u4ee4\u7684\u8f93\u51fa\nkubeadm join apiserver.demo:6443 --token vwfilu.3nhndohc5gn1jv9k     --discovery-token-ca-cert-hash sha256:22ff15cabfe87ab48a7db39b3bbf986fee92ec92eb8efc7fe9b0abe2175ff0c2\n')))),(0,r.yg)("p",null,"\u68c0\u67e5\u6700\u7ec8\u8fd0\u884c\u6548\u679c"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u5728 master \u8282\u70b9\u4e0a\u6267\u884c"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"# \u53ea\u5728 master \u8282\u70b9\u6267\u884c\nkubectl get nodes -o wide\n")))),(0,r.yg)("p",null,(0,r.yg)("inlineCode",{parentName:"p"},"Ps\uff1a\u5982\u679c\u51fa\u73b0NotReady\u7684\u60c5\u51b5\u6267\u884c\uff08\u6700\u65b0\u7248\u672c\u7684BUG\uff0c1.19\u4e00\u822c\u6ca1\u6709\uff09")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},'docker pull quay.io/coreos/flannel:v0.10.0-amd64 \nmkdir -p /etc/cni/net.d/\ncat <<EOF> /etc/cni/net.d/10-flannel.conf\n{"name":"cbr0","type":"flannel","delegate": {"isDefaultGateway": true}}\nEOF\nmkdir /usr/share/oci-umount/oci-umount.d -p\nmkdir /run/flannel/\ncat <<EOF> /run/flannel/subnet.env\nFLANNEL_NETWORK=172.100.0.0/16\nFLANNEL_SUBNET=172.100.1.0/24\nFLANNEL_MTU=1450\nFLANNEL_IPMASQ=true\nEOF\nkubectl apply -f https://raw.githubusercontent.com/coreos/flannel/v0.9.1/Documentation/kube-flannel.yml\n')),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u8f93\u51fa\u7ed3\u679c\u5982\u4e0b\u6240\u793a\uff1a"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"[root@k8smaster ~]# kubectl get nodes\n")),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u642d\u5efa\u6210\u529f\u6548\u679c"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211210184851810.png",alt:"image-20211210184851810"}))))))),(0,r.yg)("p",null,"\u5b89\u88c5Kuboard\u7ba1\u7406K8s\u96c6\u7fa4"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u5b89\u88c5Kuboard"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-yml"},"kubectl apply -f https://addons.kuboard.cn/kuboard/kuboard-v3.yaml\n# \u60a8\u4e5f\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u6307\u4ee4\uff0c\u552f\u4e00\u7684\u533a\u522b\u662f\uff0c\u8be5\u6307\u4ee4\u4f7f\u7528\u534e\u4e3a\u4e91\u7684\u955c\u50cf\u4ed3\u5e93\u66ff\u4ee3 docker hub \u5206\u53d1 Kuboard \u6240\u9700\u8981\u7684\u955c\u50cf\n# kubectl apply -f https://addons.kuboard.cn/kuboard/kuboard-v3-swr.yaml\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u67e5\u770b\u542f\u52a8\u60c5\u51b5"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre"},"watch kubectl get pods -n kuboard\n")),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u67e5\u770b\u6548\u679c"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211213184701784.png",alt:"image-20211213184701784"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00\u94fe\u63a5 http://your-node-ip-address:30080"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u9996\u9875"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211213184742709.png",alt:"image-20211213184742709"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u8f93\u5165\u521d\u59cb\u7528\u6237\u540d\u548c\u5bc6\u7801\uff0c\u5e76\u767b\u5f55"),(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},"\u7528\u6237\u540d\uff1a ",(0,r.yg)("inlineCode",{parentName:"li"},"admin")),(0,r.yg)("li",{parentName:"ul"},"\u5bc6\u7801\uff1a ",(0,r.yg)("inlineCode",{parentName:"li"},"Kuboard123"))),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u9996\u9875\u6548\u679c"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20211213184840120.png",alt:"image-20211213184840120"}))))))),(0,r.yg)("h4",{id:"104-kubernetes\u64cd\u4f5c"},"10.4 Kubernetes\u64cd\u4f5c"),(0,r.yg)("p",null,"\u9996\u5148\u6211\u4eec\u8981\u4e86\u89e3Kubernetes\u5728\u8fd0\u884c\u6211\u4eec\u7684\u8d44\u6e90\u65f6\uff0c\u5173\u8054\u5230\u4e86\u54ea\u4e9b\u5185\u5bb9"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u8d44\u6e90\u7684\u6784\u5efa\u65b9\u5f0f\uff1a"),(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},"\u91c7\u7528kubectl\u7684\u547d\u4ee4\u65b9\u5f0f"),(0,r.yg)("li",{parentName:"ul"},"yaml\u6587\u4ef6\u65b9\u5f0f")))),(0,r.yg)("h5",{id:"1041-namespace"},"10.4.1 Namespace"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u547d\u540d\u7a7a\u95f4\uff1a\u4e3b\u8981\u662f\u4e3a\u4e86\u5bf9Kubernetes\u4e2d\u8fd0\u884c\u7684\u8d44\u6e90\u8fdb\u884c\u8fc7\u9694\u79bb\uff0c \u4f46\u662f\u7f51\u7edc\u662f\u4e92\u901a\u7684\uff0c\u7c7b\u4f3cDocker\u7684\u5bb9\u5668\uff0c\u53ef\u4ee5\u5c06\u591a\u4e2a\u8d44\u6e90\u914d\u7f6e\u5230\u4e00\u4e2aNameSpace\u4e2d\u3002\u800cNameSpace\u53ef\u4ee5\u5bf9\u4e0d\u540c\u73af\u5883\u8fdb\u884c\u8d44\u6e90\u9694\u79bb\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0bKubernetes\u63d0\u4f9b\u4e86default\u547d\u540d\u7a7a\u95f4\uff0c\u5728\u6784\u5efa\u8d44\u6e90\u65f6\uff0c\u5982\u679c\u4e0d\u6307\u5b9a\u8d44\u6e90\uff0c\u9ed8\u8ba4\u91c7\u7528default\u8d44\u6e90\u3002\n\u547d\u4ee4\u65b9\u5f0f\uff1a"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"# \u67e5\u770b\u73b0\u6709\u7684\u5168\u90e8\u547d\u540d\u7a7a\u95f4\nkubectl get ns\n\n# \u6784\u5efa\u547d\u540d\u7a7a\u95f4\nkubectl create ns \u547d\u540d\u7a7a\u95f4\u540d\u79f0\n\n# \u5220\u9664\u73b0\u6709\u547d\u540d\u7a7a\u95f4\uff0c \u5e76\u4e14\u4f1a\u5220\u9664\u7a7a\u95f4\u4e0b\u7684\u5168\u90e8\u8d44\u6e90\nkubectl delete ns \u547d\u540d\u7a7a\u95f4\u540d\u79f0\n")),(0,r.yg)("p",{parentName:"li"},"yaml\u6587\u4ef6\u65b9\u5f0f\uff1a\uff08\u6784\u5efa\u8d44\u6e90\u65f6\uff0c\u8bbe\u7f6e\u547d\u540d\u7a7a\u95f4\uff09"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: v1\nkind: Namespace\nmetadata:\n  name: test\n")))),(0,r.yg)("h5",{id:"1042-pod"},"10.4.2 Pod"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"Pod\uff1aKubernetes\u8fd0\u884c\u7684\u4e00\u7ec4\u5bb9\u5668\uff0cPod\u662fKubernetes\u7684\u6700\u5c0f\u5355\u4f4d\uff0c\u4f46\u662f\u5bf9\u4e8eDocker\u800c\u7136\uff0cPod\u4e2d\u4f1a\u8fd0\u884c\u591a\u4e2aDocker\u5bb9\u5668"),(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u547d\u4ee4\u65b9\u5f0f\uff1a"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-bash"},"# \u67e5\u770b\u6240\u6709\u8fd0\u884c\u7684pod\nkubectl get pods -A\n\n# \u67e5\u770b\u6307\u5b9aNamespace\u4e0b\u7684Pod\nkubectl get pod [-n \u547d\u540d\u7a7a\u95f4]  #\uff08\u9ed8\u8ba4default\uff09\n\n# \u521b\u5efaPod\nkubectl run pod\u540d\u79f0 --image=\u955c\u50cf\u540d\u79f0\n\n# \u67e5\u770bPod\u8be6\u7ec6\u4fe1\u606f\nkubectl describe pod pod\u540d\u79f0\n\n# \u5220\u9664pod\nkubectl delete pod pod\u540d\u79f0 [-n \u547d\u540d\u7a7a\u95f4]  #\uff08\u9ed8\u8ba4default\uff09\n\n# \u67e5\u770bpod\u8f93\u51fa\u7684\u65e5\u5fd7\nkubectl logs -f pod\u540d\u79f0\n\n# \u8fdb\u53bbpod\u5bb9\u5668\u5185\u90e8\nkubectl exec -it pod\u540d\u79f0 -- bash\n\n# \u67e5\u770bkubernetes\u7ed9Pod\u5206\u914d\u7684ip\u4fe1\u606f\uff0c\u5e76\u4e14\u901a\u8fc7ip\u548c\u5bb9\u5668\u7684\u7aef\u53e3\uff0c\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\nkubectl get pod -owide\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"yaml\u65b9\u5f0f\uff08\u63a8\u8350\uff09"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: v1\nkind: Pod\nmetadata:\n  labels:\n    run: \u8fd0\u884c\u7684pod\u540d\u79f0\n  name: pod\u540d\u79f0\n  namespace: \u547d\u540d\u7a7a\u95f4\nspec:\n  containers:\n  - image: \u955c\u50cf\u540d\u79f0\n    name: \u5bb9\u5668\u540d\u79f0\n\n# \u542f\u52a8Pod\uff1akubectl apply -f yaml\u6587\u4ef6\u540d\u79f0\n# \u5220\u9664Pod\uff1akubectl delete -f yaml\u6587\u4ef6\u540d\u79f0\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"Pod\u4e2d\u8fd0\u884c\u591a\u4e2a\u5bb9\u5668"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-yml"},"apiVersion: v1\nkind: Pod\nmetadata:\n  labels:\n    run: \u8fd0\u884c\u7684pod\u540d\u79f0\n  name: pod\u540d\u79f0\n  namespace: \u547d\u540d\u7a7a\u95f4\nspec:\n  containers:\n  - image: \u955c\u50cf\u540d\u79f0\n    name: \u5bb9\u5668\u540d\u79f0\n  - image: \u955c\u50cf\u540d\u79f0\n    name: \u5bb9\u5668\u540d\u79f0\n\u2026\u2026\u2026\u2026    \n")),(0,r.yg)("p",{parentName:"li"},"\u542f\u52a8\u540e\u53ef\u4ee5\u67e5\u770b\u5230"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"Kuboard\u6548\u679c"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20220104203155749.png",alt:"image-20220104203155749"}))))))))),(0,r.yg)("h5",{id:"1043-deployment"},"10.4.3 Deployment"),(0,r.yg)("p",null,"\u90e8\u7f72\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7Deployment\u7ba1\u7406\u548c\u7f16\u6392Pod"),(0,r.yg)("p",null,"Deployment\u90e8\u7f72\u5b9e\u73b0"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u547d\u4ee4\u65b9\u5f0f"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"# \u57fa\u4e8eDeployment\u542f\u52a8\u5bb9\u5668\nkubectl create deployment deployment\u540d\u79f0 --image=\u955c\u50cf\u540d\u79f0\n# \u7528deployment\u542f\u52a8\u7684\u5bb9\u5668\u4f1a\u5728\u88ab\u5220\u9664\u540e\u81ea\u52a8\u518d\u6b21\u521b\u5efa\uff0c\u8fbe\u5230\u6545\u969c\u6f02\u79fb\u7684\u6548\u679c\n# \u9700\u8981\u4f7f\u7528deploy\u7684\u65b9\u5f0f\u5220\u9664deploy\n# \u67e5\u770b\u73b0\u5728\u7684deployment\nkubectl get deployment\n\n# \u5220\u9664deployment\nkubectl delete deployment deployment\u540d\u79f0\n\n# \u57fa\u4e8eDeployment\u542f\u52a8\u5bb9\u5668\u5e76\u8bbe\u7f6ePod\u96c6\u7fa4\u6570\nkubectl create deployment deployment\u540d\u79f0 --image=\u955c\u50cf\u540d\u79f0 --replicas \u96c6\u7fa4\u4e2a\u6570\n"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("a",{parentName:"p",href:"https://kubernetes.io/zh/docs/concepts/workloads/controllers/deployment/"},"\u914d\u7f6e\u6587\u4ef6\u65b9\u5f0f")),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-yml"},"apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\n  labels:\n    app: nginx\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n       image: nginx\n       ports:\n       - containerPort: 80\n")),(0,r.yg)("p",{parentName:"li"},"\u6b63\u5e38\u4f7f\u7528kubectl\u8fd0\u884cyaml\u5373\u53ef"))),(0,r.yg)("p",null,"\u5f39\u6027\u4f38\u7f29\u529f\u80fd"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"# \u57fa\u4e8escale\u5b9e\u73b0\u5f39\u6027\u4f38\u7f29\nkubectl scale deploy/Deployment\u540d\u79f0 --replicas \u96c6\u7fa4\u4e2a\u6570\n# \u6216\u8005\u4fee\u6539yaml\u6587\u4ef6\nkubectl edit deploy Deployment\u540d\u79f0\n")),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u56fe\u5f62\u5316\u9875\u9762\u4fee\u6539"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20220104210823057.png",alt:"image-20220104210823057"}))))),(0,r.yg)("p",null,"\u7070\u5ea6\u53d1\u5e03"),(0,r.yg)("p",null,"Deploy\u53ef\u4ee5\u5728\u90e8\u7f72\u65b0\u7248\u672c\u6570\u636e\u65f6\uff0c\u6210\u529f\u542f\u52a8\u4e00\u4e2apod\uff0c\u624d\u4f1a\u4e0b\u7ebf\u4e00\u4e2a\u8001\u7248\u672c\u7684Pod"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-shell"},"kubectl set image deployment/Deployment\u540d\u79f0 \u5bb9\u5668\u540d=\u955c\u50cf:\u7248\u672c\n")),(0,r.yg)("h5",{id:"1044-service"},"10.4.4 Service"),(0,r.yg)("p",null,"\u53ef\u4ee5\u5c06\u591a\u4e2aPod\u5bf9\u5916\u66b4\u9732\u4e00\u4e2aService\uff0c\u8ba9\u5ba2\u6237\u7aef\u53ef\u4ee5\u901a\u8fc7Service\u8bbf\u95ee\u5230\u8fd9\u4e00\u7ec4Pod\uff0c\u5e76\u4e14\u53ef\u4ee5\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861"),(0,r.yg)("p",null,"ClusterIP\u65b9\u5f0f\uff1a"),(0,r.yg)("p",null,"ClusterIP\u662f\u96c6\u7fa4\u5185\u90e8Pod\u4e4b\u95f4\u7684\u8bbf\u95ee\u65b9\u5f0f"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u547d\u4ee4\u5b9e\u73b0\u6548\u679c"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"# \u901a\u8fc7\u751f\u6210service\u6620\u5c04\u4e00\u4e2aDeployment\u4e0b\u7684\u6240\u6709pod\u4e2d\u7684\u67d0\u4e00\u4e2a\u7aef\u53e3\u7684\u5bb9\u5668\nkubectl expose deployment Deployment\u540d\u79f0 --port=Service\u7aef\u53e3\u53f7 --target-port=Pod\u5185\u5bb9\u5668\u7aef\u53e3\n")),(0,r.yg)("p",{parentName:"li"},"\u4e4b\u540e\u901a\u8fc7",(0,r.yg)("inlineCode",{parentName:"p"},"kubectl get service"),"\u67e5\u770bService\u63d0\u4f9b\u7684ip\uff0c\u5373\u53ef\u8bbf\u95ee"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"kubectl get service"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20220104214659229.png",alt:"image-20220104214659229"}))))),(0,r.yg)("p",{parentName:"li"},"\u4e5f\u53ef\u4ee5\u901a\u8fc7",(0,r.yg)("inlineCode",{parentName:"p"},"Deployment\u540d\u79f0.namespace\u540d\u79f0.svc"),"\u4f5c\u4e3a\u57df\u540d\u8bbf\u95ee"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u5728\u670d\u52a1\u5bb9\u5668\u5185\u6267\u884c"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20220104215030265.png",alt:"image-20220104215030265"}))))))),(0,r.yg)("p",null,"NodePort\u65b9\u5f0f"),(0,r.yg)("p",null,"ClusterIP\u7684\u65b9\u5f0f\u53ea\u80fd\u5728Pod\u5185\u90e8\u5b9e\u73b0\u8bbf\u95ee\uff0c\u4f46\u662f\u4e00\u822c\u9700\u8981\u5bf9\u5916\u66b4\u9732\u7f51\u5173\uff0c\u6240\u4ee5\u9700\u8981NodePort\u7684\u65b9\u5f0fPod\u5916\u66b4\u9732\u8bbf\u95ee"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u547d\u4ee4\u5b9e\u73b0\u65b9\u5f0f"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"# \u901a\u8fc7\u751f\u6210service\u6620\u5c04\u4e00\u4e2aDeployment\u4e0b\u7684\u6240\u6709pod\u4e2d\u7684\u67d0\u4e00\u4e2a\u7aef\u53e3\u7684\u5bb9\u5668\nkubectl expose deployment Deployment\u540d\u79f0 --port=Service\u7aef\u53e3\u53f7 --target-port=Pod\u5185\u5bb9\u5668\u7aef\u53e3 --type=NodePort\n")),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u67e5\u770bService\u6548\u679c"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20220104222750733.png",alt:"image-20220104222750733"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20220104222819455.png",alt:"image-20220104222819455"}))))))),(0,r.yg)("p",null,"Service\u4e5f\u53ef\u4ee5\u901a\u8fc7yaml\u6587\u4ef6\u5b9e\u73b0"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: v1\nkind: Service\nmetadata:\n  labels\n    app: nginx\n  name: nginx\n  spec:\n    selector:\n      app: nginx\n    ports:\n    - port: 8888\n     protocol: TCP\n     targetPort: 80\n")),(0,r.yg)("p",null,"\u901a\u8fc7apply\u542f\u52a8\u5c31\u4e5f\u53ef\u4ee5\u521b\u5efaService"),(0,r.yg)("p",null,"\u6d4b\u8bd5\u6548\u679c-Deployment\u90e8\u7f72\uff0c\u901a\u8fc7Service\u66b4\u9732"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\n  labels:\n    app: nginx-deployment\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx-deployment\n  template:\n    metadata:\n      labels:\n        app: nginx-deployment\n    spec:\n      containers:\n      - name: nginx-deployment\n        image: nginx\n        ports:\n        - containerPort: 80\n---\napiVersion: v1\nkind: Service\nmetadata:\n  labels:\n    app: nginx-service\n  name: nginx-service\nspec:\n  selector:\n    app: nginx-deployment\n  ports:\n  - port: 8888\n    protocol: TCP\n    targetPort: 80\n  type: NodePort\n")),(0,r.yg)("p",null,"\u53ef\u4ee5\u67e5\u770b\u5230\u66b4\u9732\u7684\u4fe1\u606f"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"Service\u4fe1\u606f"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20220105205334996.png",alt:"image-20220105205334996"}))))),(0,r.yg)("h5",{id:"1045-ingress"},"10.4.5 Ingress"),(0,r.yg)("p",null,"Kubernetes\u63a8\u8350\u5c06Ingress\u4f5c\u4e3a\u6240\u6709Service\u7684\u5165\u53e3\uff0c\u63d0\u4f9b\u7edf\u4e00\u7684\u5165\u53e3\uff0c\u907f\u514d\u591a\u4e2a\u670d\u52a1\u4e4b\u95f4\u9700\u8981\u8bb0\u5f55\u5927\u91cf\u7684IP\u6216\u8005\u57df\u540d\uff0c\u6bd5\u7adfIP\u53ef\u80fd\u6539\u53d8\uff0c\u670d\u52a1\u592a\u591a\u57df\u540d\u8bb0\u5f55\u4e0d\u65b9\u4fbf\u3002"),(0,r.yg)("p",null,"Ingress\u5e95\u5c42\u5176\u5b9e\u5c31\u662f\u4e00\u4e2aNginx\uff0c \u53ef\u4ee5\u5728Kuboard\u4e0a\u76f4\u63a5\u70b9\u51fb\u5b89\u88c5"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"Kuboard\u5b89\u88c5"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20220105153343642.png",alt:"image-20220105153343642"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("strong",{parentName:"td"},(0,r.yg)("img",{parentName:"strong",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20220105153416367.png",alt:"image-20220105153416367"})))))),(0,r.yg)("p",null,"\u56e0\u4e3a\u526f\u672c\u6570\u9ed8\u8ba4\u4e3a1\uff0c\u4f46\u662fk8s\u6574\u4f53\u96c6\u7fa4\u5c312\u4e2a\u8282\u70b9\uff0c\u6240\u4ee5\u663e\u793a\u4e0b\u9762\u5373\u4e3a\u5b89\u88c5\u6210\u529f"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u5b89\u88c5\u6210\u529f"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20220105153502619.png",alt:"image-20220105153502619"}))))),(0,r.yg)("p",null,"\u53ef\u4ee5\u5c06Ingress\u63a5\u6536\u5230\u7684\u8bf7\u6c42\u8f6c\u53d1\u5230\u4e0d\u540c\u7684Service\u4e2d\u3002"),(0,r.yg)("p",null,"\u63a8\u8350\u4f7f\u7528yaml\u6587\u4ef6\u65b9\u5f0f"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: nginx-ingress\nspec:\n  ingressClassName: ingress\n  rules:\n  - host: nginx.mashibing.com\n    http:\n      paths:\n      - path: /\n        pathType: Prefix\n        backend:\n          service:\n            name: nginx-service\n            port:\n              number: 8888\n")),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u542f\u52a8\u65f6\u95ee\u9898"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20220105203819715.png",alt:"image-20220105203819715"}))))),(0,r.yg)("p",null,"Kuboard\u5b89\u88c5\u7684Ingress\u6709admission\u7684\u6821\u9a8c\u914d\u7f6e\uff0c\u9700\u8981\u5148\u5220\u9664\u914d\u7f6e\u518d\u542f\u52a8"),(0,r.yg)("p",null,"\u627e\u5230\u6307\u5b9a\u7684ingress\u7684\u6821\u9a8c\u4fe1\u606f\uff0c\u5220\u9664\u5373\u53ef"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u5220\u9664\u4fe1\u606f"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20220105204434044.png",alt:"image-20220105204434044"}))))),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"# \u67e5\u770b\u6821\u9a8cwebhook\u7684\u914d\u7f6e\nkubectl get -A ValidatingWebhookConfiguration\n\n# \u5220\u9664\u6307\u5b9a\u7684\u6821\u9a8c\nkubectl delete ValidatingWebhookConfiguration ingress-nginx-admission-my-ingress-controller\n")),(0,r.yg)("p",null,"\u914d\u7f6e\u672c\u5730hosts\u6587\u4ef6"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u914d\u7f6ehosts"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20220105204921272.png",alt:"image-20220105204921272"}))))),(0,r.yg)("p",null,"\u8bb0\u4e0b\u6765\u65e2\u53ef\u4ee5\u8bbf\u95ee\u5728Service\u4e2d\u66b4\u9732\u7684Nginx\u4fe1\u606f"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u670d\u901a\u8fc7Ingress\u8bbf\u95ee"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/image-20220105205407393.png",alt:"image-20220105205407393"}))))),(0,r.yg)("h4",{id:"105-jenkins\u96c6\u6210kubernetes"},"10.5 Jenkins\u96c6\u6210Kubernetes"),(0,r.yg)("h5",{id:"1051-\u51c6\u5907\u90e8\u7f72\u7684yml\u6587\u4ef6"},"10.5.1 \u51c6\u5907\u90e8\u7f72\u7684yml\u6587\u4ef6"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yml"},"apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: test\n  name: pipeline\n  labels:\n    app: pipeline\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: pipeline\n  template:\n    metadata:\n      labels:\n        app: pipeline    \n    spec:\n      containers:\n      - name: pipeline\n        image: 192.168.11.102:80/repo/pipeline:v4.0.0\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 8080\n---\napiVersion: v1\nkind: Service\nmetadata:\n  namespace: test\n  labels:\n    app: pipeline\n  name: pipeline  \nspec:\n  selector:\n    app: pipeline\n  ports:\n  - port: 8081\n    targetPort: 8080\n  type: NodePort\n---\napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  namespace: test\n  name: pipeline\nspec:\n  ingressClassName: ingress\n  rules:\n  - host: mashibing.pipeline.com\n    http:\n      paths:\n      - path: /\n        pathType: Prefix\n        backend:\n          service:\n            name: pipeline\n            port:\n              number: 8081\n")),(0,r.yg)("h5",{id:"1052-harbor\u79c1\u670d\u914d\u7f6e"},"10.5.2 Harbor\u79c1\u670d\u914d\u7f6e"),(0,r.yg)("p",null,"\u5728\u5c1d\u8bd5\u7528kubernetes\u7684yml\u6587\u4ef6\u542f\u52a8pipeline\u670d\u52a1\u65f6\uff0c\u4f1a\u51fa\u73b0Kubernetes\u65e0\u6cd5\u62c9\u53d6\u955c\u50cf\u7684\u95ee\u9898\uff0c\u8fd9\u91cc\u9700\u8981\u5728kubernetes\u6240\u5728\u7684Linux\u4e2d\u914d\u7f6eHarbor\u670d\u52a1\u4fe1\u606f\uff0c\u5e76\u4e14\u4fdd\u8bc1Kubernetes\u53ef\u4ee5\u62c9\u53d6Harbor\u4e0a\u7684\u955c\u50cf"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u8bbe\u7f6eMaster\u548cWorker\u7684\u79c1\u670d\u5730\u5740\u4fe1\u606f"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u8bbe\u7f6eHarbor\u79c1\u670d\u5730\u5740"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/1642498962716.png",alt:"1642498962716"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u5728Kuboard\u4e0a\u8bbe\u7f6e\u79c1\u670d\u5bc6\u6587\u4fe1\u606f"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u8bbe\u7f6e\u5bc6\u6587\u5e76\u6d4b\u8bd5"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/1642498994935.png",alt:"1642498994935"}))))),(0,r.yg)("p",{parentName:"li"},"\u6309\u7167\u590d\u5236\u6307\u4ee4\u7684\u4f4d\u7f6e\u6d4b\u8bd5\u8ba4\u8bc1\uff0c\u6548\u679c\u5982\u4e0b"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u6d4b\u8bd5\u6548\u679c"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/1642499172789.png",alt:"1642499172789"}))))))),(0,r.yg)("h5",{id:"1053-\u6d4b\u8bd5\u4f7f\u7528\u6548\u679c"},"10.5.3 \u6d4b\u8bd5\u4f7f\u7528\u6548\u679c"),(0,r.yg)("p",null,"\u6267\u884ckubectl\u547d\u4ee4\uff0c\u57fa\u4e8eyml\u542f\u52a8\u670d\u52a1\uff0c\u5e76\u4e14\u57fa\u4e8e\u90e8\u7f72\u540e\u670d\u52a1\u7684\u63d0\u793a\u4fe1\u606f\u4ee5\u53caIngress\u7684\u8bbe\u7f6e\uff0c\u76f4\u63a5\u8bbf\u95ee"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null}))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/1642499368121.png",alt:"1642499368121"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/1642499788199.png",alt:"1642499788199"}))))),(0,r.yg)("h5",{id:"1053-jenkins\u8fdc\u7a0b\u8c03\u7528"},"10.5.3 Jenkins\u8fdc\u7a0b\u8c03\u7528"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u5c06pipeline.yml\u914d\u7f6e\u5230Gitlab\u4e2d"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u914d\u7f6eyml\u6587\u4ef6"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/1642499885324.png",alt:"1642499885324"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u914d\u7f6eJenkins\u7684\u76ee\u6807\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u5c06yml\u6587\u4ef6\u4f20\u8f93\u5230K8s\u7684Master\u4e0a"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u8bbe\u7f6e\u76ee\u6807\u670d\u52a1\u5668"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/1642499992148.png",alt:"1642499992148"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u4fee\u6539Jenkinsfile\uff0c\u91cd\u65b0\u8bbe\u7f6e\u6d41\u6c34\u7ebf\u4efb\u52a1\u811a\u672c\uff0c\u5e76\u6d4b\u8bd5\u6548\u679c"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u4f20\u9012yml\u6587\u4ef6\u811a\u672c"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/1642500061153.png",alt:"1642500061153"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/1642500102996.png",alt:"1642500102996"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u8bbe\u7f6eJenkins\u65e0\u5bc6\u7801\u767b\u5f55k8s-master"),(0,r.yg)("p",{parentName:"li"},"\u5c06Jenkins\u4e2d\u516c\u94a5\u4fe1\u606f\u590d\u5236\u5230k8s-master\u7684~/.ssh/authorized_keysz\u4e2d\uff0c\u4fdd\u8bc1\u8fdc\u7a0b\u8fde\u63a5\u65e0\u5bc6\u7801"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u65e0\u9700\u5bc6\u7801"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/1642500239406.png",alt:"1642500239406"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u8bbe\u7f6e\u6267\u884ckubectl\u7684\u811a\u672c\u5230Jenkinsfile"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u8bbe\u7f6eJenkinsfile"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/1642500378788.png",alt:"1642500378788"})))))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u6267\u884c\u67e5\u770b\u6548\u679c"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u6267\u884c\u6d41\u6c34\u7ebf"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/1642500413802.png",alt:"1642500413802"}))))),(0,r.yg)("p",{parentName:"li"},"\u53ef\u4ee5\u67e5\u770b\u5230yml\u6587\u4ef6\u662f\u7531\u53d8\u5316\u7684\uff0c \u8fd9\u6837k8s\u5c31\u4f1a\u91cd\u65b0\u52a0\u8f7d")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"\u67e5\u770b\u6548\u679c"),(0,r.yg)("table",{parentName:"li"},(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u6548\u679c"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/1642500474036.png",alt:"1642500474036"}))))))),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://www.faithcal.com"},"Ps\uff1a\u8fd9\u79cd\u65b9\u5f0f\u66f4\u9002\u5e94\u4e0eCD\u64cd\u4f5c\uff0c\u5c06\u9879\u76ee\u5c06\u57fa\u4e8e\u67d0\u4e2a\u7248\u672c\u90e8\u7f72\u5230\u6307\u5b9a\u7684\u76ee\u6807\u670d\u52a1\u5668")),(0,r.yg)("h4",{id:"106-\u57fa\u4e8egitlab\u7684webhooks"},"10.6 \u57fa\u4e8eGitLab\u7684WebHooks"),(0,r.yg)("p",null,"\u8fd9\u91cc\u8981\u5b9e\u73b0\u81ea\u52a8\u5316\u7684\u4e00\u4e2aCI\u64cd\u4f5c\uff0c\u4e5f\u5c31\u662f\u5f00\u53d1\u4eba\u5458Push\u4ee3\u7801\u5230Git\u4ed3\u5e93\u540e\uff0cJenkins\u4f1a\u81ea\u52a8\u7684\u6784\u5efa\u9879\u76ee\uff0c\u5c06\u6700\u65b0\u7684\u63d0\u4ea4\u70b9\u4ee3\u7801\u6784\u5efa\u5e76\u8fdb\u884c\u6253\u5305\u90e8\u7f72\uff0c\u8fd9\u91cc\u533a\u522b\u53bb\u4e0a\u8ff0\u7684CD\u64cd\u4f5c\uff0cCD\u64cd\u4f5c\u9700\u8981\u57fa\u4e8e\u67d0\u4e2a\u7248\u672c\u8fdb\u884c\u90e8\u7f72\uff0c\u800c\u8fd9\u91cc\u6bcf\u6b21\u90fd\u662f\u5c06\u6700\u65b0\u7684\u63d0\u4ea4\u70b9\u96c6\u6210\u5230\u4e3b\u5e72\u4e0a\u5e76\u6d4b\u8bd5\u3002"),(0,r.yg)("h5",{id:"1061-webhooks\u901a\u77e5"},"10.6.1 WebHooks\u901a\u77e5"),(0,r.yg)("p",null,"\u5f00\u542fJenkins\u7684\u81ea\u52a8\u6784\u5efa"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u6784\u5efa\u89e6\u53d1\u5668"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/1642500817131.png",alt:"1642500817131"}))))),(0,r.yg)("p",null,"\u8bbe\u7f6eGitlab\u7684Webhooks"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u8bbe\u7f6eGitlab\u7684Webhooks"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/1642500933316.png",alt:"1642500933316"}))))),(0,r.yg)("p",null,"\u9700\u8981\u5173\u95edJenkins\u7684Gitlab\u8ba4\u8bc1"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u5173\u95edJenkins\u7684Gitlab\u8ba4\u8bc1"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/1642501016474.png",alt:"1642501016474"}))))),(0,r.yg)("p",null,"\u518d\u6b21\u6d4b\u8bd5Gitlab"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u518d\u6b21\u6d4b\u8bd5"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/1642501065243.png",alt:"1642501065243"}))))),(0,r.yg)("h5",{id:"1062-\u4fee\u6539\u914d\u7f6e"},"10.6.2 \u4fee\u6539\u914d\u7f6e"),(0,r.yg)("p",null,"\u4fee\u6539Jenkinsfile\u5b9e\u73b0\u57fa\u4e8e\u6700\u65b0\u63d0\u4ea4\u70b9\u5b9e\u73b0\u6301\u7eed\u96c6\u6210\u6548\u679c\uff0c\u5c06\u4e4b\u524d\u5f15\u7528${tag}\u7684\u5168\u90e8\u53bb\u6389"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-json"},"// \u6240\u6709\u7684\u811a\u672c\u547d\u4ee4\u90fd\u653e\u5728pipeline\u4e2d\npipeline{\n    // \u6307\u5b9a\u4efb\u52a1\u518d\u54ea\u4e2a\u96c6\u7fa4\u8282\u70b9\u4e2d\u6267\u884c\n    agent any\n\n    // \u58f0\u660e\u5168\u5c40\u53d8\u91cf\uff0c\u65b9\u4fbf\u540e\u9762\u4f7f\u7528\n    environment {\n        harborUser = 'admin'\n        harborPasswd = 'Harbor12345'\n        harborAddress = '192.168.11.102:80'\n        harborRepo = 'repo'\n    }\n\n    stages {\n        stage('\u62c9\u53d6git\u4ed3\u5e93\u4ee3\u7801') {\n            steps {\n                checkout([$class: 'GitSCM', branches: [[name: '*/master']], extensions: [], userRemoteConfigs: [[url: 'http://192.168.11.101:8929/root/mytest.git']]])\n            }\n        }\n        stage('\u901a\u8fc7maven\u6784\u5efa\u9879\u76ee') {\n            steps {\n                sh '/var/jenkins_home/maven/bin/mvn clean package -DskipTests'\n            }\n        }\n        stage('\u901a\u8fc7SonarQube\u505a\u4ee3\u7801\u8d28\u91cf\u68c0\u6d4b') {\n            steps {\n                sh '/var/jenkins_home/sonar-scanner/bin/sonar-scanner -Dsonar.source=./ -Dsonar.projectname=${JOB_NAME} -Dsonar.projectKey=${JOB_NAME} -Dsonar.java.binaries=./target/ -Dsonar.login=40306ae8ea69a4792df2ceb4d9d25fe8a6ab1701'\n            }\n        }\n        stage('\u901a\u8fc7Docker\u5236\u4f5c\u81ea\u5b9a\u4e49\u955c\u50cf') {\n            steps {\n                sh '''mv ./target/*.jar ./docker/\n                docker build -t ${JOB_NAME}:latest ./docker/'''\n            }\n        }\n        stage('\u5c06\u81ea\u5b9a\u4e49\u955c\u50cf\u63a8\u9001\u5230Harbor') {\n            steps {\n                sh '''docker login -u ${harborUser} -p ${harborPasswd} ${harborAddress}\n                docker tag ${JOB_NAME}:latest  ${harborAddress}/${harborRepo}/${JOB_NAME}:latest\n                docker push ${harborAddress}/${harborRepo}/${JOB_NAME}:latest '''\n            }\n        }\n        stage('\u5c06yml\u6587\u4ef6\u4f20\u5230k8s-master\u4e0a') {\n            steps {\n                sshPublisher(publishers: [sshPublisherDesc(configName: 'k8s', transfers: [sshTransfer(cleanRemote: false, excludes: '', execCommand: '', execTimeout: 120000, flatten: false, makeEmptyDirs: false, noDefaultExcludes: false, patternSeparator: '[, ]+', remoteDirectory: '', remoteDirectorySDF: false, removePrefix: '', sourceFiles: 'pipeline.yml')], usePromotionTimestamp: false, useWorkspaceInPromotion: false, verbose: false)])\n            }\n        }\n        stage('\u8fdc\u7a0b\u6267\u884ck8s-master\u7684kubectl\u547d\u4ee4') {\n            steps {\n               sh '''ssh root@192.168.11.201 kubectl apply -f /usr/local/k8s/pipeline.yml\n                ssh root@192.168.11.201 kubectl rollout restart deployment pipeline -n test'''\n            }\n        }\n\n    }\n    post {\n        success {\n            dingtalk(\n                robot: 'Jenkins-DingDing',\n                type: 'MARKDOWN',\n                title: \"success: ${JOB_NAME}\",\n                text: [\"- \u6210\u529f\u6784\u5efa\uff1a${JOB_NAME}! \\n- \u7248\u672c\uff1alatest \\n- \u6301\u7eed\u65f6\u95f4\uff1a${currentBuild.durationString}\" ]\n            )\n        }\n        failure {\n            dingtalk(\n                robot: 'Jenkins-DingDing',\n                type: 'MARKDOWN',\n                title: \"success: ${JOB_NAME}\",\n                text: [\"- \u6784\u5efa\u5931\u8d25\uff1a${JOB_NAME}! \\n- \u7248\u672c\uff1alatest \\n- \u6301\u7eed\u65f6\u95f4\uff1a${currentBuild.durationString}\" ]\n            )\n        }\n    }\n}\n\n")),(0,r.yg)("p",null,"\u4fee\u6539pipeline.yml\uff0c\u66f4\u6539\u955c\u50cf\u7248\u672c"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yml"},"apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: test\n  name: pipeline\n  labels:\n    app: pipeline\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: pipeline\n  template:\n    metadata:\n      labels:\n        app: pipeline    \n    spec:\n      containers:\n      - name: pipeline\n        image: 192.168.11.102:80/repo/pipeline:latest   # \u8fd9\u91cc\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 8080\n# \u7701\u7565\u5176\u4ed6\u5185\u5bb9\u2026\u2026\u2026\u2026\n")),(0,r.yg)("h5",{id:"1063-\u6eda\u52a8\u66f4\u65b0"},"10.6.3 \u6eda\u52a8\u66f4\u65b0"),(0,r.yg)("p",null,"\u56e0\u4e3apipeline\u6ca1\u6709\u6539\u53d8\u65f6\uff0c\u6bcf\u6b21\u4e0d\u4f1a\u91cd\u65b0\u52a0\u8f7d\uff0c\u8fd9\u6837\u4f1a\u5bfc\u81f4Pod\u4e2d\u7684\u5bb9\u5668\u4e0d\u4f1a\u52a8\u6001\u66f4\u65b0\uff0c\u8fd9\u91cc\u9700\u8981\u4f7f\u7528kubectl\u7684rollout restart\u547d\u4ee4\u6eda\u52a8\u66f4\u65b0"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"\u8bbe\u7f6eJenkinsfle"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/1642501521065.png",alt:"1642501521065"}))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},(0,r.yg)("img",{parentName:"td",src:"https://chalee-typora.oss-cn-beijing.aliyuncs.com/Pictures/1642501549176.png",alt:"1642501549176"}))))))}s.isMDXComponent=!0},5680:(e,a,t)=>{t.d(a,{xA:()=>y,yg:()=>N});var n=t(6540);function r(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function g(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function p(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?g(Object(t),!0).forEach((function(a){r(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):g(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function l(e,a){if(null==e)return{};var t,n,r=function(e,a){if(null==e)return{};var t,n,r={},g=Object.keys(e);for(n=0;n<g.length;n++)t=g[n],a.indexOf(t)>=0||(r[t]=e[t]);return r}(e,a);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(e);for(n=0;n<g.length;n++)t=g[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var i=n.createContext({}),m=function(e){var a=n.useContext(i),t=a;return e&&(t="function"==typeof e?e(a):p(p({},a),e)),t},y=function(e){var a=m(e.components);return n.createElement(i.Provider,{value:a},e.children)},s="mdxType",o={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},c=n.forwardRef((function(e,a){var t=e.components,r=e.mdxType,g=e.originalType,i=e.parentName,y=l(e,["components","mdxType","originalType","parentName"]),s=m(t),c=r,N=s["".concat(i,".").concat(c)]||s[c]||o[c]||g;return t?n.createElement(N,p(p({ref:a},y),{},{components:t})):n.createElement(N,p({ref:a},y))}));function N(e,a){var t=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var g=t.length,p=new Array(g);p[0]=c;var l={};for(var i in a)hasOwnProperty.call(a,i)&&(l[i]=a[i]);l.originalType=e,l[s]="string"==typeof e?e:r,p[1]=l;for(var m=2;m<g;m++)p[m]=t[m];return n.createElement.apply(null,p)}return n.createElement.apply(null,t)}c.displayName="MDXCreateElement"}}]);