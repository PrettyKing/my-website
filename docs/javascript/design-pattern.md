---
title: è®¾è®¡æ¨¡å¼
date: 2021-03-02
author: å«è¾°
---



## å¯¼è®º

- ã€Šè®¾è®¡æ¨¡å¼ã€‹ä¸€ä¹¦è‡ª1995å¹´æˆä¹¦ä¸€æ¥ï¼Œä¸€ç›´ æ˜¯ç¨‹åºå‘˜è°ˆè®ºçš„â€œé«˜ç«¯â€è¯é¢˜ä¹‹ä¸€ã€‚è®¸å¤šç¨‹åºå‘˜ä» è®¾è®¡æ¨¡å¼ä¸­å­¦åˆ°äº†è®¾è®¡è½¯ä»¶çš„çµæ„Ÿï¼Œæˆ–è€…æ‰¾åˆ°äº† é—®é¢˜çš„è§£å†³ç­”æ¡ˆã€‚åœ¨ç¤¾åŒºä¸­ï¼Œå³æœ‰äººå¯¹æ¨¡å¼æ— æ¯” å´‡æ‹œï¼Œä¹Ÿæœ‰äººå¯¹æ¨¡å¼å……æ»¡è¯¯è§£ã€‚æœ‰äº›ç¨‹åºå‘˜æŠŠè®¾ è®¡æ¨¡å¼è§†ä¸ºåœ£ç»ï¼Œå”¯æ¨¡å¼è‡³ä¸Š;æœ‰äº›äººå´è®¤ä¸ºè®¾ è®¡æ¨¡å¼åªåœ¨C++æˆ–è€…Javaä¸­ç”¨æ­¦ä¹‹åœ°ï¼ŒJavaScript è¿™ç§åŠ¨æ€è¯­è¨€æ²¡æœ‰è®¾è®¡æ¨¡å¼ä¸€è¯´ã€‚

## èµ·æº

- è®¾è®¡æ¨¡å¼å¹¶éæ˜¯è½¯ä»¶å¼€å‘ä¸­çš„ä¸“ä¸šæœ¯è¯­ã€‚å® é™…ä¸Šâ€œæ¨¡å¼â€æœ€æ—©è¯ç”Ÿäºå»ºç­‘å­¦ã€‚20ä¸–çºª70å¹´ ä»£ï¼Œå“ˆä½›å¤§å­¦å»ºç­‘å­¦åšå£«å’Œä»–çš„ç ”ç©¶å›¢é˜ŸèŠ±äº†çº¦ 20å¹´çš„æ—¶é—´ï¼Œç ”ç©¶äº†ä¸ºè§£å†³åŒä¸€é—®é¢˜è€Œè®¾è®¡å‡ºä¸ åŒç»“æ„å»ºç­‘ï¼Œä»ä¸­å‘ç°äº†é‚£äº›é«˜è´¨é‡è®¾è®¡ä¸­çš„ç›¸ ä¼¼æ€§ï¼Œå¹¶ä¸”ç”¨â€œæ¨¡å¼â€æ¥æŒ‡ä»£ç›¸ä¼¼æ€§ã€‚ 
- è®¾è®¡æ¨¡å¼:åœ¨é¢å‘å¯¹è±¡è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­é’ˆå¯¹ç‰¹å®šé—®é¢˜çš„ç®€æ´è€Œä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚

## å‡ ç§å¸¸è§çš„è®¾è®¡æ¨¡å¼

### å•ä¾‹æ¨¡å¼

- å®šä¹‰ï¼šä¿è¯ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—® å®ƒçš„å…¨å±€è®¿é—®ç‚¹ï¼Œå¦‚windowå¯¹è±¡ã€‚å½“æˆ‘ä»¬å•å‡»ç™» å½•æŒ‰é’®çš„æ—¶å€™é¡µé¢å‡ºç°ä¸€ä¸ªç™»é™†æµ®çª—ï¼Œè¿™ä¸ªæ‚¬æµ® çª—æ˜¯å”¯ä¸€çš„ï¼Œæ— è®ºå•å‡»å¤šå°‘æ¬¡ç™»é™†æŒ‰é’®ï¼Œè¿™ä¸ªæµ® çª—éƒ½åªä¼šè¢«åˆ›å»ºä¸€æ¬¡ï¼Œè¿™ä¸ªç™»é™†çš„æµ®çª—å°±é€‚åˆç”¨ å•ä¾‹æ¨¡å¼åˆ›å»ºã€‚

- code

  ```typescript
  class Singleton {
    private static instance: Singleton = null;
    constructor() {}
    public static getInstance(): Singleton {
      if (this.instance == null) {
        this.instance = new Singleton();
      }
      return this.instance;
    }
  }
  ```

  

### å·¥å‚æ¨¡å¼

- å·¥å‚æ¨¡å¼æ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„å®ä¾‹åŒ–å¯¹è±¡æ¨¡å¼äº†ï¼Œæ˜¯ç”¨å·¥ å‚æ–¹æ³•ä»£æ›¿newæ“ä½œçš„ä¸€ç§æ¨¡å¼ã€‚è‘—åçš„Jiveè®ºå› ,å°± å¤§é‡ä½¿ç”¨äº†å·¥å‚æ¨¡å¼ï¼Œå·¥å‚æ¨¡å¼åœ¨Javaç¨‹åºç³»ç»Ÿå¯ä»¥ è¯´æ˜¯éšå¤„å¯è§ã€‚å› ä¸ºå·¥å‚æ¨¡å¼å°±ç›¸å½“äºåˆ›å»ºå®ä¾‹å¯¹è±¡ çš„newï¼Œæˆ‘ä»¬ç»å¸¸è¦æ ¹æ®ç±»Classç”Ÿæˆå®ä¾‹å¯¹è±¡ï¼Œå¦‚A a=new A() å·¥å‚æ¨¡å¼ä¹Ÿæ˜¯ç”¨æ¥åˆ›å»ºå®ä¾‹å¯¹è±¡çš„ï¼Œæ‰€ä»¥ ä»¥ånewæ—¶å°±è¦å¤šä¸ªå¿ƒçœ¼ï¼Œæ˜¯å¦å¯ä»¥è€ƒè™‘ä½¿ç”¨å·¥å‚æ¨¡ å¼ï¼Œè™½ç„¶è¿™æ ·åšï¼Œå¯èƒ½å¤šåšä¸€äº›å·¥ä½œï¼Œä½†ä¼šç»™ä½ ç³»ç»Ÿ å¸¦æ¥æ›´å¤§çš„å¯æ‰©å±•æ€§å’Œå°½é‡å°‘çš„ä¿®æ”¹é‡ã€‚

- code 

  ```typescript
  //æŠ½è±¡ç±»
  abstract class INoodles {
    /**
     * æè¿°æ¯ç§é¢æ¡å•¥æ ·çš„
     */
    public abstract desc(): void;
  }
  
  class LzNoodles extends INoodles {
    public desc(): void {
      console.log('å…°å·æ‹‰é¢ ä¸Šæµ·çš„å¥½è´µ å®¶é‡Œæ‰5 6å—é’±ä¸€ç¢—');
    }
  }
  class PaoNoodles extends INoodles {
    public desc(): void {
      console.log('æ³¡é¢å¥½åƒ å¯ä¸è¦è´ªæ¯');
    }
  }
  class GankouNoodles extends INoodles {
    public desc(): void {
      console.log('è¿˜æ˜¯å®¶é‡Œçš„å¹²æ‰£é¢å¥½åƒ 6å—ä¸€ç¢—');
    }
  }
  
  class SimpleNoodlesFactory {
    public static TYPE_LZ: number = 1; //å…°å·æ‹‰é¢
    public static TYPE_PM: number = 2; //æ³¡é¢
    public static TYPE_GK: number = 3; //å¹²æ‰£é¢
  
    public static createNoodles(type: number): INoodles {
      switch (type) {
        case SimpleNoodlesFactory.TYPE_LZ:
          return new LzNoodles();
        case SimpleNoodlesFactory.TYPE_PM:
          return new PaoNoodles();
        case SimpleNoodlesFactory.TYPE_GK:
        default:
          return new GankouNoodles();
      }
    }
  }
  
  const noodles: INoodles = SimpleNoodlesFactory.createNoodles(
    SimpleNoodlesFactory.TYPE_GK
  );
  noodles.desc();
  ```

  

### ä»£ç†æ¨¡å¼

- ä¸ºä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ä¸ªä»£ç”¨å“æˆ–å ä½ç¬¦ï¼Œä»¥ä¾¿æ§åˆ¶å¯¹å®ƒçš„è®¿é—®ã€‚å¾ˆå¤šæ˜æ˜Ÿéƒ½æœ‰è‡ªå·±ç»çºªäººï¼Œæ¯”å¦‚å¼€æ¼”å”±ä¼šç»çºªäººä¼šä»£æ›¿æ˜æ˜Ÿç»†èŠ‚å’Œè°ˆå¥½æŠ¥é…¬ä¹‹åå†è·Ÿæ˜æ˜Ÿç­¾åˆåŒã€‚å³æ ¸å¿ƒæ˜¯å½“å®¢æˆ·ä¸æ–¹ä¾¿ç›´æ¥è®¿é—®ä¸€ä¸ªå¯¹è±¡æˆ–è€…ä¸æ»¡è¶³éœ€è¦çš„æ—¶å€™ï¼Œæä¾›ä¸€ä¸ªæ›¿èº«å¯¹è±¡æ§åˆ¶è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ï¼Œæ›¿èº«å¯¹è±¡å¯¹è¯·æ±‚æœ€åˆä¸€äº›å¤„ç†ä¹‹åå†æŠŠè¯·æ±‚è½¬äº¤ç»™æœ¬ä½“å¯¹è±¡ã€‚

- code

  ```typescript
  interface IUserDao {
    save(): void;
  }
  /**
   * æ¥å£å®ç°
   * ç›®æ ‡å¯¹è±¡
   */
  class UserDao implements IUserDao {
    public save(): void {
      console.log('----å·²ç»ä¿å­˜æ•°æ®!----');
    }
  }
  
  /**
   * ä»£ç†å¯¹è±¡,é™æ€ä»£ç†
   */
  class UserDaoProxy implements IUserDao {
    //æ¥æ”¶ä¿å­˜ç›®æ ‡å¯¹è±¡
    private target: IUserDao;
    constructor(target: IUserDao) {
      this.target = target;
    }
    public save(): void {
      console.log('å¼€å§‹äº‹åŠ¡...');
      this.target.save(); //æ‰§è¡Œç›®æ ‡å¯¹è±¡çš„æ–¹æ³•
      console.log('æäº¤äº‹åŠ¡...');
    }
  }
  
  // ä¸šåŠ¡é€»è¾‘ -ã€‹ å¼€å§‹æ‰§è¡Œä»£ç†
  //ç›®æ ‡å¯¹è±¡
  const target: UserDao = new UserDao();
  
  //ä»£ç†å¯¹è±¡,æŠŠç›®æ ‡å¯¹è±¡ä¼ ç»™ä»£ç†å¯¹è±¡,å»ºç«‹ä»£ç†å…³ç³»
  const proxy: UserDaoProxy = new UserDaoProxy(target);
  
  proxy.save(); //æ‰§è¡Œçš„æ˜¯ä»£ç†çš„æ–¹æ³•
  
  ```

  

### å‘½ä»¤æ¨¡å¼

- å‘½ä»¤æ¨¡å¼ä¸­çš„å‘½ä»¤æŒ‡çš„æ˜¯ä¸€ä¸ªæ‰§è¡ŒæŸäº›ç‰¹å®šäº‹æƒ…çš„æŒ‡ä»¤ï¼Œæœ‰æ—¶å€™éœ€è¦å‘æŸäº›ç‰¹å®šäº‹æƒ…çš„æŒ‡ä»¤ã€‚å¸¸è§çš„åº”ç”¨åœºæ™¯æœ‰æ—¶å€™éœ€è¦å‘æŸäº›å¯¹è±¡å‘é€è¯·æ±‚ï¼Œä½†æ˜¯å¹¶ä¸çŸ¥é“è¯·æ±‚çš„æ¥å—è€…æ˜¯è°ï¼Œä¹Ÿä¸çŸ¥é“è¢«è¯·æ±‚çš„æ“ä½œæ˜¯ä»€ä¹ˆã€‚å‡å¦‚æˆ‘ä»¬å»å¿«é¤åº—ï¼Œæˆ‘ä»¬å¯ä»¥ç‚¹é¤å–æ¶ˆé¤ä½†æ˜¯æˆ‘ä»¬å¹¶ä¸ç”¨å…³å¿ƒå¨å¸ˆæ˜¯è°æ€ä¹ˆåšã€‚

- code

  ```typescript
  // 1.æ¥æ”¶è€…è§’è‰²ç±»
  class Receiver {
    /**
     * çœŸæ­£æ‰§è¡Œå‘½ä»¤ç›¸åº”çš„æ“ä½œ
     */
    public action(): void {
      console.log('æ‰§è¡Œæ“ä½œ');
    }
  }
  
  // 2.æŠ½è±¡å‘½ä»¤è§’è‰²ç±»
  interface Command {
    /**
     * æ‰§è¡Œæ–¹æ³•
     */
    execute(): void;
  }
  
  // 3.å…·ä½“å‘½ä»¤è§’è‰²ç±»
  class ConcreteCommand implements Command {
    //æŒæœ‰ç›¸åº”çš„æ¥æ”¶è€…å¯¹è±¡
    private receiver: Receiver = null;
    /**
     * æ„é€ æ–¹æ³•
     */
    constructor(receiver: Receiver) {
      this.receiver = receiver;
    }
    public execute(): void {
      //é€šå¸¸ä¼šè½¬è°ƒæ¥æ”¶è€…å¯¹è±¡çš„ç›¸åº”æ–¹æ³•ï¼Œè®©æ¥æ”¶è€…æ¥çœŸæ­£æ‰§è¡ŒåŠŸèƒ½
      this.receiver.action();
    }
  }
  
  // 4.è¯·æ±‚è€…è§’è‰²ç±»
  class Invoker {
    /**
     * æŒæœ‰å‘½ä»¤å¯¹è±¡
     */
    private command: Command = null;
    /**
     * æ„é€ æ–¹æ³•
     */
    constructor(command: Command) {
      this.command = command;
    }
    /**
     * è¡ŒåŠ¨æ–¹æ³•
     */
    public action(): void {
      this.command.execute();
    }
  }
  
  //5.æ‰§è¡Œå±‚
  
  //åˆ›å»ºæ¥æ”¶è€…
  const receiver: Receiver = new Receiver();
  //åˆ›å»ºå‘½ä»¤å¯¹è±¡ï¼Œè®¾å®šå®ƒçš„æ¥æ”¶è€…
  const command: Command = new ConcreteCommand(receiver);
  
  //åˆ›å»ºè¯·æ±‚è€…ï¼ŒæŠŠå‘½ä»¤å¯¹è±¡è®¾ç½®è¿›å» å‘å·å‘½ä»¤
  const invoker: Invoker = new Invoker(command);
  //æ‰§è¡Œæ–¹æ³•
  invoker.action();
  
  ```

  

### å‘å¸ƒè®¢é˜…æ¨¡å¼

- å‘å¸ƒ-è®¢é˜…æ¨¡å¼åˆå«è§‚å¯Ÿè€…æ¨¡å¼ï¼Œå®ƒå®šä¹‰å¯¹è±¡ é—´çš„ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€ å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–å®ƒçš„å¯¹è±¡éƒ½å°†å¾—åˆ°é€šçŸ¥ã€‚ ç°å®ç”Ÿæ´»ä¸­ï¼Œå¦‚æˆ‘ä»¬å»å”®æ¥¼ä¸­å¿ƒæœåŠ¡äººå‘˜Aæ¥å¾… äº†æˆ‘ä»¬ï¼Œç„¶åå†æœ‰å®¢æˆ·æ‰¾åˆ°Aï¼Œè¿™ä¸ªæ—¶å€™æš‚æ—¶æ²¡ æˆ¿äº†ï¼Œç­‰åˆ°æœ‰æˆ¿çš„æ—¶å€™ä¸å¯èƒ½æœåŠ¡äººå‘˜AæŒ¨ä¸ªæ‰“ ç”µè¯é€šçŸ¥è€Œæ˜¯è®¢é˜…Açš„å…¬å…±æé†’æœåŠ¡ã€‚

- code

  ```typescript
  //è§‚å¯Ÿè€…æ¥å£ ï¼ˆä¹°æˆ¿å­çš„äººï¼‰
  interface Observer {
    //å½“ä¸»é¢˜çŠ¶æ€æ”¹å˜æ—¶,æ›´æ–°é€šçŸ¥
    update(version: number): void;
  }
  // å°å“¥çš„å…¬ä¼—å· å¤§å®¶éƒ½å…³æ³¨å°å“¥çš„å…¬ä¼—å·
  interface Subject {
    //æ·»åŠ è§‚å¯Ÿè€…
    addObserver(key: string, obj: Observer): void;
    //ç§»é™¤è§‚å¯Ÿè€…
    deleteObserver(key: string): void;
    //å½“ä¸»é¢˜æ–¹æ³•æ”¹å˜æ—¶,è¿™ä¸ªæ–¹æ³•è¢«è°ƒç”¨,é€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€…
    notifyObserver(): void;
  }
  // æŸæŸæ‚å¿—(å–æˆ¿å­çš„å°å“¥)
  class MagazineSubject implements Subject {
    //å­˜æ”¾è®¢é˜…è€…
    // private List<Observer> observers = new ArrayList<Observer>();
    private observers: Map<string, Observer> = new Map<string, Observer>();
    //æœŸåˆŠç‰ˆæœ¬
    private version: number = 0;
  
    public addObserver(key: string, obj: Observer): void {
      // observers.add(obj);
      this.observers.set(key, obj);
    }
  
    public deleteObserver(key: string): void {
      if (this.observers.has(key)) {
        this.observers.delete(key);
      } else {
        throw new Error(`Observerçš„å¯¹è±¡ä¸Šä¸å­˜åœ¨${key}`);
      }
    }
  
    public notifyObserver(): void {
      for (const item of Array.from(this.observers)) {
        // console.log("ğŸŒ", item);
        const o: Observer = item[1];
        o.update(this.version);
      }
    }
  
    //è¯¥æ‚å¿—å‘è¡Œäº†æ–°ç‰ˆæœ¬
    public publish() {
      //æ–°ç‰ˆæœ¬
      this.version++;
      //ä¿¡æ¯æ›´æ–°å®Œæ¯•ï¼Œé€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…
      this.notifyObserver();
    }
  }
  // ä¹°æˆ¿å­çš„å…·ä½“äºº è®¢é˜…æ‚å¿—çš„äºº
  class CustomerObserver implements Observer {
    //è®¢é˜…è€…åå­—
    private name: string;
    private version: number;
  
    constructor(name: string) {
      this.name = name;
    }
  
    public update(version: number): void {
      this.version = version;
      console.log('è¯¥æ‚å¿—å‡ºæ–°ç‰ˆæœ¬äº†');
      this.buy();
    }
  
    public buy(): void {
      console.log(`${this.name} + "è´­ä¹°äº†ç¬¬" + ${this.version} + "æœŸçš„æ‚å¿—!"`);
    }
  }
  
  //åˆ›å»ºä¸»é¢˜(è¢«è§‚å¯Ÿè€…)
  const magazine: MagazineSubject = new MagazineSubject();
  //åˆ›å»ºä¸‰ä¸ªä¸åŒçš„è§‚å¯Ÿè€…
  const a: CustomerObserver = new CustomerObserver('A');
  const b: CustomerObserver = new CustomerObserver('B');
  const c: CustomerObserver = new CustomerObserver('C');
  //å°†è§‚å¯Ÿè€…æ³¨å†Œåˆ°ä¸»é¢˜ä¸­
  magazine.addObserver('a', a);
  magazine.addObserver('b', b);
  magazine.addObserver('c', c);
  
  //æ›´æ–°ä¸»é¢˜çš„æ•°æ®ï¼Œå½“æ•°æ®æ›´æ–°åï¼Œä¼šè‡ªåŠ¨é€šçŸ¥æ‰€æœ‰å·²æ³¨å†Œçš„è§‚å¯Ÿè€…
  magazine.publish();
  ```

  

### èŒè´£é“¾æ¨¡å¼

- ä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿å…è¯·æ±‚çš„å‘é€è€…å’Œæ¥å—è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ï¼Œå°†è¿™äº›å…³ç³»è¿æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚ï¼Œç›´åˆ°ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚ç°å®ç”Ÿæ´»ä¸­å¦‚æˆ‘ä»¬åº§å…¬äº¤è½¦äººå¤ªå¤šï¼Œæˆ‘ä»¬æŠŠå…¬äº¤å¡äº¤ç»™å”®ç¥¨å‘˜ï¼Œè®©å‰é¢çš„äººä¸åœçš„å¾€å‰é€’ç›´åˆ°å”®ç¥¨å‘˜åˆ·å¡ç»“æŸã€‚
    
- code

  ```typescript
  abstract class Handler {
    public sucesser: Handler;
    //å®šä¹‰ä¸€ä¸ªæŠ½è±¡çš„å¤„ç†è¯·æ±‚çš„æ–¹æ³•
    public abstract handlerRequest(user: string, days: number): void;
  
    //è·å–å½“å‰è§’è‰²çš„ä¸‹ä¸€ä¸ªå¤„ç†è€…è§’è‰²
    public getNextHandler(): Handler {
      return this.sucesser;
    }
    //è®¾ç½®å½“å‰è§’è‰²çš„ä¸‹ä¸€ä¸ªå¤„ç†è€…è§’è‰²
    public setNextHandler(sucesser: Handler): void {
      this.sucesser = sucesser;
    }
  }
  //ç­ä¸»ä»»å¤„ç†è¯·å‡è¯·æ±‚
  class HeadTeacher extends Handler {
    public handlerRequest(user: string, days: number): string {
      if (days < 5) {
        console.log('ç­ä¸»ä»»åŒæ„' + user + 'åŒå­¦çš„è¯·å‡è¯·æ±‚');
      } else {
        console.log('ç­ä¸»ä»»æ— æ³•å¤„ç†' + user + 'åŒå­¦çš„è¯·å‡è¯·æ±‚');
      }
      // å¦‚æœä¸‹ä¸€ä¸ªæ‰§è¡Œè€…ä¸ä¸ºç©ºï¼Œç”±ä¸‹ä¸€ä¸ªæ‰§è¡Œè€…æ‰§è¡Œ
      if (this.getNextHandler() != null) {
        const nextHandler = this.getNextHandler();
        nextHandler.handlerRequest(user, days);
        return;
        // return this.getNextHandler().handlerRequest(user, days);
      }
      return null;
    }
  }
  //é™¢ç³»ä¸»ä»»å¤„ç†è¯·å‡è¯·æ±‚
  class Department extends Handler {
    public handlerRequest(user: string, days: number): string {
      if (days < 30) {
        console.log('é™¢ç³»ä¸»ä»»åŒæ„' + user + 'åŒå­¦çš„è¯·å‡è¯·æ±‚');
      } else {
        console.log('é™¢ç³»ä¸»ä»»æ— æ³•å¤„ç†' + user + 'åŒå­¦çš„è¯·å‡è¯·æ±‚');
      }
      if (this.getNextHandler() != null) {
        const nextHandler = this.getNextHandler();
        nextHandler.handlerRequest(user, days);
        return;
      }
      return null;
    }
  }
  //æ ¡çº§ä¸»ä»»å¤„ç†è¯·å‡è¯·æ±‚
  class Leader extends Handler {
    public handlerRequest(user: string, days: number): string {
      if (days >= 30) {
        console.log('æ ¡çº§ä¸»ä»»åŒæ„' + user + 'åŒå­¦çš„è¯·å‡è¯·æ±‚');
      } else if (this.getNextHandler() != null) {
        const nextHandler = this.getNextHandler();
        nextHandler.handlerRequest(user, days);
        return;
        //return getNextHandler().handlerRequest(user, days);
      }
      return null;
    }
  }
  class SimpleFactory {
    public static TYPE_HeadTeacher: number = 1; //å…°å·æ‹‰é¢
    public static TYPE_Department: number = 2; //æ³¡é¢
    public static TYPE_Leader: number = 3; //å¹²æ‰£é¢
  
    public static createHandler(type: number): Handler {
      switch (type) {
        case SimpleFactory.TYPE_HeadTeacher:
          return new HeadTeacher();
        case SimpleFactory.TYPE_Department:
          return new Department();
        case SimpleFactory.TYPE_Leader:
        default:
          return new Leader();
      }
    }
  }
  // è·å–ä¸‰ä¸ªä¸åŒçš„å¤„ç†è€…å¯¹è±¡
  const h1: Handler = SimpleFactory.createHandler(SimpleFactory.TYPE_HeadTeacher);
  const h2: Handler = SimpleFactory.createHandler(SimpleFactory.TYPE_Department);
  const h3: Handler = SimpleFactory.createHandler(SimpleFactory.TYPE_Leader);
  // è®¾ç½®è§’è‰²çš„å¤„ç†å±‚æ¬¡
  h1.setNextHandler(h2);
  h2.setNextHandler(h3);
  
  h1.handlerRequest('æå››', 35);
  // console.log("*************************");
  // h2.handlerRequest("ç‹äº”", 15);
  // console.log("*************************");
  // h2.handlerRequest("æœ±ä¸ƒ", 30);
  
  ```

  

### ä¾èµ–æ³¨å…¥

```typescript
interface IContainer<T extends new () => any> {
  callback: () => InstanceType<T>;
  singleton: boolean;
  instance?: InstanceType<T>;
}
interface NewAble<T> {
  new (...args: any[]): T;
}
type TBind<T> = [key: string, Fn: NewAble<T>];
class CreateIoc {
  private container = new Map<PropertyKey, IContainer<any>>();
  public bind<T>(...parms: TBind<T>) {
    this.helpBind(parms, false);
  }
  public singleton<T>(...parms: TBind<T>) {
    this.helpBind(parms, true);
  }
  private helpBind<T>(parms: TBind<T>, singleton: boolean) {
    const [key, Fn] = parms;
    const callback = () => new Fn();
    const _instance: IContainer<typeof Fn> = { callback, singleton };
    this.container.set(key, _instance);
  }
  public use<T>(namespace: string) {
    const item = this.container.get(namespace);
    if (item !== undefined) {
      //æ˜¯å•ä¾‹æ¨¡å¼ ä½†æ˜¯å®ä¾‹ç¼ºæ— äººæ„å»º
      if (item.singleton && !item.instance) {
        item.instance = item.callback();
      }
      return item.singleton ? (item.instance as T) : (item.callback() as T);
    } else {
      throw new Error('æ²¡æœ‰æ‰¾åˆ°Item');
    }
  }
  public restore(key: string) {
    this.container.delete(key);
  }
}

interface IUserService {
  test(str: string): void;
}

class UserService implements IUserService {
  constructor() {}

  public test(str: string): void {
    console.log('str', str);
  }
}

const ioc = new CreateIoc();
ioc.bind<IUserService>('userService', UserService);
const user = ioc.use<IUserService>('userService');
user.test('mack');
```



